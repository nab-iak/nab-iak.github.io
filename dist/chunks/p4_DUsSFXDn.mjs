import { c as createComponent, m as maybeRenderHead, u as unescapeHTML, r as renderTemplate } from './astro/server_UGlnaItR.mjs';

const html = () => "<blockquote>\n<ul>\n<li>Cover Pic by <a href=\"https://www.pixiv.net/artworks/129087864\">@saturn_illus</a></li>\n</ul>\n</blockquote>\n<section><h2 id=\"教程\">教程<a class=\"anchor\" href=\"#教程\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"官方教程\">官方教程<a class=\"anchor\" href=\"#官方教程\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"analyzing-rna-seq-data-with-deseq2\">Analyzing RNA-seq data with DESeq2<a class=\"anchor\" href=\"#analyzing-rna-seq-data-with-deseq2\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>介绍了一般的分析方法</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>https://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#interactions</span></span></code></pre></section><section><h4 id=\"rna-seq-workflow-gene-level-exploratory-analysis-and-differential-expression\">RNA-seq workflow: gene-level exploratory analysis and differential expression<a class=\"anchor\" href=\"#rna-seq-workflow-gene-level-exploratory-analysis-and-differential-expression\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>介绍了更加丰富的用法，用于第一个教程的补充</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># install the package</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">!</span><span style=\"color:#79B8FF\">requireNamespace</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"BiocManager\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">quietly</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">    install.packages</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"BiocManager\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">BiocManager</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">install</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"rnaseqGene\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># view the vignettes</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">browseVignettes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"rnaseqGene\"</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section></section><section><h3 id=\"其他参考\">其他参考<a class=\"anchor\" href=\"#其他参考\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"108-如何利用deseq2分析转录组数据\">108-如何利用DESeq2分析转录组数据？<a class=\"anchor\" href=\"#108-如何利用deseq2分析转录组数据\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>https://www.jieandze1314.com/post/cnposts/108/</span></span></code></pre></section><section><h4 id=\"rna-seq分析微信公众号文章\">RNA-seq分析（微信公众号文章）<a class=\"anchor\" href=\"#rna-seq分析微信公众号文章\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkwMzQwNjYyNg==&#x26;action=getalbum&#x26;album_id=2673613335581474816#wechat_redirect</span></span></code></pre></section><section><h4 id=\"jwindlerice_storygithub仓库\">Jwindler/Ice_story（Github仓库）<a class=\"anchor\" href=\"#jwindlerice_storygithub仓库\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>https://github.com/Jwindler/Ice_story?tab=readme-ov-file</span></span></code></pre></section><section><h4 id=\"使用deseq2分析rna-seq数据\">使用DESeq2分析RNA-seq数据<a class=\"anchor\" href=\"#使用deseq2分析rna-seq数据\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>http://xuchunhui.top/2020/03/28/%E4%BD%BF%E7%94%A8DEseq2%E5%88%86%E6%9E%90RNA-seq%E6%95%B0%E6%8D%AE/</span></span></code></pre></section></section></section>\n<section><h2 id=\"并行运算\">并行运算<a class=\"anchor\" href=\"#并行运算\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>初始设置</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>library(\"BiocParallel\") # 载入R包</span></span>\n<span class=\"line\"><span>register(MulticoreParam(4)) # 设置并行内核为4</span></span></code></pre><ul>\n<li>后续的分析中，如果有<code>parallel</code>参数都可以设置<code>TRUE</code>来使用</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">DESeq</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">...</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">parallel</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">...</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">parallel</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section>\n<section><h2 id=\"数据导入\">数据导入<a class=\"anchor\" href=\"#数据导入\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>DESeq2必须输入计数矩阵（counts matrix）</li>\n<li>对于计数矩阵，一般用<code>DESeqDataSetFromMatrix()</code>即可</li>\n<li>用下列函数能创造一个<code>DEseqDataSet</code>对象（一般略称为<strong>dds</strong>），需要声明：</li>\n<li>colData：包含样本信息的meta data</li>\n<li>desgin：实验设计，用formula类型表示<code>~ Condition</code></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeqDataSetFromMatrix</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         countData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> countsMatrix,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         colData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> metaData,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         design</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> Condition</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">         )</span></span></code></pre>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th><strong>function</strong></th><th><strong>package</strong></th><th><strong>framework</strong></th><th><strong>output</strong></th><th><strong>DESeq2 input function</strong></th></tr></thead><tbody><tr><td>tximport</td><td>tximport</td><td>R/Bioconductor</td><td>list of matrices</td><td>DESeqDataSetFromTximport</td></tr><tr><td>tximeta</td><td>tximeta</td><td>R/Bioconductor</td><td>SummarizedExperiment</td><td>DESeqDataSet</td></tr><tr><td>htseq-count</td><td>HTSeq</td><td>Python</td><td>files</td><td>DESeqDataSetFromHTSeq</td></tr><tr><td>featureCounts</td><td>Rsubread</td><td>R/Bioconductor</td><td>matrix</td><td>DESeqDataSetFromMatrix</td></tr><tr><td>summarizeOverlaps</td><td>GenomicAlignments</td><td>R/Bioconductor</td><td>SummarizedExperiment</td><td>DESeqDataSet</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><ul>\n<li>查看<code>DEseqDataSet</code>对象内容\n<ul>\n<li>计数：<code>assay(dds)</code>，<code>counts(dds)</code></li>\n<li>基因信息：<code>rowRanges(dds)</code></li>\n<li>样本信息，即meta data：<code>colData(dds)</code></li>\n<li>$查看：meta data中包含的分组</li>\n<li>@查看：\n<ul>\n<li>design</li>\n<li>dispersionFunction</li>\n<li>rowRanges</li>\n<li>colData</li>\n<li>assays</li>\n<li>NAMES</li>\n<li>elementMetadata</li>\n<li>metadata</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul></section>\n<section><h2 id=\"基因预过滤\">基因预过滤<a class=\"anchor\" href=\"#基因预过滤\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>为了提高运算性能，可以删除表达量约等于0的基因</li>\n<li>如果配置不太吃力，一般可以<strong>不用预过滤，避免产生偏差</strong></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">smallestGroupSize </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> 3</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 设定满足筛选要求的样本最小数量</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">keep </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\">rowSums</span><span style=\"color:#E1E4E8\">(dds </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#FFAB70\"> counts</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">>=</span><span style=\"color:#79B8FF\"> 10</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">>=</span><span style=\"color:#E1E4E8\"> smallestGroupSize</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># dds %>% counts() >= 10：计算每个样本的每个基因表达量是否大于等于10，结果返回为布尔值</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># rowSums(.)：按基因（行）统计结果为TRUE的样本数量</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># rowSums(.) >= smallestGroupSize：满足筛选要求的样本最小数量（10）的基因被保留</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds_filtered </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> dds[keep, ]</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 基本筛选语法</span></span></code></pre></section>\n<section><h2 id=\"比较级别\">比较级别<a class=\"anchor\" href=\"#比较级别\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>对meta data的列进行因子化</li>\n<li><code>levels</code>的第一个级别为对照组</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 对dds对象进行因子化</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> factor</span><span style=\"color:#E1E4E8\">(dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition, </span><span style=\"color:#FFAB70\">levels</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"untreated\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"treated\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 在创建dds对象前对meta data因子化</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">metaData</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> factor</span><span style=\"color:#E1E4E8\">(metaData</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition, </span><span style=\"color:#FFAB70\">levels</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"untreated\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"treated\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeqDataSetFromMatrix</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">countData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> countsMatrix,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         colData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> metaData,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         design</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> Condition)</span></span></code></pre><ul>\n<li>只指定参考级别</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> relevel</span><span style=\"color:#E1E4E8\">(dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition, </span><span style=\"color:#FFAB70\">ref</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"untreated\"</span><span style=\"color:#E1E4E8\">)</span></span></code></pre><ul>\n<li>删除子集中没有样本的级别</li>\n<li>例如有三种Condition A，B，C<br>\n只选择子集A和B进行分析，数据中不包含C，但因子级别中包含，<br>\n用<code>droplevels()</code>去除空白的因子级别</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> droplevels</span><span style=\"color:#E1E4E8\">(dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition)</span></span></code></pre></section>\n<section><h2 id=\"基因注释\">基因注释<a class=\"anchor\" href=\"#基因注释\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>本节参考：<a href=\"https://zenn.dev/rchiji/articles/99bf231c92aad9#%E3%80%90-biomart%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8-%E3%80%91\">【R】 遺伝子ID/遺伝子名の変換方法</a></p><section><h3 id=\"biomart\">biomaRt<a class=\"anchor\" href=\"#biomart\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>需要用到R包<code>biomaRt</code></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 安装</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">!</span><span style=\"color:#79B8FF\">require</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"BiocManager\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">quietly</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">    install.packages</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"BiocManager\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">BiocManager</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">install</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"biomaRt\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 加载</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">library</span><span style=\"color:#E1E4E8\">(biomaRt)</span></span>\n<span class=\"line\"></span></code></pre><ul>\n<li>罗列可以选择的Marts</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">listMarts</span><span style=\"color:#E1E4E8\">()</span></span></code></pre><ul>\n<li>选择要用的Marts</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">db </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> useMart</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">biomart</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"ENSEMBL_MART_ENSEMBL\"</span><span style=\"color:#E1E4E8\">) </span></span></code></pre><ul>\n<li>以小鼠为例，在<code>ENSEMBL_MART_ENSEMBL</code>的<code>description</code>中查看包含小鼠<code>\"Mouse\"</code>的行</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">listDatasets</span><span style=\"color:#E1E4E8\">(db) </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#79B8FF\"> filter</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">grepl</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"Mouse\"</span><span style=\"color:#E1E4E8\">,description))</span></span></code></pre><ul>\n<li>把注释信息提取出来</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">Mm </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> useDataset</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"mmusculus_gene_ensembl\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">mart</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> db)</span></span></code></pre><ul>\n<li>查看<code>mmusculus_gene_ensembl</code>包含的所有小鼠基因信息</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">listAttributes</span><span style=\"color:#E1E4E8\">(Mm)</span></span></code></pre><ul>\n<li>创建一个所有基因名字的列表</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 提取需要的注释信息</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">gene_annotation </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> getBM</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 这里的attributes就是listAttributes(Mm)中选的</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    attributes</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ensembl_gene_id\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">          \"external_gene_name\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">          \"description\"</span><span style=\"color:#E1E4E8\">), </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> mart</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Mm</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    )</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">gene_annotation </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> gene_annotation </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 创建一个GENE的列：</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 如果有external_gene_name就用external_gene_name</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 如果没有就保留ensembl_gene_id</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    mutate</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">GENE</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ifelse</span><span style=\"color:#E1E4E8\">(external_gene_name </span><span style=\"color:#F97583\">==</span><span style=\"color:#9ECBFF\"> \"\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">          ensembl_gene_id, </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">          external_gene_name)) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    group_by</span><span style=\"color:#E1E4E8\">(GENE) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 由于存在相同基因名称的基因，并且变成rownames的时候是不可以有重复的</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 给重复的基因名后面加个小尾巴 .1 .2 这种</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    mutate</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        count</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> n</span><span style=\"color:#E1E4E8\">(),</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        GENE</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> if_else</span><span style=\"color:#E1E4E8\">(count </span><span style=\"color:#F97583\">==</span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">, GENE, </span><span style=\"color:#79B8FF\">paste0</span><span style=\"color:#E1E4E8\">(GENE, </span><span style=\"color:#9ECBFF\">\".\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">row_number</span><span style=\"color:#E1E4E8\">()))</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    ) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    ungroup</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    select</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">-</span><span style=\"color:#E1E4E8\">count)</span></span></code></pre><ul>\n<li>添加基因名称的时候只用<code>left_join()</code>就行了</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">resultDataFrame </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#E1E4E8\"> </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> left_join</span><span style=\"color:#E1E4E8\">(genes_annotation, </span><span style=\"color:#FFAB70\">by</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"gene\"</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section><section><h3 id=\"genome-wide-annotation包\">Genome wide annotation包<a class=\"anchor\" href=\"#genome-wide-annotation包\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>这个比较简单，很容易上手</li>\n<li>这个包是一个系列，都是org.XX.eg.db这种类型的</li>\n<li>但是没有预测基因，会出现很多NA的基因名</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">gene_annotation </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#B392F0\"> ensembldb</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">select</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> org.Mm.eg.db, </span><span style=\"color:#6A737D\"># 注释基因包</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">   # 这里keys(org.Mm.eg.db,\"ENSEMBL\")提取了包里的全部基因的ENSEMBL</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            keys</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> keys</span><span style=\"color:#E1E4E8\">(org.Mm.eg.db,</span><span style=\"color:#9ECBFF\">\"ENSEMBL\"</span><span style=\"color:#E1E4E8\">), </span><span style=\"color:#6A737D\"># 需要注释的基因</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            keytype</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"ENSEMBL\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\"># 匹配ENSEMBL</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">            # 抽取匹配到基因的\"SYMBOL\",\"ALIAS\",\"GENENAME\",\"GENETYPE\"</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            columns</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"SYMBOL\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"ALIAS\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"GENENAME\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"GENETYPE\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">resultDataFrame </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#E1E4E8\"> </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> left_join</span><span style=\"color:#E1E4E8\">(genes_annotation, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">     by</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ENSEMBL\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"SYMBOL\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"ALIAS\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"GENENAME\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"GENETYPE\"</span><span style=\"color:#E1E4E8\">))</span></span></code></pre></section></section>\n<section><h2 id=\"差异性表达分析\">差异性表达分析<a class=\"anchor\" href=\"#差异性表达分析\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li><code>DESeq()</code>，可以执行Wald检验和LRT检验，作用对象为<strong>dds</strong>对象</li>\n</ul><section><h3 id=\"wald检验\">Wald检验<a class=\"anchor\" href=\"#wald检验\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>默认的选项，约等于双样本t检验</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 下面两个一样</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">test</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"Wald\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 可以加入并行运算</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">parallel</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span></code></pre></section><section><h3 id=\"似然比检验lrt检验\">似然比检验（LRT检验）<a class=\"anchor\" href=\"#似然比检验lrt检验\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>比较多样本的选项，约等于ANOVA</li>\n<li><code>reduced</code>选项表示从原有的实验设计（完整模型）<strong>剔除</strong>需要比较的项<strong>后</strong>的模型（简化模型）</li>\n<li><code>results()</code>返回的结果中，<code>log2FoldChange</code>和<code>lfcSE</code>是<strong>没有任何实际意义</strong>的内容</li>\n</ul><blockquote>\n<p>对于使用似然比检验的分析，p 值仅由完整模型公式和简化模型公式之间的偏差差异决定<br>\n单个 log2 倍变化打印在结果表中以与其他结果表输出保持一致，但与实际测试无关</p>\n</blockquote><section><h4 id=\"简单的实验设计-condition\">简单的实验设计：<code>~ Condition</code><a class=\"anchor\" href=\"#简单的实验设计-condition\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>检验<code>Condition</code>里不同水平是否存在差异</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 因为检验Condition，所以从实验设计的formula中剔除Condition</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 什么都没有的情况下填写~1</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">test</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"LRT\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">reduced</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section><section><h4 id=\"复杂点的实验设计-conditiona--conditionb\">复杂点的实验设计：<code>~ ConditionA + ConditionB</code><a class=\"anchor\" href=\"#复杂点的实验设计-conditiona--conditionb\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>检验<code>ConditionB</code>里不同水平是否存在差异</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 同理，检验ConditionB则剔除ConditionB，保留~ ConditionA</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">test</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"LRT\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">reduced</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> ConditionA)</span></span></code></pre></section><section><h4 id=\"交互作用-conditiona--conditionb--conditionaconditionb\">交互作用：<code>~ ConditionA + ConditionB + ConditionA:ConditionB</code><a class=\"anchor\" href=\"#交互作用-conditiona--conditionb--conditionaconditionb\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>检验<code>ConditionB</code>里不同水平是否存在差异</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 无论多么复杂的实验设计，检验什么就剔除什么</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 这里检验ConditionB，所以保留~ ConditionA + ConditionA:ConditionB</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">test</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"LRT\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    reduced</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> ConditionA </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> ConditionA</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\">ConditionB)</span></span></code></pre></section></section><section><h3 id=\"查看结果\">查看结果<a class=\"anchor\" href=\"#查看结果\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"查看比较元素\">查看比较元素<a class=\"anchor\" href=\"#查看比较元素\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>主要用于<code>results()</code>中用<code>name</code>或<code>contrast</code>指定比较对象</li>\n<li>也可以用于<code>lfcShrink()</code>的<code>coef</code>和<code>contrast</code>指定对象</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">resultsNames</span><span style=\"color:#E1E4E8\">(dds)</span></span></code></pre></section><section><h4 id=\"选择比较的对象\">选择比较的对象<a class=\"anchor\" href=\"#选择比较的对象\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>对于简单的比较，<code>name</code>和<code>contrast</code>都可以</li>\n<li><code>name</code>的值不是随便起的，在用<code>resultsNames()</code>确认后使用</li>\n<li>以下3个用法是等价的</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">res </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">name</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"condition_treated_vs_untreated\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">contrast</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"condition\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"treated\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"untreated\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">contrast</span><span style=\"color:#F97583\">=list</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"condition_treated_vs_untreated\"</span><span style=\"color:#E1E4E8\">)))</span></span></code></pre><ul>\n<li>对于复杂的比较，只能用<code>contrast</code>\n<ul>\n<li><code>c(\"condition\",\"treated\",\"untreated\")</code><br>\n是选择某一条件中两者进行对比，顺序为：\n<ul>\n<li>条件</li>\n<li>比对项目</li>\n<li>被比对（参考）项目</li>\n</ul>\n</li>\n<li>仅能包含一个向量，向量包含3个元素</li>\n<li><code>list(c(\"..1..\"), c(\"..2..\"))</code><br>\n用于更加复杂的对比，<code>list()</code>中包含2个向量，<br>\n如果只声明1个，那么另一个就是截距</li>\n</ul>\n</li>\n</ul></section><section><h4 id=\"整理筛选打印结果\">整理，筛选，打印结果<a class=\"anchor\" href=\"#整理筛选打印结果\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>可以直接在<code>results</code>对象上操作</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 官方文档的方法</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">resOrdered </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> res[</span><span style=\"color:#79B8FF\">order</span><span style=\"color:#E1E4E8\">(res</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">pvalue),]</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">summary</span><span style=\"color:#E1E4E8\">(res)</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">sum</span><span style=\"color:#E1E4E8\">(res</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.1</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">na.rm</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">TRUE</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res05 </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">alpha</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">0.05</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">summary</span><span style=\"color:#E1E4E8\">(res05)</span></span></code></pre><ul>\n<li>个人喜欢转换成熟悉的<code>data.frame</code>类型更方便</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">res_df </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> res </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#79B8FF\"> as.data.frame</span><span style=\"color:#E1E4E8\">()</span></span></code></pre><ul>\n<li>不建议直接使用<code>results()</code>去获取结果，<br>\n可以首先通过LFC收缩<code>lfcShrink()</code>调整LFC后再获取结果\n<ul>\n<li>这个时候不用<code>results()</code>了，直接将LFC收缩完的对象变换成<code>data.frame</code>即可</li>\n</ul>\n</li>\n</ul></section><section><h4 id=\"p值调整\">p值调整<a class=\"anchor\" href=\"#p值调整\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><section><h5 id=\"传统调整方法\">传统调整方法<a class=\"anchor\" href=\"#传统调整方法\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h5><ul>\n<li>在<code>results()</code>中可以设置p值调整的方法，默认为<code>\"BH\"</code></li>\n<li>使用<code>?p.adjust</code>可以获取所有的调整方法：\n<ul>\n<li><code>\"holm\"</code></li>\n<li><code>\"hochberg\"</code></li>\n<li><code>\"hommel\"</code></li>\n<li><code>\"bonferroni\"</code></li>\n<li><code>\"BH\"</code></li>\n<li><code>\"BY\"</code></li>\n<li><code>\"fdr\"</code></li>\n<li><code>\"none\"</code></li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># BH</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">results</span><span style=\"color:#E1E4E8\">(dds)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">pAdjustMethod</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"BH\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># Bonferroni</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">pAdjustMethod</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"bonferroni\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 其他类似</span></span></code></pre></section><section><h5 id=\"独立假设加权\">独立假设加权<a class=\"anchor\" href=\"#独立假设加权\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h5><ul>\n<li>一种给每个检验的结果分配权重增加统计效果的方法</li>\n<li>增加更多的原假设拒绝以更好筛选那些显出差异明显的基因</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 使用R包IHW</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">library</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"IHW\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 设置filterFun为ihw</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">resIHW </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">filterFun</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">ihw)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">#</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">summary</span><span style=\"color:#E1E4E8\">(resIHW)</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">sum</span><span style=\"color:#E1E4E8\">(resIHW</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.1</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">na.rm</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">TRUE</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">metadata</span><span style=\"color:#E1E4E8\">(resIHW)</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">ihwResult</span></span></code></pre></section></section></section></section>\n<section><h2 id=\"lfc收缩\">LFC收缩<a class=\"anchor\" href=\"#lfc收缩\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>目的是为了解决低计数基因或者高离散度的数据在计算LFC时引起的误差</li>\n<li>官方文档对于3种LFC估计器的介绍</li>\n</ul>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th>方法:</th><th align=\"center\"><code>apeglm</code></th><th align=\"center\"><code>ashr</code></th><th align=\"center\"><code>normal</code></th></tr></thead><tbody><tr><td>适合LFC排名</td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\">✓</td></tr><tr><td>保存大LFC的尺寸</td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\"></td></tr><tr><td>可以计算s值</td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\"></td></tr><tr><td>允许使用<code>coef</code></td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\">✓</td></tr><tr><td>允许使用<code>lfcThreshold</code></td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\">✓</td></tr><tr><td>允许使用<code>contrast</code></td><td align=\"center\"></td><td align=\"center\">✓</td><td align=\"center\">✓</td></tr><tr><td>可以收缩交互术语</td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\"></td></tr></tbody></table><ul>\n<li>基本用法</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">coef</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Comparison, </span><span style=\"color:#FFAB70\">type</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> LFCShrinkAlgorithm)</span></span></code></pre><ul>\n<li>对于简单的实验设计，<code>apeglm</code>是最推荐的方法\n<ul>\n<li><code>coef</code>等同于<code>results()</code>中的<code>name</code></li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">coef</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"Condition_B_vs_A\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">type</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> LFCShrinkAlgorithm)</span></span></code></pre><ul>\n<li>对于复杂的实验设计，由于需要指定<code>contrast</code>，所以只有<code>ashr</code>才行</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> dds, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> contrast</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> list</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"..1..\"</span><span style=\"color:#E1E4E8\">),</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"..2..\"</span><span style=\"color:#E1E4E8\">)), </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> type</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> LFCShrinkAlgorithm</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> )</span></span></code></pre><ul>\n<li>打印的结果的s值：检验收缩后的LFC是否与制定的阈值<code>lfcThreshold</code>相等\n<ul>\n<li><code>lfcThreshold</code>默认为0</li>\n<li>可以通过设置不同的<code>lfcThreshold</code>来检查s值的变化</li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> dds, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> coef</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Comparison, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> type</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> LFCShrinkAlgorithm, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> lfcThreshold</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 1</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> )</span></span></code></pre><ul>\n<li>目前不支持IHW与LFC收缩的混用</li>\n</ul></section>\n<section><h2 id=\"数据可视化\">数据可视化<a class=\"anchor\" href=\"#数据可视化\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"数据转换\">数据转换<a class=\"anchor\" href=\"#数据转换\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>数据转换<strong>不用于</strong>差异性表达分析，而是用于各种可视化\n<ul>\n<li>之后需要用到数据转换的数据用<code>rld</code>表示</li>\n</ul>\n</li>\n</ul><section><h4 id=\"对数化\">对数化<a class=\"anchor\" href=\"#对数化\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">ntd </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> normTransform</span><span style=\"color:#E1E4E8\">(dds)</span></span></code></pre></section><section><h4 id=\"vsd适合30的大数据\">vsd，适合>=30的大数据<a class=\"anchor\" href=\"#vsd适合30的大数据\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">vsd </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> vst</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">blind</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> FALSE</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section><section><h4 id=\"rlog适合30样本的小数据\">rlog，适合&#x3C;30样本的小数据<a class=\"anchor\" href=\"#rlog适合30样本的小数据\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">rld </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> rlog</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">blind</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> FALSE</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section></section><section><h3 id=\"检查每个样本的计数\">检查每个样本的计数<a class=\"anchor\" href=\"#检查每个样本的计数\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"分开检查每个样本的计数分布\">分开检查每个样本的计数分布<a class=\"anchor\" href=\"#分开检查每个样本的计数分布\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dt[,</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\">ncol</span><span style=\"color:#E1E4E8\">(dt)] </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    map2</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">.x</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">., </span><span style=\"color:#FFAB70\">.y</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">names</span><span style=\"color:#E1E4E8\">(.),</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">        ~</span><span style=\"color:#E1E4E8\">dt_GE </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        ggplot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">aes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">.x)) </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\">  </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        geom_histogram</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">stat</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">'bin'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">bins</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">20</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        geom_freqpoly</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">binwidth</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 1000</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        labs</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">'Raw expression count'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            y</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">'Number of genes'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            title</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">.y) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        theme_bw</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    )</span></span></code></pre></section><section><h4 id=\"检查所有样本计数总数\">检查所有样本计数总数<a class=\"anchor\" href=\"#检查所有样本计数总数\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">colSum_df </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> colSums</span><span style=\"color:#E1E4E8\">(dt) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\"> as.data.frame</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> rownames_to_column</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">colnames</span><span style=\"color:#E1E4E8\">(colSum_df) </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'Sample'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'Counts'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">colSum_df </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  ggplot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">aes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Sample, </span><span style=\"color:#FFAB70\">y</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Counts </span><span style=\"color:#F97583\">/</span><span style=\"color:#79B8FF\"> 1e6</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">fill</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Sample)) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         geom_bar</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">stat</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"identity\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span><span style=\"color:#FFAB70\"> theme_bw</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         labs</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"Sample\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">y</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"Total count in millions\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         theme</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">axis.text.x</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> element_text</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">angle</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 45</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">hjust</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">vjust</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">))</span></span></code></pre></section></section><section><h3 id=\"样本关联性热图\">样本关联性热图<a class=\"anchor\" href=\"#样本关联性热图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">rld_mat </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> assay</span><span style=\"color:#E1E4E8\">(rld)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">rld_cor </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> cor</span><span style=\"color:#E1E4E8\">(rld_mat)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">pheatmap</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> rld_cor_GE,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> annotation</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> dplyr</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">select</span><span style=\"color:#E1E4E8\">(meta_dt, </span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'ConditionA'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'ConditionB'</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> )</span></span></code></pre></section><section><h3 id=\"pca-plot\">PCA plot<a class=\"anchor\" href=\"#pca-plot\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">rld_PCA </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> plotPCA</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> rld,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> intgroup</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ConditionA\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"ConditionB\"</span><span style=\"color:#E1E4E8\">),</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> returnData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> )</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">rld_PCA_pv </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> round</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">100</span><span style=\"color:#F97583\"> *</span><span style=\"color:#79B8FF\"> attr</span><span style=\"color:#E1E4E8\">(rld_PCA, </span><span style=\"color:#9ECBFF\">\"percentVar\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">rld_PCA </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> ggplot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">aes</span><span style=\"color:#E1E4E8\">(PC1,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">      PC2,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      color</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">ConditionA,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      shape</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">ConditionB,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      linetype</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">Time)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     ) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    geom_point</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">size</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 3</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    xlab</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">paste0</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"PC1: \"</span><span style=\"color:#E1E4E8\">,rld_GE_PCA_pv[</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">],</span><span style=\"color:#9ECBFF\">\"% variance\"</span><span style=\"color:#E1E4E8\">)) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    ylab</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">paste0</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"PC2: \"</span><span style=\"color:#E1E4E8\">,rld_GE_PCA_pv[</span><span style=\"color:#79B8FF\">2</span><span style=\"color:#E1E4E8\">],</span><span style=\"color:#9ECBFF\">\"% variance\"</span><span style=\"color:#E1E4E8\">)) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    stat_ellipse</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    theme_bw</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"></span></code></pre></section><section><h3 id=\"变换-方差图\">变换-方差图<a class=\"anchor\" href=\"#变换-方差图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">{</span><span style=\"color:#B392F0\">vsn</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">meanSdPlot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">assay</span><span style=\"color:#E1E4E8\">(rld), </span><span style=\"color:#FFAB70\">ranks</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> FALSE</span><span style=\"color:#E1E4E8\">)}</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">gg </span><span style=\"color:#F97583\">+</span><span style=\"color:#FFAB70\"> theme_bw</span><span style=\"color:#E1E4E8\">()</span></span></code></pre></section><section><h3 id=\"分散估计图\">分散估计图<a class=\"anchor\" href=\"#分散估计图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>检查模型拟合的情况，对象为<code>DESeq()</code>处理过的<code>dds</code></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">plotDispEsts</span><span style=\"color:#E1E4E8\">(dds)</span></span></code></pre></section><section><h3 id=\"ma图\">MA图<a class=\"anchor\" href=\"#ma图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li><code>res_lfcShrink</code>是<code>lfcShrink(dds, ...)</code>之后的结果</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">plotMA</span><span style=\"color:#E1E4E8\">(res_lfcShrink, </span><span style=\"color:#FFAB70\">ylim</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">-</span><span style=\"color:#79B8FF\">2</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#79B8FF\">2</span><span style=\"color:#E1E4E8\">))</span></span></code></pre></section><section><h3 id=\"火山图\">火山图<a class=\"anchor\" href=\"#火山图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li><code>res_lfcShrink</code>是<code>lfcShrink(dds, ...)</code>之后的结果</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">res_lfcShrink_volc </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> res_lfcShrink </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">            as.data.frame</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            rownames_to_column</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">var</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"gene\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            left_join</span><span style=\"color:#E1E4E8\">(all_genes, </span><span style=\"color:#FFAB70\">by</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"gene\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            mutate</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">diffexpressed</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> case_when</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">              {padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.05</span><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">&#x26;</span><span style=\"color:#E1E4E8\"> {log2FoldChange </span><span style=\"color:#F97583\">></span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">~</span><span style=\"color:#9ECBFF\"> \"UP\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">              {padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.05</span><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">&#x26;</span><span style=\"color:#E1E4E8\"> {log2FoldChange </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#F97583\"> -</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">~</span><span style=\"color:#9ECBFF\"> \"DOWN\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">              TRUE </span><span style=\"color:#F97583\">~</span><span style=\"color:#9ECBFF\"> \"NO\"</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">              ))</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res_lfcShrink_volc</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">diffexpressed </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> factor</span><span style=\"color:#E1E4E8\">(res_8h_vs_4h_volc</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">diffexpressed,</span><span style=\"color:#FFAB70\">levels</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"DOWN\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"NO\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"UP\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res_lfcShrink_volc </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">ggplot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">aes</span><span style=\"color:#E1E4E8\">(log2FoldChange, </span><span style=\"color:#F97583\">-</span><span style=\"color:#79B8FF\">log10</span><span style=\"color:#E1E4E8\">(padj), </span><span style=\"color:#FFAB70\">color</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> diffexpressed))</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  geom_hline</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">yintercept</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> -</span><span style=\"color:#79B8FF\">log10</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.05</span><span style=\"color:#E1E4E8\">), </span><span style=\"color:#FFAB70\">linetype</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"dashed\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">color</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"black\"</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  geom_vline</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">xintercept</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">-</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">), </span><span style=\"color:#FFAB70\">linetype</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"dashed\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">color</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"black\"</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  geom_point</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">size</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 0.8</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  scale_color_manual</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">values</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"#989ad6\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"#e4e4e4\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"#e27e9a\"</span><span style=\"color:#E1E4E8\">),</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                     labels</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"DOWN\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"NO\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"UP\"</span><span style=\"color:#E1E4E8\">))  </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  theme_bw</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">base_size</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 12</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  theme</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">legend.position</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> 'right'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        legend.justification</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">))</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 添加标签</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  geom_text_repel</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">data</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> filter</span><span style=\"color:#E1E4E8\">(res_lfcShrink_volc, padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.05</span><span style=\"color:#F97583\"> &#x26;</span><span style=\"color:#79B8FF\"> abs</span><span style=\"color:#E1E4E8\">(log2FoldChange) </span><span style=\"color:#F97583\">></span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">),</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                  max.overlaps</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> getOption</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ggrepel.max.overlaps\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">default</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 20</span><span style=\"color:#E1E4E8\">),</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">                  # 这里的filter很关键，筛选你想要标记的基因</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                  aes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">label</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> GENE), </span><span style=\"color:#6A737D\"># 这里的GENE就是注释部分生成的基因名称</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                  size</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 3</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                  color</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> 'black'</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  xlab</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"Log2FC\"</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  ylab</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"-Log10(FDR q-value)\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span></code></pre></section><section><h3 id=\"基因表达热图\">基因表达热图<a class=\"anchor\" href=\"#基因表达热图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>使用R包<code>ComplexHeatmap</code></li>\n<li>这个包的功能很强大，本文仅限于简单出图</li>\n<li>具体说明见<a href=\"https://pengpengyang94.github.io/2020/05/complexheatmap%E4%B8%AD%E6%96%87%E7%89%88%E8%AF%B4%E6%98%8E/\">ComplexHeatmap中文版说明</a></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 两种安装方式</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">install.packages</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ComplexHeatmap\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">devtools</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">install_github</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"jokergoo/ComplexHeatmap\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 加载</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">library</span><span style=\"color:#E1E4E8\">(ComplexHeatmap)</span></span></code></pre><ul>\n<li>首先提取归一化处理，并将行名换成基因名</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">counts_dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> counts</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">normalized</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> T) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">    as.data.frame</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    rownames_to_column</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"gene\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    left_join</span><span style=\"color:#E1E4E8\">(gene_annotation, </span><span style=\"color:#FFAB70\">by</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"gene\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    select</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">-</span><span style=\"color:#E1E4E8\">gene) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    column_to_rownames</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"name\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">counts_dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> t</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">scale</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">t</span><span style=\"color:#E1E4E8\">(counts_dds))) </span><span style=\"color:#6A737D\"># 需要对每行进行归一化，所以得转置2次</span></span></code></pre><ul>\n<li>绘制热图\n<ul>\n<li><code>SigGenes</code>为筛选出来的基因名</li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">Heatmap</span><span style=\"color:#E1E4E8\">(counts_dds[SigGenes,])</span></span></code></pre></section></section>";

				const frontmatter = {"title":"用DESeq2进行差异性分析","published":"2025-04-28T00:00:00.000Z","image":"./p4_cover.png","description":"DESeq2的简明教程","category":"Bioinformatics","tags":["RNA-seq","DESeq2","R","ZH-CN","Visualization"],"draft":false,"lang":"en","minutes":13,"words":2674,"excerpt":"本节参考：【R】 遺伝子ID/遺伝子名の変換方法"};
				const file = "/Users/wanjiawei/Projects/Nab-iak/nab-iak.github.io/src/content/posts/p4/p4.md";
				const url = undefined;
				function rawContent() {
					return "   \n                       \n                     \n                       \n                          \n                          \n                                            \n             \n          \n   \n> - Cover Pic by [@saturn_illus](https://www.pixiv.net/artworks/129087864)\n>\n## 教程\n\n### 官方教程\n\n#### Analyzing RNA-seq data with DESeq2\n\n- 介绍了一般的分析方法\n\n```\nhttps://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#interactions\n```\n\n#### RNA-seq workflow: gene-level exploratory analysis and differential expression\n\n- 介绍了更加丰富的用法，用于第一个教程的补充\n\n```r\n# install the package\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\nBiocManager::install(\"rnaseqGene\")\n\n# view the vignettes\nbrowseVignettes(\"rnaseqGene\")\n```\n\n### 其他参考\n\n#### 108-如何利用DESeq2分析转录组数据？\n\n```\nhttps://www.jieandze1314.com/post/cnposts/108/\n```\n\n#### RNA-seq分析（微信公众号文章）\n\n```\nhttps://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkwMzQwNjYyNg==&action=getalbum&album_id=2673613335581474816#wechat_redirect\n```\n\n#### Jwindler/Ice_story（Github仓库）\n\n```\nhttps://github.com/Jwindler/Ice_story?tab=readme-ov-file\n```\n\n#### 使用DESeq2分析RNA-seq数据\n\n```\nhttp://xuchunhui.top/2020/03/28/%E4%BD%BF%E7%94%A8DEseq2%E5%88%86%E6%9E%90RNA-seq%E6%95%B0%E6%8D%AE/\n```\n\n## 并行运算\n\n- 初始设置\n\n```R\nlibrary(\"BiocParallel\") # 载入R包\nregister(MulticoreParam(4)) # 设置并行内核为4\n```\n\n- 后续的分析中，如果有`parallel`参数都可以设置`TRUE`来使用\n\n```r\nDESeq(..., parallel = TRUE)\nlfcShrink(..., parallel = TRUE)\n```\n\n## 数据导入\n\n- DESeq2必须输入计数矩阵（counts matrix）\n- 对于计数矩阵，一般用`DESeqDataSetFromMatrix()`即可\n- 用下列函数能创造一个`DEseqDataSet`对象（一般略称为**dds**），需要声明：\n- colData：包含样本信息的meta data\n- desgin：实验设计，用formula类型表示`~ Condition`\n\n```r\ndds <- DESeqDataSetFromMatrix(\n         countData = countsMatrix,\n         colData = metaData,\n         design = ~ Condition\n         )\n```\n\n| **function**      | **package**       | **framework**  | **output**           | **DESeq2 input function** |\n| ----------------- | ----------------- | -------------- | -------------------- | ------------------------- |\n| tximport          | tximport          | R/Bioconductor | list of matrices     | DESeqDataSetFromTximport  |\n| tximeta           | tximeta           | R/Bioconductor | SummarizedExperiment | DESeqDataSet              |\n| htseq-count       | HTSeq             | Python         | files                | DESeqDataSetFromHTSeq     |\n| featureCounts     | Rsubread          | R/Bioconductor | matrix               | DESeqDataSetFromMatrix    |\n| summarizeOverlaps | GenomicAlignments | R/Bioconductor | SummarizedExperiment | DESeqDataSet              |\n|                   |                   |                |                      |                           |\n\n- 查看`DEseqDataSet`对象内容\n  - 计数：`assay(dds)`，`counts(dds)`\n  - 基因信息：`rowRanges(dds)`\n  - 样本信息，即meta data：`colData(dds)`\n  - \\$查看：meta data中包含的分组\n  - \\@查看：\n    - design\n    - dispersionFunction\n    - rowRanges\n    - colData\n    - assays\n    - NAMES\n    - elementMetadata\n    - metadata\n\n## 基因预过滤\n\n- 为了提高运算性能，可以删除表达量约等于0的基因\n- 如果配置不太吃力，一般可以**不用预过滤，避免产生偏差**\n\n```r\nsmallestGroupSize <- 3\n# 设定满足筛选要求的样本最小数量\nkeep <-rowSums(dds %>% counts() >= 10) >= smallestGroupSize\n# dds %>% counts() >= 10：计算每个样本的每个基因表达量是否大于等于10，结果返回为布尔值\n# rowSums(.)：按基因（行）统计结果为TRUE的样本数量\n# rowSums(.) >= smallestGroupSize：满足筛选要求的样本最小数量（10）的基因被保留\ndds_filtered <- dds[keep, ]\n# 基本筛选语法\n```\n\n## 比较级别\n\n- 对meta data的列进行因子化\n- `levels`的第一个级别为对照组\n\n```r\n# 对dds对象进行因子化\ndds$condition <- factor(dds$condition, levels = c(\"untreated\",\"treated\"))\n# 在创建dds对象前对meta data因子化\nmetaData$condition <- factor(metaData$condition, levels = c(\"untreated\",\"treated\"))\ndds <- DESeqDataSetFromMatrix(countData = countsMatrix,\n         colData = metaData,\n         design = ~ Condition)\n```\n\n- 只指定参考级别\n\n```r\ndds$condition <- relevel(dds$condition, ref = \"untreated\")\n```\n\n- 删除子集中没有样本的级别\n- 例如有三种Condition A，B，C  \n   只选择子集A和B进行分析，数据中不包含C，但因子级别中包含，  \n   用`droplevels()`去除空白的因子级别\n\n```r\ndds$condition <- droplevels(dds$condition)\n```\n\n## 基因注释\n\n本节参考：[【R】 遺伝子ID/遺伝子名の変換方法](https://zenn.dev/rchiji/articles/99bf231c92aad9#%E3%80%90-biomart%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8-%E3%80%91)\n\n### biomaRt\n\n- 需要用到R包`biomaRt`\n\n```r\n# 安装\nif (!require(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\nBiocManager::install(\"biomaRt\")\n\n# 加载\n\nlibrary(biomaRt)\n\n```\n\n- 罗列可以选择的Marts\n\n```r\nlistMarts()\n```\n\n- 选择要用的Marts\n\n```r\ndb <- useMart(biomart = \"ENSEMBL_MART_ENSEMBL\") \n```\n\n- 以小鼠为例，在`ENSEMBL_MART_ENSEMBL`的`description`中查看包含小鼠`\"Mouse\"`的行\n\n```r\nlistDatasets(db) %>% filter(grepl(\"Mouse\",description))\n```\n\n- 把注释信息提取出来\n\n```r\nMm <- useDataset(\"mmusculus_gene_ensembl\", mart = db)\n```\n\n- 查看`mmusculus_gene_ensembl`包含的所有小鼠基因信息\n\n```r\nlistAttributes(Mm)\n```\n\n- 创建一个所有基因名字的列表\n\n```r\n# 提取需要的注释信息\ngene_annotation <- getBM(\n# 这里的attributes就是listAttributes(Mm)中选的\n    attributes = c(\"ensembl_gene_id\",\n          \"external_gene_name\",\n          \"description\"), \n mart = Mm\n    )\ngene_annotation <- gene_annotation %>%\n# 创建一个GENE的列：\n# 如果有external_gene_name就用external_gene_name\n# 如果没有就保留ensembl_gene_id\n    mutate(GENE = ifelse(external_gene_name == \"\",\n          ensembl_gene_id, \n          external_gene_name)) %>%\n    group_by(GENE) %>%\n# 由于存在相同基因名称的基因，并且变成rownames的时候是不可以有重复的\n# 给重复的基因名后面加个小尾巴 .1 .2 这种\n    mutate(\n        count = n(),\n        GENE = if_else(count == 1, GENE, paste0(GENE, \".\", row_number()))\n    ) %>%\n    ungroup() %>%\n    select(-count)\n```\n\n- 添加基因名称的时候只用`left_join()`就行了\n\n```r\nresultDataFrame %>% \n left_join(genes_annotation, by = \"gene\")\n```\n\n### Genome wide annotation包\n\n- 这个比较简单，很容易上手\n- 这个包是一个系列，都是org.XX.eg.db这种类型的\n- 但是没有预测基因，会出现很多NA的基因名\n\n```r\ngene_annotation <- ensembldb::select(x = org.Mm.eg.db, # 注释基因包\n   # 这里keys(org.Mm.eg.db,\"ENSEMBL\")提取了包里的全部基因的ENSEMBL\n            keys = keys(org.Mm.eg.db,\"ENSEMBL\"), # 需要注释的基因\n            keytype = \"ENSEMBL\", # 匹配ENSEMBL\n            # 抽取匹配到基因的\"SYMBOL\",\"ALIAS\",\"GENENAME\",\"GENETYPE\"\n            columns = c(\"SYMBOL\",\"ALIAS\",\"GENENAME\",\"GENETYPE\"))\n\nresultDataFrame %>% \n left_join(genes_annotation, \n     by = c(\"ENSEMBL\",\"SYMBOL\",\"ALIAS\",\"GENENAME\",\"GENETYPE\"))\n```\n\n## 差异性表达分析\n\n- `DESeq()`，可以执行Wald检验和LRT检验，作用对象为**dds**对象\n\n### Wald检验\n\n- 默认的选项，约等于双样本t检验\n\n```r\n# 下面两个一样\ndds <- DESeq(dds)\ndds <- DESeq(dds, test = \"Wald\")\n\n# 可以加入并行运算\n\ndds <- DESeq(dds, parallel = TRUE)\n\n```\n\n### 似然比检验（LRT检验）\n\n- 比较多样本的选项，约等于ANOVA\n- `reduced`选项表示从原有的实验设计（完整模型）**剔除**需要比较的项**后**的模型（简化模型）\n- `results()`返回的结果中，`log2FoldChange`和`lfcSE`是**没有任何实际意义**的内容\n\n> 对于使用似然比检验的分析，p 值仅由完整模型公式和简化模型公式之间的偏差差异决定  \n> 单个 log2 倍变化打印在结果表中以与其他结果表输出保持一致，但与实际测试无关\n\n#### 简单的实验设计：`~ Condition`\n\n- 检验`Condition`里不同水平是否存在差异\n\n```r\n# 因为检验Condition，所以从实验设计的formula中剔除Condition\n# 什么都没有的情况下填写~1\ndds <- DESeq(dds, test = \"LRT\", reduced = ~1)\n```\n\n#### 复杂点的实验设计：`~ ConditionA + ConditionB`\n\n- 检验`ConditionB`里不同水平是否存在差异\n\n```r\n# 同理，检验ConditionB则剔除ConditionB，保留~ ConditionA\ndds <- DESeq(dds, test = \"LRT\", reduced = ~ ConditionA)\n```\n\n#### 交互作用：`~ ConditionA + ConditionB + ConditionA:ConditionB`\n\n- 检验`ConditionB`里不同水平是否存在差异\n\n```r\n# 无论多么复杂的实验设计，检验什么就剔除什么\n# 这里检验ConditionB，所以保留~ ConditionA + ConditionA:ConditionB\ndds <- DESeq(dds, test = \"LRT\",\n    reduced = ~ ConditionA + ConditionA:ConditionB)\n```\n\n### 查看结果\n\n#### 查看比较元素\n\n- 主要用于`results()`中用`name`或`contrast`指定比较对象\n- 也可以用于`lfcShrink()`的`coef`和`contrast`指定对象\n\n```r\nresultsNames(dds)\n```\n\n#### 选择比较的对象\n\n- 对于简单的比较，`name`和`contrast`都可以\n- `name`的值不是随便起的，在用`resultsNames()`确认后使用\n- 以下3个用法是等价的\n\n```r\nres <- results(dds, name=\"condition_treated_vs_untreated\")\nres <- results(dds, contrast=c(\"condition\",\"treated\",\"untreated\"))\nres <- results(dds, contrast=list(c(\"condition_treated_vs_untreated\")))\n```\n\n- 对于复杂的比较，只能用`contrast`\n  - `c(\"condition\",\"treated\",\"untreated\")`  \n   是选择某一条件中两者进行对比，顺序为：\n    - 条件\n    - 比对项目\n    - 被比对（参考）项目\n  - 仅能包含一个向量，向量包含3个元素\n  - `list(c(\"..1..\"), c(\"..2..\"))`  \n   用于更加复杂的对比，`list()`中包含2个向量，  \n   如果只声明1个，那么另一个就是截距\n\n#### 整理，筛选，打印结果\n\n- 可以直接在`results`对象上操作\n\n```r\n# 官方文档的方法\nresOrdered <- res[order(res$pvalue),]\nsummary(res)\nsum(res$padj < 0.1, na.rm=TRUE)\nres05 <- results(dds, alpha=0.05)\nsummary(res05)\n```\n\n- 个人喜欢转换成熟悉的`data.frame`类型更方便\n\n```r\nres_df <- res %>% as.data.frame()\n```\n\n- 不建议直接使用`results()`去获取结果，  \n  可以首先通过LFC收缩`lfcShrink()`调整LFC后再获取结果\n  - 这个时候不用`results()`了，直接将LFC收缩完的对象变换成`data.frame`即可\n\n#### p值调整\n\n##### 传统调整方法\n\n- 在`results()`中可以设置p值调整的方法，默认为`\"BH\"`\n- 使用`?p.adjust`可以获取所有的调整方法：\n  - `\"holm\"`\n  - `\"hochberg\"`\n  - `\"hommel\"`\n  - `\"bonferroni\"`\n  - `\"BH\"`\n  - `\"BY\"`\n  - `\"fdr\"`\n  - `\"none\"`\n\n```r\n# BH\nresults(dds)\nresults(dds, pAdjustMethod = \"BH\")\n# Bonferroni\nresults(dds, pAdjustMethod = \"bonferroni\")\n# 其他类似\n```\n\n##### 独立假设加权\n\n- 一种给每个检验的结果分配权重增加统计效果的方法\n- 增加更多的原假设拒绝以更好筛选那些显出差异明显的基因\n\n```r\n# 使用R包IHW\nlibrary(\"IHW\")\n# 设置filterFun为ihw\nresIHW <- results(dds, filterFun=ihw)\n#\nsummary(resIHW)\nsum(resIHW$padj < 0.1, na.rm=TRUE)\nmetadata(resIHW)$ihwResult\n```\n\n## LFC收缩\n\n- 目的是为了解决低计数基因或者高离散度的数据在计算LFC时引起的误差\n- 官方文档对于3种LFC估计器的介绍\n\n| 方法:                | `apeglm` | `ashr` | `normal` |\n| ------------------ | :------: | :----: | :------: |\n| 适合LFC排名            |    ✓     |   ✓    |    ✓     |\n| 保存大LFC的尺寸          |    ✓     |   ✓    |          |\n| 可以计算s值             |    ✓     |   ✓    |          |\n| 允许使用`coef`         |    ✓     |   ✓    |    ✓     |\n| 允许使用`lfcThreshold` |    ✓     |   ✓    |    ✓     |\n| 允许使用`contrast`     |          |   ✓    |    ✓     |\n| 可以收缩交互术语           |    ✓     |   ✓    |          |\n\n- 基本用法\n\n```r\nlfcShrink(dds, coef = Comparison, type = LFCShrinkAlgorithm)\n```\n\n- 对于简单的实验设计，`apeglm`是最推荐的方法\n  - `coef`等同于`results()`中的`name`\n\n```r\nlfcShrink(dds, coef = \"Condition_B_vs_A\", type = LFCShrinkAlgorithm)\n```\n\n- 对于复杂的实验设计，由于需要指定`contrast`，所以只有`ashr`才行\n\n```r\nlfcShrink(\n dds, \n contrast = list(c(\"..1..\"),c(\"..2..\")), \n type = LFCShrinkAlgorithm\n )\n```\n\n- 打印的结果的s值：检验收缩后的LFC是否与制定的阈值`lfcThreshold`相等\n  - `lfcThreshold`默认为0\n  - 可以通过设置不同的`lfcThreshold`来检查s值的变化\n\n```r\nlfcShrink(\n dds, \n coef = Comparison, \n type = LFCShrinkAlgorithm, \n lfcThreshold = 1\n )\n```\n\n- 目前不支持IHW与LFC收缩的混用\n\n## 数据可视化\n\n### 数据转换\n\n- 数据转换**不用于**差异性表达分析，而是用于各种可视化\n  - 之后需要用到数据转换的数据用`rld`表示\n\n#### 对数化\n\n```r\nntd <- normTransform(dds)\n```\n\n#### vsd，适合>=30的大数据\n\n```r\nvsd <- vst(dds, blind = FALSE)\n```\n\n#### rlog，适合<30样本的小数据\n\n```r\nrld <- rlog(dds, blind = FALSE)\n```\n\n### 检查每个样本的计数\n\n#### 分开检查每个样本的计数分布\n\n```r\ndt[,1:ncol(dt)] %>%\n    map2(.x=., .y=names(.),\n        ~dt_GE %>%\n        ggplot(aes(x=.x)) +  \n        geom_histogram(stat='bin', bins=20) +\n        geom_freqpoly(binwidth = 1000) +\n        labs(x='Raw expression count',\n            y='Number of genes',\n            title=.y) +\n        theme_bw()\n    )\n```\n\n#### 检查所有样本计数总数\n\n```r\ncolSum_df <- colSums(dt) %>%\n as.data.frame() %>%\n rownames_to_column()\ncolnames(colSum_df) <- c('Sample', 'Counts')\ncolSum_df %>%\n  ggplot(aes(x = Sample, y = Counts / 1e6, fill = Sample)) +\n         geom_bar(stat = \"identity\") + theme_bw() +\n         labs(x = \"Sample\", y = \"Total count in millions\") +\n         theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))\n```\n\n### 样本关联性热图\n\n```r\nrld_mat <- assay(rld)\nrld_cor <- cor(rld_mat)\npheatmap(\n rld_cor_GE,\n annotation = dplyr::select(meta_dt, c('ConditionA', 'ConditionB'))\n )\n```\n\n### PCA plot\n\n```r\nrld_PCA <- plotPCA(\n rld,\n intgroup = c(\"ConditionA\", \"ConditionB\"),\n returnData = TRUE\n )\n\nrld_PCA_pv <- round(100 * attr(rld_PCA, \"percentVar\"))\n\nrld_PCA %>%\n ggplot(aes(PC1,\n      PC2,\n      color=ConditionA,\n      shape=ConditionB,\n      linetype=Time)\n     ) +\n    geom_point(size = 3) +\n    xlab(paste0(\"PC1: \",rld_GE_PCA_pv[1],\"% variance\")) +\n    ylab(paste0(\"PC2: \",rld_GE_PCA_pv[2],\"% variance\")) +\n    stat_ellipse() +\n    theme_bw()\n\n```\n\n### 变换-方差图\n\n```r\n{vsn::meanSdPlot(assay(rld), ranks = FALSE)}$gg + theme_bw()\n```\n\n### 分散估计图\n\n- 检查模型拟合的情况，对象为`DESeq()`处理过的`dds`\n\n```r\nplotDispEsts(dds)\n```\n\n### MA图\n\n- `res_lfcShrink`是`lfcShrink(dds, ...)`之后的结果\n\n```r\nplotMA(res_lfcShrink, ylim=c(-2,2))\n```\n\n### 火山图\n\n- `res_lfcShrink`是`lfcShrink(dds, ...)`之后的结果\n\n```r\nres_lfcShrink_volc <- res_lfcShrink %>%\n            as.data.frame() %>%\n            rownames_to_column(var = \"gene\") %>%\n            left_join(all_genes, by = \"gene\") %>%\n            mutate(diffexpressed = case_when(\n              {padj < 0.05} & {log2FoldChange > 1} ~ \"UP\",\n              {padj < 0.05} & {log2FoldChange < -1} ~ \"DOWN\",\n              TRUE ~ \"NO\"\n              ))\n\nres_lfcShrink_volc$diffexpressed <- factor(res_8h_vs_4h_volc$diffexpressed,levels = c(\"DOWN\", \"NO\", \"UP\"))\n\nres_lfcShrink_volc %>%\nggplot(aes(log2FoldChange, -log10(padj), color = diffexpressed))+\n  geom_hline(yintercept = -log10(0.05), linetype = \"dashed\", color = \"black\")+\n  geom_vline(xintercept = c(-1,1), linetype = \"dashed\", color = \"black\")+\n  geom_point(size = 0.8)+\n  scale_color_manual(values = c(\"#989ad6\", \"#e4e4e4\", \"#e27e9a\"),\n                     labels = c(\"DOWN\", \"NO\", \"UP\"))  +\n  theme_bw(base_size = 12)+\n  theme(legend.position = 'right',\n        legend.justification = c(0,1))+\n\n# 添加标签\n\n  geom_text_repel(data = filter(res_lfcShrink_volc, padj < 0.05 & abs(log2FoldChange) > 1),\n                  max.overlaps = getOption(\"ggrepel.max.overlaps\", default = 20),\n                  # 这里的filter很关键，筛选你想要标记的基因\n                  aes(label = GENE), # 这里的GENE就是注释部分生成的基因名称\n                  size = 3,\n                  color = 'black') +\n  xlab(\"Log2FC\")+\n  ylab(\"-Log10(FDR q-value)\")\n\n```\n\n### 基因表达热图\n\n- 使用R包`ComplexHeatmap`\n- 这个包的功能很强大，本文仅限于简单出图\n- 具体说明见[ComplexHeatmap中文版说明](https://pengpengyang94.github.io/2020/05/complexheatmap%E4%B8%AD%E6%96%87%E7%89%88%E8%AF%B4%E6%98%8E/)\n\n```r\n# 两种安装方式\ninstall.packages(\"ComplexHeatmap\")\ndevtools::install_github(\"jokergoo/ComplexHeatmap\")\n\n# 加载\nlibrary(ComplexHeatmap)\n```\n\n- 首先提取归一化处理，并将行名换成基因名\n\n```r\ncounts_dds <- counts(dds, normalized = T) %>%\n    as.data.frame() %>%\n    rownames_to_column(\"gene\") %>%\n    left_join(gene_annotation, by = \"gene\") %>%\n    select(-gene) %>%\n    column_to_rownames(\"name\")\ncounts_dds <- t(scale(t(counts_dds))) # 需要对每行进行归一化，所以得转置2次\n```\n\n- 绘制热图\n  - `SigGenes`为筛选出来的基因名\n\n```r\nHeatmap(counts_dds[SigGenes,])\n```\n";
				}
				async function compiledContent() {
					return await html();
				}
				function getHeadings() {
					return [{"depth":2,"slug":"教程","text":"教程#"},{"depth":3,"slug":"官方教程","text":"官方教程#"},{"depth":4,"slug":"analyzing-rna-seq-data-with-deseq2","text":"Analyzing RNA-seq data with DESeq2#"},{"depth":4,"slug":"rna-seq-workflow-gene-level-exploratory-analysis-and-differential-expression","text":"RNA-seq workflow: gene-level exploratory analysis and differential expression#"},{"depth":3,"slug":"其他参考","text":"其他参考#"},{"depth":4,"slug":"108-如何利用deseq2分析转录组数据","text":"108-如何利用DESeq2分析转录组数据？#"},{"depth":4,"slug":"rna-seq分析微信公众号文章","text":"RNA-seq分析（微信公众号文章）#"},{"depth":4,"slug":"jwindlerice_storygithub仓库","text":"Jwindler/Ice_story（Github仓库）#"},{"depth":4,"slug":"使用deseq2分析rna-seq数据","text":"使用DESeq2分析RNA-seq数据#"},{"depth":2,"slug":"并行运算","text":"并行运算#"},{"depth":2,"slug":"数据导入","text":"数据导入#"},{"depth":2,"slug":"基因预过滤","text":"基因预过滤#"},{"depth":2,"slug":"比较级别","text":"比较级别#"},{"depth":2,"slug":"基因注释","text":"基因注释#"},{"depth":3,"slug":"biomart","text":"biomaRt#"},{"depth":3,"slug":"genome-wide-annotation包","text":"Genome wide annotation包#"},{"depth":2,"slug":"差异性表达分析","text":"差异性表达分析#"},{"depth":3,"slug":"wald检验","text":"Wald检验#"},{"depth":3,"slug":"似然比检验lrt检验","text":"似然比检验（LRT检验）#"},{"depth":4,"slug":"简单的实验设计-condition","text":"简单的实验设计：~ Condition#"},{"depth":4,"slug":"复杂点的实验设计-conditiona--conditionb","text":"复杂点的实验设计：~ ConditionA + ConditionB#"},{"depth":4,"slug":"交互作用-conditiona--conditionb--conditionaconditionb","text":"交互作用：~ ConditionA + ConditionB + ConditionA:ConditionB#"},{"depth":3,"slug":"查看结果","text":"查看结果#"},{"depth":4,"slug":"查看比较元素","text":"查看比较元素#"},{"depth":4,"slug":"选择比较的对象","text":"选择比较的对象#"},{"depth":4,"slug":"整理筛选打印结果","text":"整理，筛选，打印结果#"},{"depth":4,"slug":"p值调整","text":"p值调整#"},{"depth":5,"slug":"传统调整方法","text":"传统调整方法#"},{"depth":5,"slug":"独立假设加权","text":"独立假设加权#"},{"depth":2,"slug":"lfc收缩","text":"LFC收缩#"},{"depth":2,"slug":"数据可视化","text":"数据可视化#"},{"depth":3,"slug":"数据转换","text":"数据转换#"},{"depth":4,"slug":"对数化","text":"对数化#"},{"depth":4,"slug":"vsd适合30的大数据","text":"vsd，适合>=30的大数据#"},{"depth":4,"slug":"rlog适合30样本的小数据","text":"rlog，适合<30样本的小数据#"},{"depth":3,"slug":"检查每个样本的计数","text":"检查每个样本的计数#"},{"depth":4,"slug":"分开检查每个样本的计数分布","text":"分开检查每个样本的计数分布#"},{"depth":4,"slug":"检查所有样本计数总数","text":"检查所有样本计数总数#"},{"depth":3,"slug":"样本关联性热图","text":"样本关联性热图#"},{"depth":3,"slug":"pca-plot","text":"PCA plot#"},{"depth":3,"slug":"变换-方差图","text":"变换-方差图#"},{"depth":3,"slug":"分散估计图","text":"分散估计图#"},{"depth":3,"slug":"ma图","text":"MA图#"},{"depth":3,"slug":"火山图","text":"火山图#"},{"depth":3,"slug":"基因表达热图","text":"基因表达热图#"}];
				}

				const Content = createComponent((result, _props, slots) => {
					const { layout, ...content } = frontmatter;
					content.file = file;
					content.url = url;

					return renderTemplate`${maybeRenderHead()}${unescapeHTML(html())}`;
				});

export { Content, compiledContent, Content as default, file, frontmatter, getHeadings, rawContent, url };
