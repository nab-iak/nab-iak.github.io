const _astro_dataLayerContent = [["Map",1,2,9,10,101,102],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.7.10","content-config-digest","1c2e1cd3cc1c8bde","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://nab-iak.github.io\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"always\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image/\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[]},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[null,null,null,null,null,null,null],\"rehypePlugins\":[null,null,[null,{\"components\":{}}],[null,{\"behavior\":\"append\",\"properties\":{\"className\":[\"anchor\"]},\"content\":{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"anchor-icon\"],\"data-pagefind-ignore\":true},\"children\":[{\"type\":\"text\",\"value\":\"#\"}]}}]],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"responsiveImages\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false},\"legacy\":{\"collections\":false}}","spec",["Map",11,12,42,43,74,75],"about",{id:11,data:13,body:17,filePath:18,assetImports:19,digest:21,rendered:22,legacyId:41},{minutes:14,words:15,excerpt:16},1,63,"about_cover","![about_cover](./about_cover.jpg)\n>\n> - Cover Pic by [@若若秋](https://www.pixiv.net/artworks/127621011)\n\n## About\n\nJiawei Wan\n\n- PhD in Sports Medicine at University of Tsukuba, Japan.\n- Now is working at Lab of Sports Medicine, University of Tsukuba, Japan.\n\n## Research Field\n\n- Epidemiology\n- Preventive Medicine\n- Public Health\n- Bioinformatics\n\n## Contact\n\n- Email: bankaicn ※ gmail\\.com\n(please replace ※ with @)\n- Twitter: [@wujiaoshuiduole](https://x.com/wujiaoshuiduole)\n- Discord: nab_iak with the [Server](https://discord.gg/kXCRZH9Zrg)\n- Github: [@nab-iak](https://github.com/nab-iak)\n- Researchmap: [Jiawei Wan](https://researchmap.jp/bankaicn)\n- Research Gate: [Jiawei Wan](https://www.researchgate.net/profile/Jiawei_Wan4?ev=hdr_xprf)\n\n## Sources of pictures\n>\n> - Avatar Pic by [@堇](https://www.pixiv.net/artworks/119820867)\n> - Banner Pic by [@若若秋](https://www.pixiv.net/artworks/127621011)","src/content/spec/about.md",[20],"./about_cover.jpg","d5575a915ba68f76",{html:23,metadata:24},"<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;./about_cover.jpg&#x22;,&#x22;alt&#x22;:&#x22;about_cover&#x22;,&#x22;index&#x22;:0}\"></p>\n<blockquote>\n<ul>\n<li>Cover Pic by <a href=\"https://www.pixiv.net/artworks/127621011\">@若若秋</a></li>\n</ul>\n</blockquote>\n<section><h2 id=\"about\">About<a class=\"anchor\" href=\"#about\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>Jiawei Wan</p><ul>\n<li>PhD in Sports Medicine at University of Tsukuba, Japan.</li>\n<li>Now is working at Lab of Sports Medicine, University of Tsukuba, Japan.</li>\n</ul></section>\n<section><h2 id=\"research-field\">Research Field<a class=\"anchor\" href=\"#research-field\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>Epidemiology</li>\n<li>Preventive Medicine</li>\n<li>Public Health</li>\n<li>Bioinformatics</li>\n</ul></section>\n<section><h2 id=\"contact\">Contact<a class=\"anchor\" href=\"#contact\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>Email: bankaicn ※ gmail.com\n(please replace ※ with @)</li>\n<li>Twitter: <a href=\"https://x.com/wujiaoshuiduole\">@wujiaoshuiduole</a></li>\n<li>Discord: nab_iak with the <a href=\"https://discord.gg/kXCRZH9Zrg\">Server</a></li>\n<li>Github: <a href=\"https://github.com/nab-iak\">@nab-iak</a></li>\n<li>Researchmap: <a href=\"https://researchmap.jp/bankaicn\">Jiawei Wan</a></li>\n<li>Research Gate: <a href=\"https://www.researchgate.net/profile/Jiawei_Wan4?ev=hdr_xprf\">Jiawei Wan</a></li>\n</ul></section>\n<section><h2 id=\"sources-of-pictures\">Sources of pictures<a class=\"anchor\" href=\"#sources-of-pictures\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><blockquote>\n<ul>\n<li>Avatar Pic by <a href=\"https://www.pixiv.net/artworks/119820867\">@堇</a></li>\n<li>Banner Pic by <a href=\"https://www.pixiv.net/artworks/127621011\">@若若秋</a></li>\n</ul>\n</blockquote></section>",{headings:25,localImagePaths:38,remoteImagePaths:39,frontmatter:13,imagePaths:40},[26,29,32,35],{depth:27,slug:11,text:28},2,"About#",{depth:27,slug:30,text:31},"research-field","Research Field#",{depth:27,slug:33,text:34},"contact","Contact#",{depth:27,slug:36,text:37},"sources-of-pictures","Sources of pictures#",[20],[],[20],"about.md","activity",{id:42,data:44,body:48,filePath:49,assetImports:50,digest:52,rendered:53,legacyId:73},{minutes:45,words:46,excerpt:47},4,878,"activity_cover","![activity_cover](./activity_cover.jpg)\n\n> - Cover Pic by [@ﾍﾅﾁｮｺ](https://www.pixiv.net/artworks/120879904)\n\n## Research Activity\n\n### Papers\n\n- <ins><b>Wan J</b></ins>, Kim J, Tsujimoto T, et al. Effectiveness and Components of Health Behavior Interventions on Increasing Physical Activity Among Healthy Young and Middle-Aged Adults: A Systematic Review with Meta-Analyses. Behav Sci (Basel). 2024;14(12):1224. Published 2024 Dec 19. doi:10.3390/bs14121224\n- <ins><b>Wan J</b></ins>, Wakaba K, Onoue T, Tsushita K, Nakata Y. Factors associated with acquiring exercise habits through health guidance for metabolic syndrome among middle-aged Japanese workers: A machine learning approach. Prev Med Rep. 2024;48:102915. Published 2024 Oct 19. doi:10.1016/j.pmedr.2024.102915\n\n### Presentations\n\n- <ins><b>Wan J</b></ins>, Kim J, Tsujimoto T, Mizushima R, Shi Y, Kiyohara K, Nakata Y. Effectiveness and Components of Health Behavior Interventions on Increasing Physical Activity among Healthy Young and Middle-aged Adults: A Systematic Review with Meta-Analyses. ARIHHP Human High Performance International Forum 2025. 2025年3月1日.\n- 水島諒子, Shi Yutong, <ins><b>Wan Jiawei</b></ins>, 清水和弘, 元永恵子, 亀井明子, 小井土 正亮, 玉井伸典, 三ツ橋利彩, 佐久間彩, 早川竜太, 中田由夫. 大学サッカー選手を対象とした栄養講習の課題: 質的研究. 中田由夫 第71回日本栄養改善学会学術総会. 2024年9月7日.\n- 水島諒子, Shi Yutong, <ins><b>Wan Jiawei</b></ins>, 清水和弘, 元永恵子, 亀井明子, 小井土 正亮, 玉井伸典, 三ツ橋利彩, 佐久間彩, 早川竜太, 中田由夫. アスリートを対象とした栄養介入試験による食事バランスガイド遵守スコアの変化. 第78回日本体力医学会大会. 2024年9月4日.\n- Shi Yutong, 于欣陽, 三ツ橋利彩, <ins><b>Wan Jiawei</b></ins>, 水島諒子, 中田由夫. コロナ禍における犬の飼育者の散歩行動の変化と自己効力感の関連. 第78回日本体力医学会大会. 2024年9月2日.\n- <ins><b>Wan Jiawei</b></ins>, 若葉京良, 津下一代, 中田由夫. 特定保健指導を受けた中年勤労者の運動習慣獲得要因の探索～機械学習を用いて～. 第26回日本運動疫学会学術総会. 2024年6月29日.\n- Shi Yutong, 于欣陽, 三ツ橋利彩, <ins><b>Wan Jiawei</b></ins>, 水島諒子, 中田由夫. コロナ禍前後における犬の飼育と運動自己効力感が労働者の身体活動量に及ぼす影響. 第26回日本運動疫学会学術総会. 2024年6月29日.\n- 水島諒子, 中田由夫, 石雨彤, <ins><b>万佳偉</b></ins>, 元永恵子, 亀井明子, 藤原昌, 中村有紀, 小井土正亮, 玉井伸典, 三ツ橋利彩, 佐久間彩, 早川竜太, 清水和弘. アスリートを対象とした栄養講習の有効性検証: ランダム化比較試験. 第70回日本栄養改善学会学術総会. 2023年9月.\n- <ins><b>Wan Jiawei</b></ins>, 若葉 京良, 津下 一代, 中田 由夫. 壮年期就労者を対象とした生活習慣病予防のための動機付け支援の技術開発に関する研究. 第23回日本健康支援学会年次学術大会・第9回日本介護予防・健康づくり学会大会・ 京都滋賀体育学会第151回大会. 2022年3月5日.\n\n### Awards\n\n- <ins><b>Wan Jiawei</b></ins>. 優秀論文賞. 筑波大学人間総合科学研究群スポーツ医学学位プログラム. 2025年3月.\n- 水島諒子, 中田由夫, 石雨彤, <ins><b>万佳偉</b></ins>, 元永恵子, 亀井明子, 藤原昌, 中村有紀, 小井土正亮, 玉井伸典, 三ツ橋利彩, 佐久間彩, 早川竜太, 清水和弘. アスリートを対象とした栄養講習の有効性検証: ランダム化比較試験. 若手学会優秀発表賞（第70回日本栄養改善学会学術総会）.日本栄養改善学会. 2023年9月.","src/content/spec/activity.md",[51],"./activity_cover.jpg","4af62b3f21362d92",{html:54,metadata:55},"<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;./activity_cover.jpg&#x22;,&#x22;alt&#x22;:&#x22;activity_cover&#x22;,&#x22;index&#x22;:0}\"></p>\n<blockquote>\n<ul>\n<li>Cover Pic by <a href=\"https://www.pixiv.net/artworks/120879904\">@ﾍﾅﾁｮｺ</a></li>\n</ul>\n</blockquote>\n<section><h2 id=\"research-activity\">Research Activity<a class=\"anchor\" href=\"#research-activity\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"papers\">Papers<a class=\"anchor\" href=\"#papers\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li><ins><b>Wan J</b></ins>, Kim J, Tsujimoto T, et al. Effectiveness and Components of Health Behavior Interventions on Increasing Physical Activity Among Healthy Young and Middle-Aged Adults: A Systematic Review with Meta-Analyses. Behav Sci (Basel). 2024;14(12):1224. Published 2024 Dec 19. doi:10.3390/bs14121224</li>\n<li><ins><b>Wan J</b></ins>, Wakaba K, Onoue T, Tsushita K, Nakata Y. Factors associated with acquiring exercise habits through health guidance for metabolic syndrome among middle-aged Japanese workers: A machine learning approach. Prev Med Rep. 2024;48:102915. Published 2024 Oct 19. doi:10.1016/j.pmedr.2024.102915</li>\n</ul></section><section><h3 id=\"presentations\">Presentations<a class=\"anchor\" href=\"#presentations\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li><ins><b>Wan J</b></ins>, Kim J, Tsujimoto T, Mizushima R, Shi Y, Kiyohara K, Nakata Y. Effectiveness and Components of Health Behavior Interventions on Increasing Physical Activity among Healthy Young and Middle-aged Adults: A Systematic Review with Meta-Analyses. ARIHHP Human High Performance International Forum 2025. 2025年3月1日.</li>\n<li>水島諒子, Shi Yutong, <ins><b>Wan Jiawei</b></ins>, 清水和弘, 元永恵子, 亀井明子, 小井土 正亮, 玉井伸典, 三ツ橋利彩, 佐久間彩, 早川竜太, 中田由夫. 大学サッカー選手を対象とした栄養講習の課題: 質的研究. 中田由夫 第71回日本栄養改善学会学術総会. 2024年9月7日.</li>\n<li>水島諒子, Shi Yutong, <ins><b>Wan Jiawei</b></ins>, 清水和弘, 元永恵子, 亀井明子, 小井土 正亮, 玉井伸典, 三ツ橋利彩, 佐久間彩, 早川竜太, 中田由夫. アスリートを対象とした栄養介入試験による食事バランスガイド遵守スコアの変化. 第78回日本体力医学会大会. 2024年9月4日.</li>\n<li>Shi Yutong, 于欣陽, 三ツ橋利彩, <ins><b>Wan Jiawei</b></ins>, 水島諒子, 中田由夫. コロナ禍における犬の飼育者の散歩行動の変化と自己効力感の関連. 第78回日本体力医学会大会. 2024年9月2日.</li>\n<li><ins><b>Wan Jiawei</b></ins>, 若葉京良, 津下一代, 中田由夫. 特定保健指導を受けた中年勤労者の運動習慣獲得要因の探索～機械学習を用いて～. 第26回日本運動疫学会学術総会. 2024年6月29日.</li>\n<li>Shi Yutong, 于欣陽, 三ツ橋利彩, <ins><b>Wan Jiawei</b></ins>, 水島諒子, 中田由夫. コロナ禍前後における犬の飼育と運動自己効力感が労働者の身体活動量に及ぼす影響. 第26回日本運動疫学会学術総会. 2024年6月29日.</li>\n<li>水島諒子, 中田由夫, 石雨彤, <ins><b>万佳偉</b></ins>, 元永恵子, 亀井明子, 藤原昌, 中村有紀, 小井土正亮, 玉井伸典, 三ツ橋利彩, 佐久間彩, 早川竜太, 清水和弘. アスリートを対象とした栄養講習の有効性検証: ランダム化比較試験. 第70回日本栄養改善学会学術総会. 2023年9月.</li>\n<li><ins><b>Wan Jiawei</b></ins>, 若葉 京良, 津下 一代, 中田 由夫. 壮年期就労者を対象とした生活習慣病予防のための動機付け支援の技術開発に関する研究. 第23回日本健康支援学会年次学術大会・第9回日本介護予防・健康づくり学会大会・ 京都滋賀体育学会第151回大会. 2022年3月5日.</li>\n</ul></section><section><h3 id=\"awards\">Awards<a class=\"anchor\" href=\"#awards\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li><ins><b>Wan Jiawei</b></ins>. 優秀論文賞. 筑波大学人間総合科学研究群スポーツ医学学位プログラム. 2025年3月.</li>\n<li>水島諒子, 中田由夫, 石雨彤, <ins><b>万佳偉</b></ins>, 元永恵子, 亀井明子, 藤原昌, 中村有紀, 小井土正亮, 玉井伸典, 三ツ橋利彩, 佐久間彩, 早川竜太, 清水和弘. アスリートを対象とした栄養講習の有効性検証: ランダム化比較試験. 若手学会優秀発表賞（第70回日本栄養改善学会学術総会）.日本栄養改善学会. 2023年9月.</li>\n</ul></section></section>",{headings:56,localImagePaths:70,remoteImagePaths:71,frontmatter:44,imagePaths:72},[57,60,64,67],{depth:27,slug:58,text:59},"research-activity","Research Activity#",{depth:61,slug:62,text:63},3,"papers","Papers#",{depth:61,slug:65,text:66},"presentations","Presentations#",{depth:61,slug:68,text:69},"awards","Awards#",[51],[],[51],"activity.md","work",{id:74,data:76,body:79,filePath:80,assetImports:81,digest:83,rendered:84,legacyId:100},{minutes:14,words:77,excerpt:78},54,"cover","![cover](./work_cover.jpg)\n>\n> - Cover Pic by [@超凶の狄璐卡](https://www.pixiv.net/artworks/121031925)\n\n## Works\n\n### 2025\n\n(Bioinformatics)\n\n- Using RNA-seq to explore the mechanism that how acupuncture effects on muscle.\n\n### 2024\n\n(Epidemiology)\n\n- The important factors effecting on physical activity among young and middle-aged adults.\n  - Using meta-analysis to find out the effective intervention components.\n  - Using machine learning to find out the factors relating to acquirement of exercise habits.","src/content/spec/work.md",[82],"./work_cover.jpg","473d9c92d2d88357",{html:85,metadata:86},"<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;./work_cover.jpg&#x22;,&#x22;alt&#x22;:&#x22;cover&#x22;,&#x22;index&#x22;:0}\"></p>\n<blockquote>\n<ul>\n<li>Cover Pic by <a href=\"https://www.pixiv.net/artworks/121031925\">@超凶の狄璐卡</a></li>\n</ul>\n</blockquote>\n<section><h2 id=\"works\">Works<a class=\"anchor\" href=\"#works\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"2025\">2025<a class=\"anchor\" href=\"#2025\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>(Bioinformatics)</p><ul>\n<li>Using RNA-seq to explore the mechanism that how acupuncture effects on muscle.</li>\n</ul></section><section><h3 id=\"2024\">2024<a class=\"anchor\" href=\"#2024\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>(Epidemiology)</p><ul>\n<li>The important factors effecting on physical activity among young and middle-aged adults.\n<ul>\n<li>Using meta-analysis to find out the effective intervention components.</li>\n<li>Using machine learning to find out the factors relating to acquirement of exercise habits.</li>\n</ul>\n</li>\n</ul></section></section>",{headings:87,localImagePaths:97,remoteImagePaths:98,frontmatter:76,imagePaths:99},[88,91,94],{depth:27,slug:89,text:90},"works","Works#",{depth:61,slug:92,text:93},"2025","2025#",{depth:61,slug:95,text:96},"2024","2024#",[82],[],[82],"work.md","posts",["Map",103,104,134,135,190,191,264,265,425,426],"p1/p1",{id:103,data:105,body:115,filePath:116,digest:117,rendered:118,legacyId:133},{title:106,published:107,draft:108,description:109,image:110,tags:111,category:112,lang:113,prevTitle:114,prevSlug:114,nextTitle:114,nextSlug:114},"Blog创建完成",["Date","2025-04-17T00:00:00.000Z"],false,"随便写点什么吧","./p1_cover.jpg",[112],"MISC","en","","> Cover Pic by [@晕欧欧](https://www.pixiv.net/artworks/121353048)\n\n## 开启我的blog\n\n随便写写各种  \n以摸鱼为主  \n有什么想到的再追加","src/content/posts/p1/p1.md","a027ff4e30e01ed4",{html:119,metadata:120},"<blockquote>\n<p>Cover Pic by <a href=\"https://www.pixiv.net/artworks/121353048\">@晕欧欧</a></p>\n</blockquote>\n<section><h2 id=\"开启我的blog\">开启我的blog<a class=\"anchor\" href=\"#开启我的blog\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>随便写写各种<br>\n以摸鱼为主<br>\n有什么想到的再追加</p></section>",{headings:121,localImagePaths:125,remoteImagePaths:126,frontmatter:127,imagePaths:132},[122],{depth:27,slug:123,text:124},"开启我的blog","开启我的blog#",[],[],{title:106,published:128,image:110,description:109,category:112,tags:129,draft:108,lang:113,minutes:14,words:130,excerpt:131},["Date","2025-04-17T00:00:00.000Z"],[112],32,"随便写写各种以摸鱼为主有什么想到的再追加",[],"p1/p1.md","p2/p2",{id:134,data:136,body:144,filePath:145,digest:146,rendered:147,legacyId:189},{title:137,published:138,draft:108,description:139,image:140,tags:141,category:143,lang:113,prevTitle:114,prevSlug:114,nextTitle:114,nextSlug:114},"[PIN] RNA-seq Analysis Service from University of Tsukuba",["Date","3025-04-18T00:00:00.000Z"],"The CHEAPEST RNA-seq service for you <3","./p2_cover.jpg",[142],"RNA-seq","Advertisement","> - Cover Pic by [@Rafa](https://www.pixiv.net/artworks/120767239)\n\n- This RNA-seq analysis services as a part of the Open Facility Program, University of Tsukuba.\n- If you wish to proceed with the request below, please contact to us. The person in charge will respond with the shipping address and other instructions.\n- Note: Samples will not be returned. Thank you for your understanding.\n\n</br>\n<center><h4>Shipping Address</h4></center>\n\n- Sport Medicine Laboratory\nRoom 060, Medical Sciences Building,\nUniversity of Tsukubaa\n1-1-1 Tennodai, Tsukuba, Ibaraki 305-8577, Japan\n- Email: rnaseq.sugasawalab.tsukuba ※ gmail\\.com  \n(please replace ※ with \\@)\n\n---\n\n## <center>Plan 1: from Extraction and Purification to Data Analysis</center>\n\n<center><h4>- 44,300 yen/sample -</h4></center>\n<center><h4>- or 311.13 dollar/sample (2025.4.17) -</h4></center>\n\n### Sample\n\n- Please submit either tissue or a homogenized solution (e.g., processed with TRIZOL, QIAZOL, or ISOGEN)\n\n---\n\n## <center>Plan 2: from Purified RNA to Data Analysis</center>\n\n<center><h4>- 37,150 yen/sample -</h4></center>\n<center><h4>- or 260.91 dollar/sample (2025.4.17) -</h4></center>\n\n### Sample\n\n- The submitted total RNA solution must meet the following criteria:\n  - A260/230 ratio ≥ 1.6\n  - A260/280 ratio ≥ 1.8\n- A total of 1.5–3 μg of RNA at a concentration of 50–100 ng/μL is required for each sample.\n\n### Note\n\n- Please submit at least 3–4 μg of total RNA if possible.\nIf the amount is less than 3 μg, library preparation may not be feasible.\n- If your sample does not meet the above requirements, please contact us.\nWe may be able to accommodate samples with low concentration or poor quality.\n\n---\n\n## <center>Plan 3: from Quality-checked RNA to Data Analysis</center>\n\n<center><h4>- 25,020 yen/sample -</h4></center>\n<center><h4>- or 175.72 dollar/sample (2025.4.17) -</h4></center>\n\n### Sample\n\n- The submitted total RNA solution after purification must meet the following criteria:\n  - A260/230 ratio ≥ 1.6\n  - A260/280 ratio ≥ 1.8\n- Confirm that RNA degradation is absent or minimal in all samples using either standard gel electrophoresis\n(agarose gel for DNA in TAE buffer) or a Bioanalyzer.\n  - For gel electrophoresis, a 28S/18S ratio of 1.6–1.8 with no smearing is ideal.\n  - For Bioanalyzer, RIN ≥ 7 is recommended.\n- Adjust RNA concentration to 100 ng/μL and ensure a total yield of 3-4 ng/μL of RNA remains.\n- A total yield of at least 30 μL is required for each sample.\n\n### Note\n\n- Even if the total yield of RNA is lower than specified, request is still possible,\nbut please note that it increases the risk of library preparation failure.\nFeel free to contact us for support, including guidance for gel electrophoresis.\n- If you require frequent support for data analysis, we may propose proceeding as a collaborative research project with the Department of Sports Medicine Analytics. Final decisions will be made based on your preferences.\n\n---\n\n## <center>Plan 4: from Quality-checked RNA to FASTQ Delivery</center>\n\n<center><h4>- 20,940 yen/sample -</h4></center>\n<center><h4>- or 147.07 dollar/sample (2025.4.17) -</h4></center>\n\n### Sample\n\n- The submitted total RNA solution after purification must meet the following criteria:\n  - A260/230 ratio ≥ 1.6\n  - A260/280 ratio ≥ 1.8\n- Confirm that RNA degradation is absent or minimal in all samples using either standard gel electrophoresis\n(agarose gel for DNA in TAE buffer) or a Bioanalyzer.\n  - For gel electrophoresis, a 28S/18S ratio of 1.6–1.8 with no smearing is ideal.\n  - For Bioanalyzer, RIN ≥ 7 is recommended.\n- Adjust RNA concentration to 100 ng/μL and ensure a total yield of 3-4 ng/μL of RNA remains.\n- A total yield of at least 30 μL is required for each sample.\n\n### Note\n\n- Even if the total yield of RNA is lower than specified, request is still possible,\nbut please note that it increases the risk of library preparation failure.\nFeel free to contact us for support, including guidance for gel electrophoresis.\n- If you require frequent support for data analysis, we may propose proceeding as a collaborative research project with the Department of Sports Medicine Analytics. Final decisions will be made based on your preferences.\n\n---\n\n## <center>Bioinformatics Analysis Support</center>\n\n<center><h4>- 4,010 yen/sample -</h4></center>\n<center><h4>- or 28.16 dollar/sample (2025.4.17) -</h4></center>\n\n- Our department provides bioinformatics analysis support using data obtained from next-generation sequencing. Based on a hearing with the requester, we conduct tailored analyses and prepare figures and tables accordingly.\n- Please note that we may be unable to perform analyses that exceed the technical capacity of our department. For users of our RNA-seq service, please use this request form if you wish to request re-analysis more than one month after data delivery.\n- Supported analyses:\nRNA-seq, ChIP-seq, and genomic DNA-seq (regularly updated).\n- Accepted data formats:\nFASTQ, expression quantification data (TPM, RPKM, read count data, etc.).\n- Supported species:\nMammals such as human, mouse, and rat, as well as bacteria.\n- Tools/software used:\nCLC Genomics Workbench, R, Python, GeneMANIA, Metascape, DAVID, GSEA,\nand others (continually updated).\n- Available visualizations:\nExpression quantification, hierarchical clustering, heatmaps, pathways, Gene Ontology (GO),\nscatter plots, volcano plots, and mutation identification.","src/content/posts/p2/p2.md","1834e76b9aceb529",{html:148,metadata:149},"<blockquote>\n<ul>\n<li>Cover Pic by <a href=\"https://www.pixiv.net/artworks/120767239\">@Rafa</a></li>\n</ul>\n</blockquote>\n<ul>\n<li>This RNA-seq analysis services as a part of the Open Facility Program, University of Tsukuba.</li>\n<li>If you wish to proceed with the request below, please contact to us. The person in charge will respond with the shipping address and other instructions.</li>\n<li>Note: Samples will not be returned. Thank you for your understanding.</li>\n</ul>\n<br>\n<center><h4>Shipping Address</h4></center>\n<ul>\n<li>Sport Medicine Laboratory\nRoom 060, Medical Sciences Building,\nUniversity of Tsukubaa\n1-1-1 Tennodai, Tsukuba, Ibaraki 305-8577, Japan</li>\n<li>Email: rnaseq.sugasawalab.tsukuba ※ gmail.com<br>\n(please replace ※ with @)</li>\n</ul>\n<hr>\n<section><h2 id=\"plan-1-from-extraction-and-purification-to-data-analysis\"><center>Plan 1: from Extraction and Purification to Data Analysis</center><a class=\"anchor\" href=\"#plan-1-from-extraction-and-purification-to-data-analysis\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><center><h4>- 44,300 yen/sample -</h4></center>\n<center><h4>- or 311.13 dollar/sample (2025.4.17) -</h4></center><section><h3 id=\"sample\">Sample<a class=\"anchor\" href=\"#sample\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>Please submit either tissue or a homogenized solution (e.g., processed with TRIZOL, QIAZOL, or ISOGEN)</li>\n</ul><hr></section></section>\n<section><h2 id=\"plan-2-from-purified-rna-to-data-analysis\"><center>Plan 2: from Purified RNA to Data Analysis</center><a class=\"anchor\" href=\"#plan-2-from-purified-rna-to-data-analysis\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><center><h4>- 37,150 yen/sample -</h4></center>\n<center><h4>- or 260.91 dollar/sample (2025.4.17) -</h4></center><section><h3 id=\"sample-1\">Sample<a class=\"anchor\" href=\"#sample-1\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>The submitted total RNA solution must meet the following criteria:\n<ul>\n<li>A260/230 ratio ≥ 1.6</li>\n<li>A260/280 ratio ≥ 1.8</li>\n</ul>\n</li>\n<li>A total of 1.5–3 μg of RNA at a concentration of 50–100 ng/μL is required for each sample.</li>\n</ul></section><section><h3 id=\"note\">Note<a class=\"anchor\" href=\"#note\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>Please submit at least 3–4 μg of total RNA if possible.\nIf the amount is less than 3 μg, library preparation may not be feasible.</li>\n<li>If your sample does not meet the above requirements, please contact us.\nWe may be able to accommodate samples with low concentration or poor quality.</li>\n</ul><hr></section></section>\n<section><h2 id=\"plan-3-from-quality-checked-rna-to-data-analysis\"><center>Plan 3: from Quality-checked RNA to Data Analysis</center><a class=\"anchor\" href=\"#plan-3-from-quality-checked-rna-to-data-analysis\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><center><h4>- 25,020 yen/sample -</h4></center>\n<center><h4>- or 175.72 dollar/sample (2025.4.17) -</h4></center><section><h3 id=\"sample-2\">Sample<a class=\"anchor\" href=\"#sample-2\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>The submitted total RNA solution after purification must meet the following criteria:\n<ul>\n<li>A260/230 ratio ≥ 1.6</li>\n<li>A260/280 ratio ≥ 1.8</li>\n</ul>\n</li>\n<li>Confirm that RNA degradation is absent or minimal in all samples using either standard gel electrophoresis\n(agarose gel for DNA in TAE buffer) or a Bioanalyzer.\n<ul>\n<li>For gel electrophoresis, a 28S/18S ratio of 1.6–1.8 with no smearing is ideal.</li>\n<li>For Bioanalyzer, RIN ≥ 7 is recommended.</li>\n</ul>\n</li>\n<li>Adjust RNA concentration to 100 ng/μL and ensure a total yield of 3-4 ng/μL of RNA remains.</li>\n<li>A total yield of at least 30 μL is required for each sample.</li>\n</ul></section><section><h3 id=\"note-1\">Note<a class=\"anchor\" href=\"#note-1\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>Even if the total yield of RNA is lower than specified, request is still possible,\nbut please note that it increases the risk of library preparation failure.\nFeel free to contact us for support, including guidance for gel electrophoresis.</li>\n<li>If you require frequent support for data analysis, we may propose proceeding as a collaborative research project with the Department of Sports Medicine Analytics. Final decisions will be made based on your preferences.</li>\n</ul><hr></section></section>\n<section><h2 id=\"plan-4-from-quality-checked-rna-to-fastq-delivery\"><center>Plan 4: from Quality-checked RNA to FASTQ Delivery</center><a class=\"anchor\" href=\"#plan-4-from-quality-checked-rna-to-fastq-delivery\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><center><h4>- 20,940 yen/sample -</h4></center>\n<center><h4>- or 147.07 dollar/sample (2025.4.17) -</h4></center><section><h3 id=\"sample-3\">Sample<a class=\"anchor\" href=\"#sample-3\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>The submitted total RNA solution after purification must meet the following criteria:\n<ul>\n<li>A260/230 ratio ≥ 1.6</li>\n<li>A260/280 ratio ≥ 1.8</li>\n</ul>\n</li>\n<li>Confirm that RNA degradation is absent or minimal in all samples using either standard gel electrophoresis\n(agarose gel for DNA in TAE buffer) or a Bioanalyzer.\n<ul>\n<li>For gel electrophoresis, a 28S/18S ratio of 1.6–1.8 with no smearing is ideal.</li>\n<li>For Bioanalyzer, RIN ≥ 7 is recommended.</li>\n</ul>\n</li>\n<li>Adjust RNA concentration to 100 ng/μL and ensure a total yield of 3-4 ng/μL of RNA remains.</li>\n<li>A total yield of at least 30 μL is required for each sample.</li>\n</ul></section><section><h3 id=\"note-2\">Note<a class=\"anchor\" href=\"#note-2\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>Even if the total yield of RNA is lower than specified, request is still possible,\nbut please note that it increases the risk of library preparation failure.\nFeel free to contact us for support, including guidance for gel electrophoresis.</li>\n<li>If you require frequent support for data analysis, we may propose proceeding as a collaborative research project with the Department of Sports Medicine Analytics. Final decisions will be made based on your preferences.</li>\n</ul><hr></section></section>\n<section><h2 id=\"bioinformatics-analysis-support\"><center>Bioinformatics Analysis Support</center><a class=\"anchor\" href=\"#bioinformatics-analysis-support\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><center><h4>- 4,010 yen/sample -</h4></center>\n<center><h4>- or 28.16 dollar/sample (2025.4.17) -</h4></center><ul>\n<li>Our department provides bioinformatics analysis support using data obtained from next-generation sequencing. Based on a hearing with the requester, we conduct tailored analyses and prepare figures and tables accordingly.</li>\n<li>Please note that we may be unable to perform analyses that exceed the technical capacity of our department. For users of our RNA-seq service, please use this request form if you wish to request re-analysis more than one month after data delivery.</li>\n<li>Supported analyses:\nRNA-seq, ChIP-seq, and genomic DNA-seq (regularly updated).</li>\n<li>Accepted data formats:\nFASTQ, expression quantification data (TPM, RPKM, read count data, etc.).</li>\n<li>Supported species:\nMammals such as human, mouse, and rat, as well as bacteria.</li>\n<li>Tools/software used:\nCLC Genomics Workbench, R, Python, GeneMANIA, Metascape, DAVID, GSEA,\nand others (continually updated).</li>\n<li>Available visualizations:\nExpression quantification, hierarchical clustering, heatmaps, pathways, Gene Ontology (GO),\nscatter plots, volcano plots, and mutation identification.</li>\n</ul></section>",{headings:150,localImagePaths:182,remoteImagePaths:183,frontmatter:184,imagePaths:188},[151,154,157,160,162,165,168,170,172,175,177,179],{depth:27,slug:152,text:153},"plan-1-from-extraction-and-purification-to-data-analysis","Plan 1: from Extraction and Purification to Data Analysis#",{depth:61,slug:155,text:156},"sample","Sample#",{depth:27,slug:158,text:159},"plan-2-from-purified-rna-to-data-analysis","Plan 2: from Purified RNA to Data Analysis#",{depth:61,slug:161,text:156},"sample-1",{depth:61,slug:163,text:164},"note","Note#",{depth:27,slug:166,text:167},"plan-3-from-quality-checked-rna-to-data-analysis","Plan 3: from Quality-checked RNA to Data Analysis#",{depth:61,slug:169,text:156},"sample-2",{depth:61,slug:171,text:164},"note-1",{depth:27,slug:173,text:174},"plan-4-from-quality-checked-rna-to-fastq-delivery","Plan 4: from Quality-checked RNA to FASTQ Delivery#",{depth:61,slug:176,text:156},"sample-3",{depth:61,slug:178,text:164},"note-2",{depth:27,slug:180,text:181},"bioinformatics-analysis-support","Bioinformatics Analysis Support#",[],[],{title:137,published:185,image:140,description:139,category:143,tags:186,draft:108,lang:113,minutes:61,words:187,excerpt:114},["Date","3025-04-18T00:00:00.000Z"],[142],692,[],"p2/p2.md","p3/p3",{id:190,data:192,body:202,filePath:203,assetImports:204,digest:211,rendered:212,legacyId:263},{title:193,published:194,draft:108,description:195,image:196,tags:197,category:201,lang:113,prevTitle:114,prevSlug:114,nextTitle:114,nextSlug:114},"DESeq2中多因子设计",["Date","2025-04-19T00:00:00.000Z"],"复杂实验设计时DESeq2中的实验设计写法及含义","./p3_cover.jpg",[198,199,200],"DESeq2","R","ZH-CN","Bioinformatics","> - Cover Pic by [@Rvoid_0](https://www.pixiv.net/artworks/129206493)\n\n> 内容来自[DnA lab short read sequencing workshop-Multifactor Designs in DESeq2](https://www.youtube.com/watch?v=X6p3E-QTcUc)以及个人的额外补充\n\n## 交互作用\n\n### 2X2设计\n\n#### 设计矩阵\n\n- 这里的实验设计， `~ Genotype + Treatment + Genotype:Treatment`\n- 其中\n  - Genotype：1，2\n  - Treatment：Control，Treatment\n  - 原视频中首字母都是小写，为了看的更清晰我改成了首字母大写\n  - 在读取meta data之后，要factor一下，并且按照对比的顺序设定levels\n- 查看研究设计矩阵的代码\n\n```r\nmodel.matrix(~ Genotype + Treatment + Genotype:Treatment, data = meta_dt)\n```\n\n![image_1](./image_1.png)\n\n- 图形直观查看设计矩阵\n  - 输出的是图片，内容大致如下\n\n```r\nvd <- ExploreModelMatrix::VisualizeDesign(sampleData = colData(dds), \n                      designFormula = ~ Genotype + Treatment + Genotype:Treatment)\nvd$plot\n```\n\n<table class=\"dataframe\">\n<caption>A tibble: 2 x 3</caption>\n<thead>\n <tr><th scope=col>Genotype</th><th scope=col>Con</th><th scope=col>Treatment</th></tr>\n <tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n</thead>\n<tbody>\n <tr><td>1</td><td>(Intercept) +\n Time8h</td><td>(Intercept) +\n TreatmentTreatment +\n Genotype2.TreatmentTreatment</td></tr>\n <tr><td>2</td><td>(Intercept)           </td><td>(Intercept) +\n TreatmentTreatment                                  </td></tr>\n</tbody>\n</table>\n\n![image_2](./image_2.png)\n\n- 解释\n  - Genotype 1 Control：对照\n  - Genotype 2 Treatment：Genotype 1接受处理；\n    - 与Genotype 1 Control的差值，为蓝色箭头\n      - 表示在经过处理后，与Genotype 1 Control的差值\n  - Genotype 2 Control：Genotype 2型的对照；\n    - 与Genotype 1 Control的差值，为红色箭头\n      - 表示在未经过任何处理，单纯由于genotype影响的情况\n  - Genotype 2 Treatment：Genotype 2型接受处理；\n    - 与Genotype 2 Control的差值，为深蓝色箭头\n      - 表示在经过处理后，与Genotype 2 Control的差值\n    - 如果不存在交互作用，那么它和Genotype 2 Control的差值理应相同，\n    即差值为蓝色箭头\n    - 交互作用，即**实际的差值和理论的差值的差**\n      - 检验交互作用，就是**实际的差值和理论的差值的差是否为0**\n      - 即，**深蓝色箭头（实际）-蓝色箭头（理论）是否为0**\n\n#### contrast参数中的项名\n\n- `contrast`中的项名不是自定义的，而是根据矩阵生成的\n- 通过`resultsNames()`查看所有的项名\n\n```r\nresultsNames(dds)\n```\n\n#### 对交互作用的检验\n\n- 直接对交互项检验即可\n  - 这里是和`~1`比的\n  - `~1`就是截距项，  \n   就是和Genotype 1 Control进行差值对比，  \n   检验上述交互项代表的实际与理论差值是否为0\n\n```r\nresults(dds, contrast = c(\"Genotype2.TreatmentTreatment\"))\n```\n\n#### 对Genotype 2实际效果的验证\n\n- 交互项 = 实际 - 理论，  \n  那么简单的等式移项就可以得到，实际 = 交互 + 理论\n- 对Genotype 2实际效果，即为深蓝色箭头\n\n```r\nresults(dds, contrast = list(c(\"Treatment_Treatment_vs_Control\",\"Genotype2.TreatmentTreatment\")))\n```\n\n- 这里最终可以看到\n  - 第一行中的公式中出现了加号\n  - 即最终的取值是list中的向量包含的两个项的和\n  - list中最多包含两个向量\n    - 第一个向量是比较项\n    - 第二个向量是被比较项\n    - 当没有输入第二个向量的时候，即为与`~1`截距项比较\n\n![image_3](./image_3.png)\n\n### Con，A，B，A+B设计\n\n#### 设计矩阵\n\n- meta data格式\n\n![image_4](./image_4.png)\n\n- 实验设计， `~ Treatment1 + Treatment2 + Treatment1:Treatment2`\n\n## 更复杂的实验设计\n\n### 2组X多时间节点\n\n- 2种细胞（Control，Mutant） 在4个时间点（0，6，12，24h）的基因表达\n\n![image_5](./image_5.png)\n\n- 分析思路\n  - 时间点两两比较\n    - 6h vs 0h\n    - 12h vs 0h\n    - 24h vs 0h\n    - 12h vs 6h\n    - 24h vs 12h\n    - 24h vs 12h\n    - 问题\n      - 没有充分利用时间序列的信息，得到的结果不全面\n  - 充分利用时间序列的本质，跨越全部时间段进行多组比较\n    - 在本例中，2种**对比设计**（用以区别实验设计）\n      - 简化版模型：不考虑细胞种类的影响\n      - 全面版模型：考虑细胞种类的影响\n\n### 对比设计\n\n- 首先得判断是否有必要使用全面版模型，因此需要做一个简单对比\n- 在`DESeqDataSetFromMatrix()`中还是要填写完整的实验设计\n  - `~ Batch + Genotype + Time + Genotype:Time`\n\n```r\ndds <- DESeqDataSetFromMatrix(\n countData = countMatrix,\n colData = metaData,\n design = ~ Batch + Genotype + Time + Genotype:Time)\n```\n\n- 由于存在多levels的比较，  \n  正如t检验用于双样本，ANOVA适用于多样本一样，  \n  Wald检验用于双样本，而LRT用于多样本\n  - `test = \"wald`是默认的，改用LRT需要声明一下\n  - 要注意：`reduced`中填写**简化后**保留的变量，而并非要剔除的变量s\n\n#### 简化版模型\n\n```r\ndds_full <- DESeq(dds, test = \"LRT\", reduced = ~ Batch + Time)\n```\n\n![image_6](./image_6.png)\n\n- 结果中的`baseMean`，`log2FoldChange`等结果均无实际意义\n- 这里主要关注的是统计量`stat`以及p值`pval`\n\n## 原视频\n\n<iframe width=\"100%\" height=\"468\" src=\"https://www.youtube.com/embed/X6p3E-QTcUc\" title=\"Multifactor Designs in DESeq2\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>","src/content/posts/p3/p3.md",[205,206,207,208,209,210],"./image_1.png","./image_2.png","./image_3.png","./image_4.png","./image_5.png","./image_6.png","e6ccd557741c146a",{html:213,metadata:214},"<blockquote>\n<ul>\n<li>Cover Pic by <a href=\"https://www.pixiv.net/artworks/129206493\">@Rvoid_0</a></li>\n</ul>\n</blockquote>\n<blockquote>\n<p>内容来自<a href=\"https://www.youtube.com/watch?v=X6p3E-QTcUc\">DnA lab short read sequencing workshop-Multifactor Designs in DESeq2</a>以及个人的额外补充</p>\n</blockquote>\n<section><h2 id=\"交互作用\">交互作用<a class=\"anchor\" href=\"#交互作用\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"2x2设计\">2X2设计<a class=\"anchor\" href=\"#2x2设计\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"设计矩阵\">设计矩阵<a class=\"anchor\" href=\"#设计矩阵\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>这里的实验设计， <code>~ Genotype + Treatment + Genotype:Treatment</code></li>\n<li>其中\n<ul>\n<li>Genotype：1，2</li>\n<li>Treatment：Control，Treatment</li>\n<li>原视频中首字母都是小写，为了看的更清晰我改成了首字母大写</li>\n<li>在读取meta data之后，要factor一下，并且按照对比的顺序设定levels</li>\n</ul>\n</li>\n<li>查看研究设计矩阵的代码</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#79B8FF\">model.matrix</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">~</span><span style=\"color:#E1E4E8\"> Genotype </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> Treatment </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> Genotype</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\">Treatment, </span><span style=\"color:#FFAB70\">data</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> meta_dt)</span></span></code></pre><p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;./image_1.png&#x22;,&#x22;alt&#x22;:&#x22;image_1&#x22;,&#x22;index&#x22;:0}\"></p><ul>\n<li>图形直观查看设计矩阵\n<ul>\n<li>输出的是图片，内容大致如下</li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">vd </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#B392F0\"> ExploreModelMatrix</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">VisualizeDesign</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">sampleData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> colData</span><span style=\"color:#E1E4E8\">(dds), </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                      designFormula</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> Genotype </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> Treatment </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> Genotype</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\">Treatment)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">vd</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">plot</span></span></code></pre><table class=\"dataframe\">\n<caption>A tibble: 2 x 3</caption>\n<thead>\n <tr><th scope=\"col\">Genotype</th><th scope=\"col\">Con</th><th scope=\"col\">Treatment</th></tr>\n <tr><th scope=\"col\">&#x3C;dbl></th><th scope=\"col\">&#x3C;chr></th><th scope=\"col\">&#x3C;chr></th></tr>\n</thead>\n<tbody>\n <tr><td>1</td><td>(Intercept) +\n Time8h</td><td>(Intercept) +\n TreatmentTreatment +\n Genotype2.TreatmentTreatment</td></tr>\n <tr><td>2</td><td>(Intercept)           </td><td>(Intercept) +\n TreatmentTreatment                                  </td></tr>\n</tbody>\n</table><p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;./image_2.png&#x22;,&#x22;alt&#x22;:&#x22;image_2&#x22;,&#x22;index&#x22;:0}\"></p><ul>\n<li>解释\n<ul>\n<li>Genotype 1 Control：对照</li>\n<li>Genotype 2 Treatment：Genotype 1接受处理；\n<ul>\n<li>与Genotype 1 Control的差值，为蓝色箭头\n<ul>\n<li>表示在经过处理后，与Genotype 1 Control的差值</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Genotype 2 Control：Genotype 2型的对照；\n<ul>\n<li>与Genotype 1 Control的差值，为红色箭头\n<ul>\n<li>表示在未经过任何处理，单纯由于genotype影响的情况</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Genotype 2 Treatment：Genotype 2型接受处理；\n<ul>\n<li>与Genotype 2 Control的差值，为深蓝色箭头\n<ul>\n<li>表示在经过处理后，与Genotype 2 Control的差值</li>\n</ul>\n</li>\n<li>如果不存在交互作用，那么它和Genotype 2 Control的差值理应相同，\n即差值为蓝色箭头</li>\n<li>交互作用，即<strong>实际的差值和理论的差值的差</strong>\n<ul>\n<li>检验交互作用，就是<strong>实际的差值和理论的差值的差是否为0</strong></li>\n<li>即，<strong>深蓝色箭头（实际）-蓝色箭头（理论）是否为0</strong></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul></section><section><h4 id=\"contrast参数中的项名\">contrast参数中的项名<a class=\"anchor\" href=\"#contrast参数中的项名\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li><code>contrast</code>中的项名不是自定义的，而是根据矩阵生成的</li>\n<li>通过<code>resultsNames()</code>查看所有的项名</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">resultsNames</span><span style=\"color:#E1E4E8\">(dds)</span></span></code></pre></section><section><h4 id=\"对交互作用的检验\">对交互作用的检验<a class=\"anchor\" href=\"#对交互作用的检验\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>直接对交互项检验即可\n<ul>\n<li>这里是和<code>~1</code>比的</li>\n<li><code>~1</code>就是截距项，<br>\n就是和Genotype 1 Control进行差值对比，<br>\n检验上述交互项代表的实际与理论差值是否为0</li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">contrast</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"Genotype2.TreatmentTreatment\"</span><span style=\"color:#E1E4E8\">))</span></span></code></pre></section><section><h4 id=\"对genotype-2实际效果的验证\">对Genotype 2实际效果的验证<a class=\"anchor\" href=\"#对genotype-2实际效果的验证\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>交互项 = 实际 - 理论，<br>\n那么简单的等式移项就可以得到，实际 = 交互 + 理论</li>\n<li>对Genotype 2实际效果，即为深蓝色箭头</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">contrast</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> list</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"Treatment_Treatment_vs_Control\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"Genotype2.TreatmentTreatment\"</span><span style=\"color:#E1E4E8\">)))</span></span></code></pre><ul>\n<li>这里最终可以看到\n<ul>\n<li>第一行中的公式中出现了加号</li>\n<li>即最终的取值是list中的向量包含的两个项的和</li>\n<li>list中最多包含两个向量\n<ul>\n<li>第一个向量是比较项</li>\n<li>第二个向量是被比较项</li>\n<li>当没有输入第二个向量的时候，即为与<code>~1</code>截距项比较</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul><p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;./image_3.png&#x22;,&#x22;alt&#x22;:&#x22;image_3&#x22;,&#x22;index&#x22;:0}\"></p></section></section><section><h3 id=\"conabab设计\">Con，A，B，A+B设计<a class=\"anchor\" href=\"#conabab设计\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"设计矩阵-1\">设计矩阵<a class=\"anchor\" href=\"#设计矩阵-1\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>meta data格式</li>\n</ul><p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;./image_4.png&#x22;,&#x22;alt&#x22;:&#x22;image_4&#x22;,&#x22;index&#x22;:0}\"></p><ul>\n<li>实验设计， <code>~ Treatment1 + Treatment2 + Treatment1:Treatment2</code></li>\n</ul></section></section></section>\n<section><h2 id=\"更复杂的实验设计\">更复杂的实验设计<a class=\"anchor\" href=\"#更复杂的实验设计\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"2组x多时间节点\">2组X多时间节点<a class=\"anchor\" href=\"#2组x多时间节点\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>2种细胞（Control，Mutant） 在4个时间点（0，6，12，24h）的基因表达</li>\n</ul><p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;./image_5.png&#x22;,&#x22;alt&#x22;:&#x22;image_5&#x22;,&#x22;index&#x22;:0}\"></p><ul>\n<li>分析思路\n<ul>\n<li>时间点两两比较\n<ul>\n<li>6h vs 0h</li>\n<li>12h vs 0h</li>\n<li>24h vs 0h</li>\n<li>12h vs 6h</li>\n<li>24h vs 12h</li>\n<li>24h vs 12h</li>\n<li>问题\n<ul>\n<li>没有充分利用时间序列的信息，得到的结果不全面</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>充分利用时间序列的本质，跨越全部时间段进行多组比较\n<ul>\n<li>在本例中，2种<strong>对比设计</strong>（用以区别实验设计）\n<ul>\n<li>简化版模型：不考虑细胞种类的影响</li>\n<li>全面版模型：考虑细胞种类的影响</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul></section><section><h3 id=\"对比设计\">对比设计<a class=\"anchor\" href=\"#对比设计\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>首先得判断是否有必要使用全面版模型，因此需要做一个简单对比</li>\n<li>在<code>DESeqDataSetFromMatrix()</code>中还是要填写完整的实验设计\n<ul>\n<li><code>~ Batch + Genotype + Time + Genotype:Time</code></li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeqDataSetFromMatrix</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> countData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> countMatrix,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> colData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> metaData,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> design</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> Batch </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> Genotype </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> Time </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> Genotype</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\">Time)</span></span></code></pre><ul>\n<li>由于存在多levels的比较，<br>\n正如t检验用于双样本，ANOVA适用于多样本一样，<br>\nWald检验用于双样本，而LRT用于多样本\n<ul>\n<li><code>test = \"wald</code>是默认的，改用LRT需要声明一下</li>\n<li>要注意：<code>reduced</code>中填写<strong>简化后</strong>保留的变量，而并非要剔除的变量s</li>\n</ul>\n</li>\n</ul><section><h4 id=\"简化版模型\">简化版模型<a class=\"anchor\" href=\"#简化版模型\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dds_full </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">test</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"LRT\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">reduced</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> Batch </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> Time)</span></span></code></pre><p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;./image_6.png&#x22;,&#x22;alt&#x22;:&#x22;image_6&#x22;,&#x22;index&#x22;:0}\"></p><ul>\n<li>结果中的<code>baseMean</code>，<code>log2FoldChange</code>等结果均无实际意义</li>\n<li>这里主要关注的是统计量<code>stat</code>以及p值<code>pval</code></li>\n</ul></section></section></section>\n<section><h2 id=\"原视频\">原视频<a class=\"anchor\" href=\"#原视频\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><iframe width=\"100%\" height=\"468\" src=\"https://www.youtube.com/embed/X6p3E-QTcUc\" title=\"Multifactor Designs in DESeq2\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe></section>",{headings:215,localImagePaths:254,remoteImagePaths:255,frontmatter:256,imagePaths:262},[216,219,222,225,228,231,234,237,239,242,245,248,251],{depth:27,slug:217,text:218},"交互作用","交互作用#",{depth:61,slug:220,text:221},"2x2设计","2X2设计#",{depth:45,slug:223,text:224},"设计矩阵","设计矩阵#",{depth:45,slug:226,text:227},"contrast参数中的项名","contrast参数中的项名#",{depth:45,slug:229,text:230},"对交互作用的检验","对交互作用的检验#",{depth:45,slug:232,text:233},"对genotype-2实际效果的验证","对Genotype 2实际效果的验证#",{depth:61,slug:235,text:236},"conabab设计","Con，A，B，A+B设计#",{depth:45,slug:238,text:224},"设计矩阵-1",{depth:27,slug:240,text:241},"更复杂的实验设计","更复杂的实验设计#",{depth:61,slug:243,text:244},"2组x多时间节点","2组X多时间节点#",{depth:61,slug:246,text:247},"对比设计","对比设计#",{depth:45,slug:249,text:250},"简化版模型","简化版模型#",{depth:27,slug:252,text:253},"原视频","原视频#",[205,206,207,208,209,210],[],{title:193,published:257,image:196,description:195,category:201,tags:258,draft:108,lang:113,minutes:259,words:260,excerpt:261},["Date","2025-04-19T00:00:00.000Z"],[198,199,200],5,1048,"image_1",[205,206,207,208,209,210],"p3/p3.md","p4/p4",{id:264,data:266,body:273,filePath:274,digest:275,rendered:276,legacyId:424},{title:267,published:268,draft:108,description:269,image:270,tags:271,category:201,lang:113,prevTitle:114,prevSlug:114,nextTitle:114,nextSlug:114},"用DESeq2进行差异性分析",["Date","2025-04-28T00:00:00.000Z"],"DESeq2的简明教程","./p4_cover.png",[142,198,199,200,272],"Visualization","> - Cover Pic by [@saturn_illus](https://www.pixiv.net/artworks/129087864)\n>\n## 教程\n\n### 官方教程\n\n#### Analyzing RNA-seq data with DESeq2\n\n- 介绍了一般的分析方法\n\n```\nhttps://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#interactions\n```\n\n#### RNA-seq workflow: gene-level exploratory analysis and differential expression\n\n- 介绍了更加丰富的用法，用于第一个教程的补充\n\n```r\n# install the package\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\nBiocManager::install(\"rnaseqGene\")\n\n# view the vignettes\nbrowseVignettes(\"rnaseqGene\")\n```\n\n### 其他参考\n\n#### 108-如何利用DESeq2分析转录组数据？\n\n```\nhttps://www.jieandze1314.com/post/cnposts/108/\n```\n\n#### RNA-seq分析（微信公众号文章）\n\n```\nhttps://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkwMzQwNjYyNg==&action=getalbum&album_id=2673613335581474816#wechat_redirect\n```\n\n#### Jwindler/Ice_story（Github仓库）\n\n```\nhttps://github.com/Jwindler/Ice_story?tab=readme-ov-file\n```\n\n#### 使用DESeq2分析RNA-seq数据\n\n```\nhttp://xuchunhui.top/2020/03/28/%E4%BD%BF%E7%94%A8DEseq2%E5%88%86%E6%9E%90RNA-seq%E6%95%B0%E6%8D%AE/\n```\n\n## 并行运算\n\n- 初始设置\n\n```R\nlibrary(\"BiocParallel\") # 载入R包\nregister(MulticoreParam(4)) # 设置并行内核为4\n```\n\n- 后续的分析中，如果有`parallel`参数都可以设置`TRUE`来使用\n\n```r\nDESeq(..., parallel = TRUE)\nlfcShrink(..., parallel = TRUE)\n```\n\n## 数据导入\n\n- DESeq2必须输入计数矩阵（counts matrix）\n- 对于计数矩阵，一般用`DESeqDataSetFromMatrix()`即可\n- 用下列函数能创造一个`DEseqDataSet`对象（一般略称为**dds**），需要声明：\n- colData：包含样本信息的meta data\n- desgin：实验设计，用formula类型表示`~ Condition`\n\n```r\ndds <- DESeqDataSetFromMatrix(\n         countData = countsMatrix,\n         colData = metaData,\n         design = ~ Condition\n         )\n```\n\n| **function**      | **package**       | **framework**  | **output**           | **DESeq2 input function** |\n| ----------------- | ----------------- | -------------- | -------------------- | ------------------------- |\n| tximport          | tximport          | R/Bioconductor | list of matrices     | DESeqDataSetFromTximport  |\n| tximeta           | tximeta           | R/Bioconductor | SummarizedExperiment | DESeqDataSet              |\n| htseq-count       | HTSeq             | Python         | files                | DESeqDataSetFromHTSeq     |\n| featureCounts     | Rsubread          | R/Bioconductor | matrix               | DESeqDataSetFromMatrix    |\n| summarizeOverlaps | GenomicAlignments | R/Bioconductor | SummarizedExperiment | DESeqDataSet              |\n|                   |                   |                |                      |                           |\n\n- 查看`DEseqDataSet`对象内容\n  - 计数：`assay(dds)`，`counts(dds)`\n  - 基因信息：`rowRanges(dds)`\n  - 样本信息，即meta data：`colData(dds)`\n  - \\$查看：meta data中包含的分组\n  - \\@查看：\n    - design\n    - dispersionFunction\n    - rowRanges\n    - colData\n    - assays\n    - NAMES\n    - elementMetadata\n    - metadata\n\n## 基因预过滤\n\n- 为了提高运算性能，可以删除表达量约等于0的基因\n- 如果配置不太吃力，一般可以**不用预过滤，避免产生偏差**\n\n```r\nsmallestGroupSize <- 3\n# 设定满足筛选要求的样本最小数量\nkeep <-rowSums(dds %>% counts() >= 10) >= smallestGroupSize\n# dds %>% counts() >= 10：计算每个样本的每个基因表达量是否大于等于10，结果返回为布尔值\n# rowSums(.)：按基因（行）统计结果为TRUE的样本数量\n# rowSums(.) >= smallestGroupSize：满足筛选要求的样本最小数量（10）的基因被保留\ndds_filtered <- dds[keep, ]\n# 基本筛选语法\n```\n\n## 比较级别\n\n- 对meta data的列进行因子化\n- `levels`的第一个级别为对照组\n\n```r\n# 对dds对象进行因子化\ndds$condition <- factor(dds$condition, levels = c(\"untreated\",\"treated\"))\n# 在创建dds对象前对meta data因子化\nmetaData$condition <- factor(metaData$condition, levels = c(\"untreated\",\"treated\"))\ndds <- DESeqDataSetFromMatrix(countData = countsMatrix,\n         colData = metaData,\n         design = ~ Condition)\n```\n\n- 只指定参考级别\n\n```r\ndds$condition <- relevel(dds$condition, ref = \"untreated\")\n```\n\n- 删除子集中没有样本的级别\n- 例如有三种Condition A，B，C  \n   只选择子集A和B进行分析，数据中不包含C，但因子级别中包含，  \n   用`droplevels()`去除空白的因子级别\n\n```r\ndds$condition <- droplevels(dds$condition)\n```\n\n## 基因注释\n\n本节参考：[【R】 遺伝子ID/遺伝子名の変換方法](https://zenn.dev/rchiji/articles/99bf231c92aad9#%E3%80%90-biomart%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8-%E3%80%91)\n\n### biomaRt\n\n- 需要用到R包`biomaRt`\n\n```r\n# 安装\nif (!require(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\nBiocManager::install(\"biomaRt\")\n\n# 加载\n\nlibrary(biomaRt)\n\n```\n\n- 罗列可以选择的Marts\n\n```r\nlistMarts()\n```\n\n- 选择要用的Marts\n\n```r\ndb <- useMart(biomart = \"ENSEMBL_MART_ENSEMBL\") \n```\n\n- 以小鼠为例，在`ENSEMBL_MART_ENSEMBL`的`description`中查看包含小鼠`\"Mouse\"`的行\n\n```r\nlistDatasets(db) %>% filter(grepl(\"Mouse\",description))\n```\n\n- 把注释信息提取出来\n\n```r\nMm <- useDataset(\"mmusculus_gene_ensembl\", mart = db)\n```\n\n- 查看`mmusculus_gene_ensembl`包含的所有小鼠基因信息\n\n```r\nlistAttributes(Mm)\n```\n\n- 创建一个所有基因名字的列表\n\n```r\n# 提取需要的注释信息\ngene_annotation <- getBM(\n# 这里的attributes就是listAttributes(Mm)中选的\n    attributes = c(\"ensembl_gene_id\",\n          \"external_gene_name\",\n          \"description\"), \n mart = Mm\n    )\ngene_annotation <- gene_annotation %>%\n# 创建一个GENE的列：\n# 如果有external_gene_name就用external_gene_name\n# 如果没有就保留ensembl_gene_id\n    mutate(GENE = ifelse(external_gene_name == \"\",\n          ensembl_gene_id, \n          external_gene_name)) %>%\n    group_by(GENE) %>%\n# 由于存在相同基因名称的基因，并且变成rownames的时候是不可以有重复的\n# 给重复的基因名后面加个小尾巴 .1 .2 这种\n    mutate(\n        count = n(),\n        GENE = if_else(count == 1, GENE, paste0(GENE, \".\", row_number()))\n    ) %>%\n    ungroup() %>%\n    select(-count)\n```\n\n- 添加基因名称的时候只用`left_join()`就行了\n\n```r\nresultDataFrame %>% \n left_join(genes_annotation, by = \"gene\")\n```\n\n### Genome wide annotation包\n\n- 这个比较简单，很容易上手\n- 这个包是一个系列，都是org.XX.eg.db这种类型的\n- 但是没有预测基因，会出现很多NA的基因名\n\n```r\ngene_annotation <- ensembldb::select(x = org.Mm.eg.db, # 注释基因包\n   # 这里keys(org.Mm.eg.db,\"ENSEMBL\")提取了包里的全部基因的ENSEMBL\n            keys = keys(org.Mm.eg.db,\"ENSEMBL\"), # 需要注释的基因\n            keytype = \"ENSEMBL\", # 匹配ENSEMBL\n            # 抽取匹配到基因的\"SYMBOL\",\"ALIAS\",\"GENENAME\",\"GENETYPE\"\n            columns = c(\"SYMBOL\",\"ALIAS\",\"GENENAME\",\"GENETYPE\"))\n\nresultDataFrame %>% \n left_join(genes_annotation, \n     by = c(\"ENSEMBL\",\"SYMBOL\",\"ALIAS\",\"GENENAME\",\"GENETYPE\"))\n```\n\n## 差异性表达分析\n\n- `DESeq()`，可以执行Wald检验和LRT检验，作用对象为**dds**对象\n\n### Wald检验\n\n- 默认的选项，约等于双样本t检验\n\n```r\n# 下面两个一样\ndds <- DESeq(dds)\ndds <- DESeq(dds, test = \"Wald\")\n\n# 可以加入并行运算\n\ndds <- DESeq(dds, parallel = TRUE)\n\n```\n\n### 似然比检验（LRT检验）\n\n- 比较多样本的选项，约等于ANOVA\n- `reduced`选项表示从原有的实验设计（完整模型）**剔除**需要比较的项**后**的模型（简化模型）\n- `results()`返回的结果中，`log2FoldChange`和`lfcSE`是**没有任何实际意义**的内容\n\n> 对于使用似然比检验的分析，p 值仅由完整模型公式和简化模型公式之间的偏差差异决定  \n> 单个 log2 倍变化打印在结果表中以与其他结果表输出保持一致，但与实际测试无关\n\n#### 简单的实验设计：`~ Condition`\n\n- 检验`Condition`里不同水平是否存在差异\n\n```r\n# 因为检验Condition，所以从实验设计的formula中剔除Condition\n# 什么都没有的情况下填写~1\ndds <- DESeq(dds, test = \"LRT\", reduced = ~1)\n```\n\n#### 复杂点的实验设计：`~ ConditionA + ConditionB`\n\n- 检验`ConditionB`里不同水平是否存在差异\n\n```r\n# 同理，检验ConditionB则剔除ConditionB，保留~ ConditionA\ndds <- DESeq(dds, test = \"LRT\", reduced = ~ ConditionA)\n```\n\n#### 交互作用：`~ ConditionA + ConditionB + ConditionA:ConditionB`\n\n- 检验`ConditionB`里不同水平是否存在差异\n\n```r\n# 无论多么复杂的实验设计，检验什么就剔除什么\n# 这里检验ConditionB，所以保留~ ConditionA + ConditionA:ConditionB\ndds <- DESeq(dds, test = \"LRT\",\n    reduced = ~ ConditionA + ConditionA:ConditionB)\n```\n\n### 查看结果\n\n#### 查看比较元素\n\n- 主要用于`results()`中用`name`或`contrast`指定比较对象\n- 也可以用于`lfcShrink()`的`coef`和`contrast`指定对象\n\n```r\nresultsNames(dds)\n```\n\n#### 选择比较的对象\n\n- 对于简单的比较，`name`和`contrast`都可以\n- `name`的值不是随便起的，在用`resultsNames()`确认后使用\n- 以下3个用法是等价的\n\n```r\nres <- results(dds, name=\"condition_treated_vs_untreated\")\nres <- results(dds, contrast=c(\"condition\",\"treated\",\"untreated\"))\nres <- results(dds, contrast=list(c(\"condition_treated_vs_untreated\")))\n```\n\n- 对于复杂的比较，只能用`contrast`\n  - `c(\"condition\",\"treated\",\"untreated\")`  \n   是选择某一条件中两者进行对比，顺序为：\n    - 条件\n    - 比对项目\n    - 被比对（参考）项目\n  - 仅能包含一个向量，向量包含3个元素\n  - `list(c(\"..1..\"), c(\"..2..\"))`  \n   用于更加复杂的对比，`list()`中包含2个向量，  \n   如果只声明1个，那么另一个就是截距\n\n#### 整理，筛选，打印结果\n\n- 可以直接在`results`对象上操作\n\n```r\n# 官方文档的方法\nresOrdered <- res[order(res$pvalue),]\nsummary(res)\nsum(res$padj < 0.1, na.rm=TRUE)\nres05 <- results(dds, alpha=0.05)\nsummary(res05)\n```\n\n- 个人喜欢转换成熟悉的`data.frame`类型更方便\n\n```r\nres_df <- res %>% as.data.frame()\n```\n\n- 不建议直接使用`results()`去获取结果，  \n  可以首先通过LFC收缩`lfcShrink()`调整LFC后再获取结果\n  - 这个时候不用`results()`了，直接将LFC收缩完的对象变换成`data.frame`即可\n\n#### p值调整\n\n##### 传统调整方法\n\n- 在`results()`中可以设置p值调整的方法，默认为`\"BH\"`\n- 使用`?p.adjust`可以获取所有的调整方法：\n  - `\"holm\"`\n  - `\"hochberg\"`\n  - `\"hommel\"`\n  - `\"bonferroni\"`\n  - `\"BH\"`\n  - `\"BY\"`\n  - `\"fdr\"`\n  - `\"none\"`\n\n```r\n# BH\nresults(dds)\nresults(dds, pAdjustMethod = \"BH\")\n# Bonferroni\nresults(dds, pAdjustMethod = \"bonferroni\")\n# 其他类似\n```\n\n##### 独立假设加权\n\n- 一种给每个检验的结果分配权重增加统计效果的方法\n- 增加更多的原假设拒绝以更好筛选那些显出差异明显的基因\n\n```r\n# 使用R包IHW\nlibrary(\"IHW\")\n# 设置filterFun为ihw\nresIHW <- results(dds, filterFun=ihw)\n#\nsummary(resIHW)\nsum(resIHW$padj < 0.1, na.rm=TRUE)\nmetadata(resIHW)$ihwResult\n```\n\n## LFC收缩\n\n- 目的是为了解决低计数基因或者高离散度的数据在计算LFC时引起的误差\n- 官方文档对于3种LFC估计器的介绍\n\n| 方法:                | `apeglm` | `ashr` | `normal` |\n| ------------------ | :------: | :----: | :------: |\n| 适合LFC排名            |    ✓     |   ✓    |    ✓     |\n| 保存大LFC的尺寸          |    ✓     |   ✓    |          |\n| 可以计算s值             |    ✓     |   ✓    |          |\n| 允许使用`coef`         |    ✓     |   ✓    |    ✓     |\n| 允许使用`lfcThreshold` |    ✓     |   ✓    |    ✓     |\n| 允许使用`contrast`     |          |   ✓    |    ✓     |\n| 可以收缩交互术语           |    ✓     |   ✓    |          |\n\n- 基本用法\n\n```r\nlfcShrink(dds, coef = Comparison, type = LFCShrinkAlgorithm)\n```\n\n- 对于简单的实验设计，`apeglm`是最推荐的方法\n  - `coef`等同于`results()`中的`name`\n\n```r\nlfcShrink(dds, coef = \"Condition_B_vs_A\", type = LFCShrinkAlgorithm)\n```\n\n- 对于复杂的实验设计，由于需要指定`contrast`，所以只有`ashr`才行\n\n```r\nlfcShrink(\n dds, \n contrast = list(c(\"..1..\"),c(\"..2..\")), \n type = LFCShrinkAlgorithm\n )\n```\n\n- 打印的结果的s值：检验收缩后的LFC是否与制定的阈值`lfcThreshold`相等\n  - `lfcThreshold`默认为0\n  - 可以通过设置不同的`lfcThreshold`来检查s值的变化\n\n```r\nlfcShrink(\n dds, \n coef = Comparison, \n type = LFCShrinkAlgorithm, \n lfcThreshold = 1\n )\n```\n\n- 目前不支持IHW与LFC收缩的混用\n\n## 数据可视化\n\n### 数据转换\n\n- 数据转换**不用于**差异性表达分析，而是用于各种可视化\n  - 之后需要用到数据转换的数据用`rld`表示\n\n#### 对数化\n\n```r\nntd <- normTransform(dds)\n```\n\n#### vsd，适合>=30的大数据\n\n```r\nvsd <- vst(dds, blind = FALSE)\n```\n\n#### rlog，适合<30样本的小数据\n\n```r\nrld <- rlog(dds, blind = FALSE)\n```\n\n### 检查每个样本的计数\n\n#### 分开检查每个样本的计数分布\n\n```r\ndt[,1:ncol(dt)] %>%\n    map2(.x=., .y=names(.),\n        ~dt_GE %>%\n        ggplot(aes(x=.x)) +  \n        geom_histogram(stat='bin', bins=20) +\n        geom_freqpoly(binwidth = 1000) +\n        labs(x='Raw expression count',\n            y='Number of genes',\n            title=.y) +\n        theme_bw()\n    )\n```\n\n#### 检查所有样本计数总数\n\n```r\ncolSum_df <- colSums(dt) %>%\n as.data.frame() %>%\n rownames_to_column()\ncolnames(colSum_df) <- c('Sample', 'Counts')\ncolSum_df %>%\n  ggplot(aes(x = Sample, y = Counts / 1e6, fill = Sample)) +\n         geom_bar(stat = \"identity\") + theme_bw() +\n         labs(x = \"Sample\", y = \"Total count in millions\") +\n         theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))\n```\n\n### 样本关联性热图\n\n```r\nrld_mat <- assay(rld)\nrld_cor <- cor(rld_mat)\npheatmap(\n rld_cor_GE,\n annotation = dplyr::select(meta_dt, c('ConditionA', 'ConditionB'))\n )\n```\n\n### PCA plot\n\n```r\nrld_PCA <- plotPCA(\n rld,\n intgroup = c(\"ConditionA\", \"ConditionB\"),\n returnData = TRUE\n )\n\nrld_PCA_pv <- round(100 * attr(rld_PCA, \"percentVar\"))\n\nrld_PCA %>%\n ggplot(aes(PC1,\n      PC2,\n      color=ConditionA,\n      shape=ConditionB,\n      linetype=Time)\n     ) +\n    geom_point(size = 3) +\n    xlab(paste0(\"PC1: \",rld_GE_PCA_pv[1],\"% variance\")) +\n    ylab(paste0(\"PC2: \",rld_GE_PCA_pv[2],\"% variance\")) +\n    stat_ellipse() +\n    theme_bw()\n\n```\n\n### 变换-方差图\n\n```r\n{vsn::meanSdPlot(assay(rld), ranks = FALSE)}$gg + theme_bw()\n```\n\n### 分散估计图\n\n- 检查模型拟合的情况，对象为`DESeq()`处理过的`dds`\n\n```r\nplotDispEsts(dds)\n```\n\n### MA图\n\n- `res_lfcShrink`是`lfcShrink(dds, ...)`之后的结果\n\n```r\nplotMA(res_lfcShrink, ylim=c(-2,2))\n```\n\n### 火山图\n\n- `res_lfcShrink`是`lfcShrink(dds, ...)`之后的结果\n\n```r\nres_lfcShrink_volc <- res_lfcShrink %>%\n            as.data.frame() %>%\n            rownames_to_column(var = \"gene\") %>%\n            left_join(all_genes, by = \"gene\") %>%\n            mutate(diffexpressed = case_when(\n              {padj < 0.05} & {log2FoldChange > 1} ~ \"UP\",\n              {padj < 0.05} & {log2FoldChange < -1} ~ \"DOWN\",\n              TRUE ~ \"NO\"\n              ))\n\nres_lfcShrink_volc$diffexpressed <- factor(res_8h_vs_4h_volc$diffexpressed,levels = c(\"DOWN\", \"NO\", \"UP\"))\n\nres_lfcShrink_volc %>%\nggplot(aes(log2FoldChange, -log10(padj), color = diffexpressed))+\n  geom_hline(yintercept = -log10(0.05), linetype = \"dashed\", color = \"black\")+\n  geom_vline(xintercept = c(-1,1), linetype = \"dashed\", color = \"black\")+\n  geom_point(size = 0.8)+\n  scale_color_manual(values = c(\"#989ad6\", \"#e4e4e4\", \"#e27e9a\"),\n                     labels = c(\"DOWN\", \"NO\", \"UP\"))  +\n  theme_bw(base_size = 12)+\n  theme(legend.position = 'right',\n        legend.justification = c(0,1))+\n\n# 添加标签\n\n  geom_text_repel(data = filter(res_lfcShrink_volc, padj < 0.05 & abs(log2FoldChange) > 1),\n                  max.overlaps = getOption(\"ggrepel.max.overlaps\", default = 20),\n                  # 这里的filter很关键，筛选你想要标记的基因\n                  aes(label = GENE), # 这里的GENE就是注释部分生成的基因名称\n                  size = 3,\n                  color = 'black') +\n  xlab(\"Log2FC\")+\n  ylab(\"-Log10(FDR q-value)\")\n\n```\n\n### 基因表达热图\n\n- 使用R包`ComplexHeatmap`\n- 这个包的功能很强大，本文仅限于简单出图\n- 具体说明见[ComplexHeatmap中文版说明](https://pengpengyang94.github.io/2020/05/complexheatmap%E4%B8%AD%E6%96%87%E7%89%88%E8%AF%B4%E6%98%8E/)\n\n```r\n# 两种安装方式\ninstall.packages(\"ComplexHeatmap\")\ndevtools::install_github(\"jokergoo/ComplexHeatmap\")\n\n# 加载\nlibrary(ComplexHeatmap)\n```\n\n- 首先提取归一化处理，并将行名换成基因名\n\n```r\ncounts_dds <- counts(dds, normalized = T) %>%\n    as.data.frame() %>%\n    rownames_to_column(\"gene\") %>%\n    left_join(gene_annotation, by = \"gene\") %>%\n    select(-gene) %>%\n    column_to_rownames(\"name\")\ncounts_dds <- t(scale(t(counts_dds))) # 需要对每行进行归一化，所以得转置2次\n```\n\n- 绘制热图\n  - `SigGenes`为筛选出来的基因名\n\n```r\nHeatmap(counts_dds[SigGenes,])\n```","src/content/posts/p4/p4.md","aa56e0f8118c60c0",{html:277,metadata:278},"<blockquote>\n<ul>\n<li>Cover Pic by <a href=\"https://www.pixiv.net/artworks/129087864\">@saturn_illus</a></li>\n</ul>\n</blockquote>\n<section><h2 id=\"教程\">教程<a class=\"anchor\" href=\"#教程\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"官方教程\">官方教程<a class=\"anchor\" href=\"#官方教程\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"analyzing-rna-seq-data-with-deseq2\">Analyzing RNA-seq data with DESeq2<a class=\"anchor\" href=\"#analyzing-rna-seq-data-with-deseq2\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>介绍了一般的分析方法</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>https://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#interactions</span></span></code></pre></section><section><h4 id=\"rna-seq-workflow-gene-level-exploratory-analysis-and-differential-expression\">RNA-seq workflow: gene-level exploratory analysis and differential expression<a class=\"anchor\" href=\"#rna-seq-workflow-gene-level-exploratory-analysis-and-differential-expression\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>介绍了更加丰富的用法，用于第一个教程的补充</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># install the package</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">!</span><span style=\"color:#79B8FF\">requireNamespace</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"BiocManager\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">quietly</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">    install.packages</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"BiocManager\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">BiocManager</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">install</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"rnaseqGene\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># view the vignettes</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">browseVignettes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"rnaseqGene\"</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section></section><section><h3 id=\"其他参考\">其他参考<a class=\"anchor\" href=\"#其他参考\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"108-如何利用deseq2分析转录组数据\">108-如何利用DESeq2分析转录组数据？<a class=\"anchor\" href=\"#108-如何利用deseq2分析转录组数据\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>https://www.jieandze1314.com/post/cnposts/108/</span></span></code></pre></section><section><h4 id=\"rna-seq分析微信公众号文章\">RNA-seq分析（微信公众号文章）<a class=\"anchor\" href=\"#rna-seq分析微信公众号文章\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkwMzQwNjYyNg==&#x26;action=getalbum&#x26;album_id=2673613335581474816#wechat_redirect</span></span></code></pre></section><section><h4 id=\"jwindlerice_storygithub仓库\">Jwindler/Ice_story（Github仓库）<a class=\"anchor\" href=\"#jwindlerice_storygithub仓库\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>https://github.com/Jwindler/Ice_story?tab=readme-ov-file</span></span></code></pre></section><section><h4 id=\"使用deseq2分析rna-seq数据\">使用DESeq2分析RNA-seq数据<a class=\"anchor\" href=\"#使用deseq2分析rna-seq数据\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>http://xuchunhui.top/2020/03/28/%E4%BD%BF%E7%94%A8DEseq2%E5%88%86%E6%9E%90RNA-seq%E6%95%B0%E6%8D%AE/</span></span></code></pre></section></section></section>\n<section><h2 id=\"并行运算\">并行运算<a class=\"anchor\" href=\"#并行运算\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>初始设置</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>library(\"BiocParallel\") # 载入R包</span></span>\n<span class=\"line\"><span>register(MulticoreParam(4)) # 设置并行内核为4</span></span></code></pre><ul>\n<li>后续的分析中，如果有<code>parallel</code>参数都可以设置<code>TRUE</code>来使用</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">DESeq</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">...</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">parallel</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">...</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">parallel</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section>\n<section><h2 id=\"数据导入\">数据导入<a class=\"anchor\" href=\"#数据导入\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>DESeq2必须输入计数矩阵（counts matrix）</li>\n<li>对于计数矩阵，一般用<code>DESeqDataSetFromMatrix()</code>即可</li>\n<li>用下列函数能创造一个<code>DEseqDataSet</code>对象（一般略称为<strong>dds</strong>），需要声明：</li>\n<li>colData：包含样本信息的meta data</li>\n<li>desgin：实验设计，用formula类型表示<code>~ Condition</code></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeqDataSetFromMatrix</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         countData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> countsMatrix,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         colData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> metaData,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         design</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> Condition</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">         )</span></span></code></pre>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th><strong>function</strong></th><th><strong>package</strong></th><th><strong>framework</strong></th><th><strong>output</strong></th><th><strong>DESeq2 input function</strong></th></tr></thead><tbody><tr><td>tximport</td><td>tximport</td><td>R/Bioconductor</td><td>list of matrices</td><td>DESeqDataSetFromTximport</td></tr><tr><td>tximeta</td><td>tximeta</td><td>R/Bioconductor</td><td>SummarizedExperiment</td><td>DESeqDataSet</td></tr><tr><td>htseq-count</td><td>HTSeq</td><td>Python</td><td>files</td><td>DESeqDataSetFromHTSeq</td></tr><tr><td>featureCounts</td><td>Rsubread</td><td>R/Bioconductor</td><td>matrix</td><td>DESeqDataSetFromMatrix</td></tr><tr><td>summarizeOverlaps</td><td>GenomicAlignments</td><td>R/Bioconductor</td><td>SummarizedExperiment</td><td>DESeqDataSet</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><ul>\n<li>查看<code>DEseqDataSet</code>对象内容\n<ul>\n<li>计数：<code>assay(dds)</code>，<code>counts(dds)</code></li>\n<li>基因信息：<code>rowRanges(dds)</code></li>\n<li>样本信息，即meta data：<code>colData(dds)</code></li>\n<li>$查看：meta data中包含的分组</li>\n<li>@查看：\n<ul>\n<li>design</li>\n<li>dispersionFunction</li>\n<li>rowRanges</li>\n<li>colData</li>\n<li>assays</li>\n<li>NAMES</li>\n<li>elementMetadata</li>\n<li>metadata</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul></section>\n<section><h2 id=\"基因预过滤\">基因预过滤<a class=\"anchor\" href=\"#基因预过滤\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>为了提高运算性能，可以删除表达量约等于0的基因</li>\n<li>如果配置不太吃力，一般可以<strong>不用预过滤，避免产生偏差</strong></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">smallestGroupSize </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> 3</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 设定满足筛选要求的样本最小数量</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">keep </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\">rowSums</span><span style=\"color:#E1E4E8\">(dds </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#FFAB70\"> counts</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">>=</span><span style=\"color:#79B8FF\"> 10</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">>=</span><span style=\"color:#E1E4E8\"> smallestGroupSize</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># dds %>% counts() >= 10：计算每个样本的每个基因表达量是否大于等于10，结果返回为布尔值</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># rowSums(.)：按基因（行）统计结果为TRUE的样本数量</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># rowSums(.) >= smallestGroupSize：满足筛选要求的样本最小数量（10）的基因被保留</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds_filtered </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> dds[keep, ]</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 基本筛选语法</span></span></code></pre></section>\n<section><h2 id=\"比较级别\">比较级别<a class=\"anchor\" href=\"#比较级别\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>对meta data的列进行因子化</li>\n<li><code>levels</code>的第一个级别为对照组</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 对dds对象进行因子化</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> factor</span><span style=\"color:#E1E4E8\">(dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition, </span><span style=\"color:#FFAB70\">levels</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"untreated\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"treated\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 在创建dds对象前对meta data因子化</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">metaData</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> factor</span><span style=\"color:#E1E4E8\">(metaData</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition, </span><span style=\"color:#FFAB70\">levels</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"untreated\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"treated\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeqDataSetFromMatrix</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">countData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> countsMatrix,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         colData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> metaData,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         design</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> Condition)</span></span></code></pre><ul>\n<li>只指定参考级别</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> relevel</span><span style=\"color:#E1E4E8\">(dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition, </span><span style=\"color:#FFAB70\">ref</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"untreated\"</span><span style=\"color:#E1E4E8\">)</span></span></code></pre><ul>\n<li>删除子集中没有样本的级别</li>\n<li>例如有三种Condition A，B，C<br>\n只选择子集A和B进行分析，数据中不包含C，但因子级别中包含，<br>\n用<code>droplevels()</code>去除空白的因子级别</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> droplevels</span><span style=\"color:#E1E4E8\">(dds</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">condition)</span></span></code></pre></section>\n<section><h2 id=\"基因注释\">基因注释<a class=\"anchor\" href=\"#基因注释\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>本节参考：<a href=\"https://zenn.dev/rchiji/articles/99bf231c92aad9#%E3%80%90-biomart%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8-%E3%80%91\">【R】 遺伝子ID/遺伝子名の変換方法</a></p><section><h3 id=\"biomart\">biomaRt<a class=\"anchor\" href=\"#biomart\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>需要用到R包<code>biomaRt</code></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 安装</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">!</span><span style=\"color:#79B8FF\">require</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"BiocManager\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">quietly</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">    install.packages</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"BiocManager\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">BiocManager</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">install</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"biomaRt\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 加载</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">library</span><span style=\"color:#E1E4E8\">(biomaRt)</span></span>\n<span class=\"line\"></span></code></pre><ul>\n<li>罗列可以选择的Marts</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">listMarts</span><span style=\"color:#E1E4E8\">()</span></span></code></pre><ul>\n<li>选择要用的Marts</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">db </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> useMart</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">biomart</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"ENSEMBL_MART_ENSEMBL\"</span><span style=\"color:#E1E4E8\">) </span></span></code></pre><ul>\n<li>以小鼠为例，在<code>ENSEMBL_MART_ENSEMBL</code>的<code>description</code>中查看包含小鼠<code>\"Mouse\"</code>的行</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">listDatasets</span><span style=\"color:#E1E4E8\">(db) </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#79B8FF\"> filter</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">grepl</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"Mouse\"</span><span style=\"color:#E1E4E8\">,description))</span></span></code></pre><ul>\n<li>把注释信息提取出来</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">Mm </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> useDataset</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"mmusculus_gene_ensembl\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">mart</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> db)</span></span></code></pre><ul>\n<li>查看<code>mmusculus_gene_ensembl</code>包含的所有小鼠基因信息</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">listAttributes</span><span style=\"color:#E1E4E8\">(Mm)</span></span></code></pre><ul>\n<li>创建一个所有基因名字的列表</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 提取需要的注释信息</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">gene_annotation </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> getBM</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 这里的attributes就是listAttributes(Mm)中选的</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    attributes</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ensembl_gene_id\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">          \"external_gene_name\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#9ECBFF\">          \"description\"</span><span style=\"color:#E1E4E8\">), </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> mart</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Mm</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    )</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">gene_annotation </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> gene_annotation </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 创建一个GENE的列：</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 如果有external_gene_name就用external_gene_name</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 如果没有就保留ensembl_gene_id</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    mutate</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">GENE</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ifelse</span><span style=\"color:#E1E4E8\">(external_gene_name </span><span style=\"color:#F97583\">==</span><span style=\"color:#9ECBFF\"> \"\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">          ensembl_gene_id, </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">          external_gene_name)) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    group_by</span><span style=\"color:#E1E4E8\">(GENE) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 由于存在相同基因名称的基因，并且变成rownames的时候是不可以有重复的</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 给重复的基因名后面加个小尾巴 .1 .2 这种</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    mutate</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        count</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> n</span><span style=\"color:#E1E4E8\">(),</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        GENE</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> if_else</span><span style=\"color:#E1E4E8\">(count </span><span style=\"color:#F97583\">==</span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">, GENE, </span><span style=\"color:#79B8FF\">paste0</span><span style=\"color:#E1E4E8\">(GENE, </span><span style=\"color:#9ECBFF\">\".\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">row_number</span><span style=\"color:#E1E4E8\">()))</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    ) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    ungroup</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    select</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">-</span><span style=\"color:#E1E4E8\">count)</span></span></code></pre><ul>\n<li>添加基因名称的时候只用<code>left_join()</code>就行了</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">resultDataFrame </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#E1E4E8\"> </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> left_join</span><span style=\"color:#E1E4E8\">(genes_annotation, </span><span style=\"color:#FFAB70\">by</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"gene\"</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section><section><h3 id=\"genome-wide-annotation包\">Genome wide annotation包<a class=\"anchor\" href=\"#genome-wide-annotation包\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>这个比较简单，很容易上手</li>\n<li>这个包是一个系列，都是org.XX.eg.db这种类型的</li>\n<li>但是没有预测基因，会出现很多NA的基因名</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">gene_annotation </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#B392F0\"> ensembldb</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">select</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> org.Mm.eg.db, </span><span style=\"color:#6A737D\"># 注释基因包</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">   # 这里keys(org.Mm.eg.db,\"ENSEMBL\")提取了包里的全部基因的ENSEMBL</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            keys</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> keys</span><span style=\"color:#E1E4E8\">(org.Mm.eg.db,</span><span style=\"color:#9ECBFF\">\"ENSEMBL\"</span><span style=\"color:#E1E4E8\">), </span><span style=\"color:#6A737D\"># 需要注释的基因</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            keytype</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"ENSEMBL\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\"># 匹配ENSEMBL</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">            # 抽取匹配到基因的\"SYMBOL\",\"ALIAS\",\"GENENAME\",\"GENETYPE\"</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            columns</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"SYMBOL\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"ALIAS\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"GENENAME\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"GENETYPE\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">resultDataFrame </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#E1E4E8\"> </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> left_join</span><span style=\"color:#E1E4E8\">(genes_annotation, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">     by</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ENSEMBL\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"SYMBOL\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"ALIAS\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"GENENAME\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"GENETYPE\"</span><span style=\"color:#E1E4E8\">))</span></span></code></pre></section></section>\n<section><h2 id=\"差异性表达分析\">差异性表达分析<a class=\"anchor\" href=\"#差异性表达分析\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li><code>DESeq()</code>，可以执行Wald检验和LRT检验，作用对象为<strong>dds</strong>对象</li>\n</ul><section><h3 id=\"wald检验\">Wald检验<a class=\"anchor\" href=\"#wald检验\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>默认的选项，约等于双样本t检验</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 下面两个一样</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">test</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"Wald\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 可以加入并行运算</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">parallel</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span></code></pre></section><section><h3 id=\"似然比检验lrt检验\">似然比检验（LRT检验）<a class=\"anchor\" href=\"#似然比检验lrt检验\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>比较多样本的选项，约等于ANOVA</li>\n<li><code>reduced</code>选项表示从原有的实验设计（完整模型）<strong>剔除</strong>需要比较的项<strong>后</strong>的模型（简化模型）</li>\n<li><code>results()</code>返回的结果中，<code>log2FoldChange</code>和<code>lfcSE</code>是<strong>没有任何实际意义</strong>的内容</li>\n</ul><blockquote>\n<p>对于使用似然比检验的分析，p 值仅由完整模型公式和简化模型公式之间的偏差差异决定<br>\n单个 log2 倍变化打印在结果表中以与其他结果表输出保持一致，但与实际测试无关</p>\n</blockquote><section><h4 id=\"简单的实验设计-condition\">简单的实验设计：<code>~ Condition</code><a class=\"anchor\" href=\"#简单的实验设计-condition\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>检验<code>Condition</code>里不同水平是否存在差异</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 因为检验Condition，所以从实验设计的formula中剔除Condition</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 什么都没有的情况下填写~1</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">test</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"LRT\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">reduced</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section><section><h4 id=\"复杂点的实验设计-conditiona--conditionb\">复杂点的实验设计：<code>~ ConditionA + ConditionB</code><a class=\"anchor\" href=\"#复杂点的实验设计-conditiona--conditionb\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>检验<code>ConditionB</code>里不同水平是否存在差异</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 同理，检验ConditionB则剔除ConditionB，保留~ ConditionA</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">test</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"LRT\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">reduced</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> ConditionA)</span></span></code></pre></section><section><h4 id=\"交互作用-conditiona--conditionb--conditionaconditionb\">交互作用：<code>~ ConditionA + ConditionB + ConditionA:ConditionB</code><a class=\"anchor\" href=\"#交互作用-conditiona--conditionb--conditionaconditionb\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>检验<code>ConditionB</code>里不同水平是否存在差异</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 无论多么复杂的实验设计，检验什么就剔除什么</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 这里检验ConditionB，所以保留~ ConditionA + ConditionA:ConditionB</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> DESeq</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">test</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"LRT\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    reduced</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> ~</span><span style=\"color:#E1E4E8\"> ConditionA </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> ConditionA</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\">ConditionB)</span></span></code></pre></section></section><section><h3 id=\"查看结果\">查看结果<a class=\"anchor\" href=\"#查看结果\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"查看比较元素\">查看比较元素<a class=\"anchor\" href=\"#查看比较元素\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>主要用于<code>results()</code>中用<code>name</code>或<code>contrast</code>指定比较对象</li>\n<li>也可以用于<code>lfcShrink()</code>的<code>coef</code>和<code>contrast</code>指定对象</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">resultsNames</span><span style=\"color:#E1E4E8\">(dds)</span></span></code></pre></section><section><h4 id=\"选择比较的对象\">选择比较的对象<a class=\"anchor\" href=\"#选择比较的对象\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>对于简单的比较，<code>name</code>和<code>contrast</code>都可以</li>\n<li><code>name</code>的值不是随便起的，在用<code>resultsNames()</code>确认后使用</li>\n<li>以下3个用法是等价的</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">res </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">name</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"condition_treated_vs_untreated\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">contrast</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"condition\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"treated\"</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#9ECBFF\">\"untreated\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">contrast</span><span style=\"color:#F97583\">=list</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"condition_treated_vs_untreated\"</span><span style=\"color:#E1E4E8\">)))</span></span></code></pre><ul>\n<li>对于复杂的比较，只能用<code>contrast</code>\n<ul>\n<li><code>c(\"condition\",\"treated\",\"untreated\")</code><br>\n是选择某一条件中两者进行对比，顺序为：\n<ul>\n<li>条件</li>\n<li>比对项目</li>\n<li>被比对（参考）项目</li>\n</ul>\n</li>\n<li>仅能包含一个向量，向量包含3个元素</li>\n<li><code>list(c(\"..1..\"), c(\"..2..\"))</code><br>\n用于更加复杂的对比，<code>list()</code>中包含2个向量，<br>\n如果只声明1个，那么另一个就是截距</li>\n</ul>\n</li>\n</ul></section><section><h4 id=\"整理筛选打印结果\">整理，筛选，打印结果<a class=\"anchor\" href=\"#整理筛选打印结果\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><ul>\n<li>可以直接在<code>results</code>对象上操作</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 官方文档的方法</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">resOrdered </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> res[</span><span style=\"color:#79B8FF\">order</span><span style=\"color:#E1E4E8\">(res</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">pvalue),]</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">summary</span><span style=\"color:#E1E4E8\">(res)</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">sum</span><span style=\"color:#E1E4E8\">(res</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.1</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">na.rm</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">TRUE</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res05 </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">alpha</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">0.05</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">summary</span><span style=\"color:#E1E4E8\">(res05)</span></span></code></pre><ul>\n<li>个人喜欢转换成熟悉的<code>data.frame</code>类型更方便</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">res_df </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> res </span><span style=\"color:#F97583\">%>%</span><span style=\"color:#79B8FF\"> as.data.frame</span><span style=\"color:#E1E4E8\">()</span></span></code></pre><ul>\n<li>不建议直接使用<code>results()</code>去获取结果，<br>\n可以首先通过LFC收缩<code>lfcShrink()</code>调整LFC后再获取结果\n<ul>\n<li>这个时候不用<code>results()</code>了，直接将LFC收缩完的对象变换成<code>data.frame</code>即可</li>\n</ul>\n</li>\n</ul></section><section><h4 id=\"p值调整\">p值调整<a class=\"anchor\" href=\"#p值调整\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><section><h5 id=\"传统调整方法\">传统调整方法<a class=\"anchor\" href=\"#传统调整方法\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h5><ul>\n<li>在<code>results()</code>中可以设置p值调整的方法，默认为<code>\"BH\"</code></li>\n<li>使用<code>?p.adjust</code>可以获取所有的调整方法：\n<ul>\n<li><code>\"holm\"</code></li>\n<li><code>\"hochberg\"</code></li>\n<li><code>\"hommel\"</code></li>\n<li><code>\"bonferroni\"</code></li>\n<li><code>\"BH\"</code></li>\n<li><code>\"BY\"</code></li>\n<li><code>\"fdr\"</code></li>\n<li><code>\"none\"</code></li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># BH</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">results</span><span style=\"color:#E1E4E8\">(dds)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">pAdjustMethod</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"BH\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># Bonferroni</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">pAdjustMethod</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"bonferroni\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 其他类似</span></span></code></pre></section><section><h5 id=\"独立假设加权\">独立假设加权<a class=\"anchor\" href=\"#独立假设加权\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h5><ul>\n<li>一种给每个检验的结果分配权重增加统计效果的方法</li>\n<li>增加更多的原假设拒绝以更好筛选那些显出差异明显的基因</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 使用R包IHW</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">library</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"IHW\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 设置filterFun为ihw</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">resIHW </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> results</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">filterFun</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">ihw)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">#</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">summary</span><span style=\"color:#E1E4E8\">(resIHW)</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">sum</span><span style=\"color:#E1E4E8\">(resIHW</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.1</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">na.rm</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">TRUE</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">metadata</span><span style=\"color:#E1E4E8\">(resIHW)</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">ihwResult</span></span></code></pre></section></section></section></section>\n<section><h2 id=\"lfc收缩\">LFC收缩<a class=\"anchor\" href=\"#lfc收缩\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><ul>\n<li>目的是为了解决低计数基因或者高离散度的数据在计算LFC时引起的误差</li>\n<li>官方文档对于3种LFC估计器的介绍</li>\n</ul>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th>方法:</th><th align=\"center\"><code>apeglm</code></th><th align=\"center\"><code>ashr</code></th><th align=\"center\"><code>normal</code></th></tr></thead><tbody><tr><td>适合LFC排名</td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\">✓</td></tr><tr><td>保存大LFC的尺寸</td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\"></td></tr><tr><td>可以计算s值</td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\"></td></tr><tr><td>允许使用<code>coef</code></td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\">✓</td></tr><tr><td>允许使用<code>lfcThreshold</code></td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\">✓</td></tr><tr><td>允许使用<code>contrast</code></td><td align=\"center\"></td><td align=\"center\">✓</td><td align=\"center\">✓</td></tr><tr><td>可以收缩交互术语</td><td align=\"center\">✓</td><td align=\"center\">✓</td><td align=\"center\"></td></tr></tbody></table><ul>\n<li>基本用法</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">coef</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Comparison, </span><span style=\"color:#FFAB70\">type</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> LFCShrinkAlgorithm)</span></span></code></pre><ul>\n<li>对于简单的实验设计，<code>apeglm</code>是最推荐的方法\n<ul>\n<li><code>coef</code>等同于<code>results()</code>中的<code>name</code></li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">coef</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"Condition_B_vs_A\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">type</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> LFCShrinkAlgorithm)</span></span></code></pre><ul>\n<li>对于复杂的实验设计，由于需要指定<code>contrast</code>，所以只有<code>ashr</code>才行</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> dds, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> contrast</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> list</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"..1..\"</span><span style=\"color:#E1E4E8\">),</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"..2..\"</span><span style=\"color:#E1E4E8\">)), </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> type</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> LFCShrinkAlgorithm</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> )</span></span></code></pre><ul>\n<li>打印的结果的s值：检验收缩后的LFC是否与制定的阈值<code>lfcThreshold</code>相等\n<ul>\n<li><code>lfcThreshold</code>默认为0</li>\n<li>可以通过设置不同的<code>lfcThreshold</code>来检查s值的变化</li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">lfcShrink</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> dds, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> coef</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Comparison, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> type</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> LFCShrinkAlgorithm, </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> lfcThreshold</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 1</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> )</span></span></code></pre><ul>\n<li>目前不支持IHW与LFC收缩的混用</li>\n</ul></section>\n<section><h2 id=\"数据可视化\">数据可视化<a class=\"anchor\" href=\"#数据可视化\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"数据转换\">数据转换<a class=\"anchor\" href=\"#数据转换\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>数据转换<strong>不用于</strong>差异性表达分析，而是用于各种可视化\n<ul>\n<li>之后需要用到数据转换的数据用<code>rld</code>表示</li>\n</ul>\n</li>\n</ul><section><h4 id=\"对数化\">对数化<a class=\"anchor\" href=\"#对数化\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">ntd </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> normTransform</span><span style=\"color:#E1E4E8\">(dds)</span></span></code></pre></section><section><h4 id=\"vsd适合30的大数据\">vsd，适合>=30的大数据<a class=\"anchor\" href=\"#vsd适合30的大数据\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">vsd </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> vst</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">blind</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> FALSE</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section><section><h4 id=\"rlog适合30样本的小数据\">rlog，适合&#x3C;30样本的小数据<a class=\"anchor\" href=\"#rlog适合30样本的小数据\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">rld </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> rlog</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">blind</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> FALSE</span><span style=\"color:#E1E4E8\">)</span></span></code></pre></section></section><section><h3 id=\"检查每个样本的计数\">检查每个样本的计数<a class=\"anchor\" href=\"#检查每个样本的计数\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"分开检查每个样本的计数分布\">分开检查每个样本的计数分布<a class=\"anchor\" href=\"#分开检查每个样本的计数分布\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">dt[,</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\">ncol</span><span style=\"color:#E1E4E8\">(dt)] </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    map2</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">.x</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">., </span><span style=\"color:#FFAB70\">.y</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">names</span><span style=\"color:#E1E4E8\">(.),</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">        ~</span><span style=\"color:#E1E4E8\">dt_GE </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        ggplot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">aes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">.x)) </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\">  </span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        geom_histogram</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">stat</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">'bin'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">bins</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">20</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        geom_freqpoly</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">binwidth</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 1000</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        labs</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">'Raw expression count'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            y</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">'Number of genes'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            title</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">.y) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        theme_bw</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    )</span></span></code></pre></section><section><h4 id=\"检查所有样本计数总数\">检查所有样本计数总数<a class=\"anchor\" href=\"#检查所有样本计数总数\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">colSum_df </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> colSums</span><span style=\"color:#E1E4E8\">(dt) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\"> as.data.frame</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> rownames_to_column</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">colnames</span><span style=\"color:#E1E4E8\">(colSum_df) </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'Sample'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'Counts'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">colSum_df </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  ggplot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">aes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Sample, </span><span style=\"color:#FFAB70\">y</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Counts </span><span style=\"color:#F97583\">/</span><span style=\"color:#79B8FF\"> 1e6</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">fill</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Sample)) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         geom_bar</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">stat</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"identity\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span><span style=\"color:#FFAB70\"> theme_bw</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         labs</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">x</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"Sample\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">y</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"Total count in millions\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">         theme</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">axis.text.x</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> element_text</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">angle</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 45</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">hjust</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">vjust</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">))</span></span></code></pre></section></section><section><h3 id=\"样本关联性热图\">样本关联性热图<a class=\"anchor\" href=\"#样本关联性热图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">rld_mat </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> assay</span><span style=\"color:#E1E4E8\">(rld)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">rld_cor </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> cor</span><span style=\"color:#E1E4E8\">(rld_mat)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">pheatmap</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> rld_cor_GE,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> annotation</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> dplyr</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">select</span><span style=\"color:#E1E4E8\">(meta_dt, </span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'ConditionA'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'ConditionB'</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> )</span></span></code></pre></section><section><h3 id=\"pca-plot\">PCA plot<a class=\"anchor\" href=\"#pca-plot\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">rld_PCA </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> plotPCA</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> rld,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> intgroup</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ConditionA\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"ConditionB\"</span><span style=\"color:#E1E4E8\">),</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> returnData</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> TRUE</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> )</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">rld_PCA_pv </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> round</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">100</span><span style=\"color:#F97583\"> *</span><span style=\"color:#79B8FF\"> attr</span><span style=\"color:#E1E4E8\">(rld_PCA, </span><span style=\"color:#9ECBFF\">\"percentVar\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">rld_PCA </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\"> ggplot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">aes</span><span style=\"color:#E1E4E8\">(PC1,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">      PC2,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      color</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">ConditionA,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      shape</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">ConditionB,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      linetype</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">Time)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">     ) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    geom_point</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">size</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 3</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    xlab</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">paste0</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"PC1: \"</span><span style=\"color:#E1E4E8\">,rld_GE_PCA_pv[</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">],</span><span style=\"color:#9ECBFF\">\"% variance\"</span><span style=\"color:#E1E4E8\">)) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    ylab</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">paste0</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"PC2: \"</span><span style=\"color:#E1E4E8\">,rld_GE_PCA_pv[</span><span style=\"color:#79B8FF\">2</span><span style=\"color:#E1E4E8\">],</span><span style=\"color:#9ECBFF\">\"% variance\"</span><span style=\"color:#E1E4E8\">)) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    stat_ellipse</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    theme_bw</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"></span></code></pre></section><section><h3 id=\"变换-方差图\">变换-方差图<a class=\"anchor\" href=\"#变换-方差图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">{</span><span style=\"color:#B392F0\">vsn</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">meanSdPlot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">assay</span><span style=\"color:#E1E4E8\">(rld), </span><span style=\"color:#FFAB70\">ranks</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> FALSE</span><span style=\"color:#E1E4E8\">)}</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">gg </span><span style=\"color:#F97583\">+</span><span style=\"color:#FFAB70\"> theme_bw</span><span style=\"color:#E1E4E8\">()</span></span></code></pre></section><section><h3 id=\"分散估计图\">分散估计图<a class=\"anchor\" href=\"#分散估计图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>检查模型拟合的情况，对象为<code>DESeq()</code>处理过的<code>dds</code></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">plotDispEsts</span><span style=\"color:#E1E4E8\">(dds)</span></span></code></pre></section><section><h3 id=\"ma图\">MA图<a class=\"anchor\" href=\"#ma图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li><code>res_lfcShrink</code>是<code>lfcShrink(dds, ...)</code>之后的结果</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">plotMA</span><span style=\"color:#E1E4E8\">(res_lfcShrink, </span><span style=\"color:#FFAB70\">ylim</span><span style=\"color:#F97583\">=</span><span style=\"color:#79B8FF\">c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">-</span><span style=\"color:#79B8FF\">2</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#79B8FF\">2</span><span style=\"color:#E1E4E8\">))</span></span></code></pre></section><section><h3 id=\"火山图\">火山图<a class=\"anchor\" href=\"#火山图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li><code>res_lfcShrink</code>是<code>lfcShrink(dds, ...)</code>之后的结果</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">res_lfcShrink_volc </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#E1E4E8\"> res_lfcShrink </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">            as.data.frame</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            rownames_to_column</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">var</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"gene\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            left_join</span><span style=\"color:#E1E4E8\">(all_genes, </span><span style=\"color:#FFAB70\">by</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"gene\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">            mutate</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">diffexpressed</span><span style=\"color:#F97583\"> =</span><span style=\"color:#FFAB70\"> case_when</span><span style=\"color:#E1E4E8\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">              {padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.05</span><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">&#x26;</span><span style=\"color:#E1E4E8\"> {log2FoldChange </span><span style=\"color:#F97583\">></span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">~</span><span style=\"color:#9ECBFF\"> \"UP\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">              {padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.05</span><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">&#x26;</span><span style=\"color:#E1E4E8\"> {log2FoldChange </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#F97583\"> -</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">~</span><span style=\"color:#9ECBFF\"> \"DOWN\"</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">              TRUE </span><span style=\"color:#F97583\">~</span><span style=\"color:#9ECBFF\"> \"NO\"</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">              ))</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res_lfcShrink_volc</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">diffexpressed </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> factor</span><span style=\"color:#E1E4E8\">(res_8h_vs_4h_volc</span><span style=\"color:#F97583\">$</span><span style=\"color:#E1E4E8\">diffexpressed,</span><span style=\"color:#FFAB70\">levels</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"DOWN\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"NO\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"UP\"</span><span style=\"color:#E1E4E8\">))</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">res_lfcShrink_volc </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">ggplot</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">aes</span><span style=\"color:#E1E4E8\">(log2FoldChange, </span><span style=\"color:#F97583\">-</span><span style=\"color:#79B8FF\">log10</span><span style=\"color:#E1E4E8\">(padj), </span><span style=\"color:#FFAB70\">color</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> diffexpressed))</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  geom_hline</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">yintercept</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> -</span><span style=\"color:#79B8FF\">log10</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.05</span><span style=\"color:#E1E4E8\">), </span><span style=\"color:#FFAB70\">linetype</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"dashed\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">color</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"black\"</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  geom_vline</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">xintercept</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">-</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">), </span><span style=\"color:#FFAB70\">linetype</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"dashed\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">color</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"black\"</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  geom_point</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">size</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 0.8</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  scale_color_manual</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">values</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"#989ad6\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"#e4e4e4\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"#e27e9a\"</span><span style=\"color:#E1E4E8\">),</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                     labels</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"DOWN\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"NO\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"UP\"</span><span style=\"color:#E1E4E8\">))  </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  theme_bw</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">base_size</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 12</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  theme</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">legend.position</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> 'right'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">        legend.justification</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> c</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0</span><span style=\"color:#E1E4E8\">,</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">))</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 添加标签</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  geom_text_repel</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">data</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> filter</span><span style=\"color:#E1E4E8\">(res_lfcShrink_volc, padj </span><span style=\"color:#F97583\">&#x3C;</span><span style=\"color:#79B8FF\"> 0.05</span><span style=\"color:#F97583\"> &#x26;</span><span style=\"color:#79B8FF\"> abs</span><span style=\"color:#E1E4E8\">(log2FoldChange) </span><span style=\"color:#F97583\">></span><span style=\"color:#79B8FF\"> 1</span><span style=\"color:#E1E4E8\">),</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                  max.overlaps</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> getOption</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ggrepel.max.overlaps\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">default</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 20</span><span style=\"color:#E1E4E8\">),</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">                  # 这里的filter很关键，筛选你想要标记的基因</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                  aes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">label</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> GENE), </span><span style=\"color:#6A737D\"># 这里的GENE就是注释部分生成的基因名称</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                  size</span><span style=\"color:#F97583\"> =</span><span style=\"color:#79B8FF\"> 3</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">                  color</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> 'black'</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  xlab</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"Log2FC\"</span><span style=\"color:#E1E4E8\">)</span><span style=\"color:#F97583\">+</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  ylab</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"-Log10(FDR q-value)\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span></code></pre></section><section><h3 id=\"基因表达热图\">基因表达热图<a class=\"anchor\" href=\"#基因表达热图\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>使用R包<code>ComplexHeatmap</code></li>\n<li>这个包的功能很强大，本文仅限于简单出图</li>\n<li>具体说明见<a href=\"https://pengpengyang94.github.io/2020/05/complexheatmap%E4%B8%AD%E6%96%87%E7%89%88%E8%AF%B4%E6%98%8E/\">ComplexHeatmap中文版说明</a></li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#6A737D\"># 两种安装方式</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">install.packages</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"ComplexHeatmap\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">devtools</span><span style=\"color:#F97583\">::</span><span style=\"color:#FFAB70\">install_github</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"jokergoo/ComplexHeatmap\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\"># 加载</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">library</span><span style=\"color:#E1E4E8\">(ComplexHeatmap)</span></span></code></pre><ul>\n<li>首先提取归一化处理，并将行名换成基因名</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">counts_dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#FFAB70\"> counts</span><span style=\"color:#E1E4E8\">(dds, </span><span style=\"color:#FFAB70\">normalized</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> T) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">    as.data.frame</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    rownames_to_column</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"gene\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    left_join</span><span style=\"color:#E1E4E8\">(gene_annotation, </span><span style=\"color:#FFAB70\">by</span><span style=\"color:#F97583\"> =</span><span style=\"color:#9ECBFF\"> \"gene\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    select</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#F97583\">-</span><span style=\"color:#E1E4E8\">gene) </span><span style=\"color:#F97583\">%>%</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    column_to_rownames</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"name\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">counts_dds </span><span style=\"color:#F97583\">&#x3C;-</span><span style=\"color:#79B8FF\"> t</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">scale</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">t</span><span style=\"color:#E1E4E8\">(counts_dds))) </span><span style=\"color:#6A737D\"># 需要对每行进行归一化，所以得转置2次</span></span></code></pre><ul>\n<li>绘制热图\n<ul>\n<li><code>SigGenes</code>为筛选出来的基因名</li>\n</ul>\n</li>\n</ul><pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"r\"><code><span class=\"line\"><span style=\"color:#FFAB70\">Heatmap</span><span style=\"color:#E1E4E8\">(counts_dds[SigGenes,])</span></span></code></pre></section></section>",{headings:279,localImagePaths:415,remoteImagePaths:416,frontmatter:417,imagePaths:423},[280,283,286,289,292,295,298,301,304,307,310,313,316,319,322,325,328,331,334,337,340,343,346,349,352,355,358,361,364,367,370,373,376,379,382,385,388,391,394,397,400,403,406,409,412],{depth:27,slug:281,text:282},"教程","教程#",{depth:61,slug:284,text:285},"官方教程","官方教程#",{depth:45,slug:287,text:288},"analyzing-rna-seq-data-with-deseq2","Analyzing RNA-seq data with DESeq2#",{depth:45,slug:290,text:291},"rna-seq-workflow-gene-level-exploratory-analysis-and-differential-expression","RNA-seq workflow: gene-level exploratory analysis and differential expression#",{depth:61,slug:293,text:294},"其他参考","其他参考#",{depth:45,slug:296,text:297},"108-如何利用deseq2分析转录组数据","108-如何利用DESeq2分析转录组数据？#",{depth:45,slug:299,text:300},"rna-seq分析微信公众号文章","RNA-seq分析（微信公众号文章）#",{depth:45,slug:302,text:303},"jwindlerice_storygithub仓库","Jwindler/Ice_story（Github仓库）#",{depth:45,slug:305,text:306},"使用deseq2分析rna-seq数据","使用DESeq2分析RNA-seq数据#",{depth:27,slug:308,text:309},"并行运算","并行运算#",{depth:27,slug:311,text:312},"数据导入","数据导入#",{depth:27,slug:314,text:315},"基因预过滤","基因预过滤#",{depth:27,slug:317,text:318},"比较级别","比较级别#",{depth:27,slug:320,text:321},"基因注释","基因注释#",{depth:61,slug:323,text:324},"biomart","biomaRt#",{depth:61,slug:326,text:327},"genome-wide-annotation包","Genome wide annotation包#",{depth:27,slug:329,text:330},"差异性表达分析","差异性表达分析#",{depth:61,slug:332,text:333},"wald检验","Wald检验#",{depth:61,slug:335,text:336},"似然比检验lrt检验","似然比检验（LRT检验）#",{depth:45,slug:338,text:339},"简单的实验设计-condition","简单的实验设计：~ Condition#",{depth:45,slug:341,text:342},"复杂点的实验设计-conditiona--conditionb","复杂点的实验设计：~ ConditionA + ConditionB#",{depth:45,slug:344,text:345},"交互作用-conditiona--conditionb--conditionaconditionb","交互作用：~ ConditionA + ConditionB + ConditionA:ConditionB#",{depth:61,slug:347,text:348},"查看结果","查看结果#",{depth:45,slug:350,text:351},"查看比较元素","查看比较元素#",{depth:45,slug:353,text:354},"选择比较的对象","选择比较的对象#",{depth:45,slug:356,text:357},"整理筛选打印结果","整理，筛选，打印结果#",{depth:45,slug:359,text:360},"p值调整","p值调整#",{depth:259,slug:362,text:363},"传统调整方法","传统调整方法#",{depth:259,slug:365,text:366},"独立假设加权","独立假设加权#",{depth:27,slug:368,text:369},"lfc收缩","LFC收缩#",{depth:27,slug:371,text:372},"数据可视化","数据可视化#",{depth:61,slug:374,text:375},"数据转换","数据转换#",{depth:45,slug:377,text:378},"对数化","对数化#",{depth:45,slug:380,text:381},"vsd适合30的大数据","vsd，适合>=30的大数据#",{depth:45,slug:383,text:384},"rlog适合30样本的小数据","rlog，适合<30样本的小数据#",{depth:61,slug:386,text:387},"检查每个样本的计数","检查每个样本的计数#",{depth:45,slug:389,text:390},"分开检查每个样本的计数分布","分开检查每个样本的计数分布#",{depth:45,slug:392,text:393},"检查所有样本计数总数","检查所有样本计数总数#",{depth:61,slug:395,text:396},"样本关联性热图","样本关联性热图#",{depth:61,slug:398,text:399},"pca-plot","PCA plot#",{depth:61,slug:401,text:402},"变换-方差图","变换-方差图#",{depth:61,slug:404,text:405},"分散估计图","分散估计图#",{depth:61,slug:407,text:408},"ma图","MA图#",{depth:61,slug:410,text:411},"火山图","火山图#",{depth:61,slug:413,text:414},"基因表达热图","基因表达热图#",[],[],{title:267,published:418,image:270,description:269,category:201,tags:419,draft:108,lang:113,minutes:420,words:421,excerpt:422},["Date","2025-04-28T00:00:00.000Z"],[142,198,199,200,272],13,2674,"本节参考：【R】 遺伝子ID/遺伝子名の変換方法",[],"p4/p4.md","p5/p5",{id:425,data:427,body:434,filePath:435,digest:436,rendered:437,legacyId:448},{title:428,published:429,draft:108,description:430,image:431,tags:432,category:201,lang:113,prevTitle:114,prevSlug:114,nextTitle:114,nextSlug:114},"通路分析",["Date","2025-05-01T00:00:00.000Z"],"GO,KEGG,GSEA,GSVA的通路分析与作图","./p5_cover.png",[142,199,200,433,272],"Pathway","> - Cover Pic by [@超凶の狄璐卡](https://www.pixiv.net/artworks/129415764)\n\n<center><h1>-站位站位-</h1></center>","src/content/posts/p5/p5.md","c492562a9505f9a3",{html:438,metadata:439},"<blockquote>\n<ul>\n<li>Cover Pic by <a href=\"https://www.pixiv.net/artworks/129415764\">@超凶の狄璐卡</a></li>\n</ul>\n</blockquote>\n<center><h1>-站位站位-</h1></center>",{headings:440,localImagePaths:441,remoteImagePaths:442,frontmatter:443,imagePaths:447},[],[],[],{title:428,published:444,image:431,description:430,category:201,tags:445,draft:108,lang:113,minutes:14,words:446,excerpt:114},["Date","2025-05-01T00:00:00.000Z"],[142,199,200,433,272],16,[],"p5/p5.md"];

export { _astro_dataLayerContent as default };
