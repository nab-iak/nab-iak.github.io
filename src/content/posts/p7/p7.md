---
title: '双样本孟德尔随机化'
published: 2025-05-12
image: './p7_cover.jpg'
description: '使用TwoSampleMR包进行双样本孟德尔随机化分析'
category: 'Bioinformatics'
tags: [Mendelian randomization,R,ZH-CN]
draft: false 
lang: 'en'
---
> - Cover Pic by [@笠木梨Ceey](https://www.pixiv.net/artworks/129969798)

## 参考

> [Mendelian randomization with GWAS summary data](https://mrcieu.github.io/TwoSampleMR/index.html)  
> [【bilibili】2022.05孟德尔随机化操作](https://www.bilibili.com/video/BV1LV4y1b7v5/?spm_id_from=333.337.search-card.all.click&vd_source=81a4751dfe3d7ad0a41ae3e1e47211cf)  
> [【bilibili】孟德尔随机化傻瓜教程之概念介绍](https://www.bilibili.com/video/BV1bUHVePE3K/?spm_id_from=333.337.search-card.all.click&vd_source=81a4751dfe3d7ad0a41ae3e1e47211cf)  
> [【bilibili】孟德尔随机化 - 从入门到实践 | 自学 | 小白 | 代码 | 原理](https://www.bilibili.com/video/BV1Xm411k7ug/?spm_id_from=333.337.search-card.all.click&vd_source=81a4751dfe3d7ad0a41ae3e1e47211cf)  
> [知乎专栏-孟德尔随机化研究](https://zhuanlan.zhihu.com/c_1230814311636668416)  
> [孟德尔随机化系列之一：基础概念 Mendelian randomization I](https://gwaslab.org/2021/06/24/mr/)  
> [孟德尔随机化系列之二：两样本MR – TwoSampleMR](https://gwaslab.org/2021/11/14/twosamplemr/)  

## 孟德尔随机化的原理基础

- 排除内生性因素的干扰，确定暴露（等位基因有无）与结局是否存在因果关系
![image_1](./image_1.png)

> [【bilibili】孟德尔随机化傻瓜教程之概念介绍](https://www.bilibili.com/video/BV1bUHVePE3K/?spm_id_from=333.337.search-card.all.click&vd_source=81a4751dfe3d7ad0a41ae3e1e47211cf)
![image_2](./image_2.png)

- **暴露因素**  
  影响结局的任何因素或特征,可以是内部因素的的也可以是外部因素的,内部因素比如外貌、体型等生物学特征,外部因素比如饮酒、吸烟等生生活方式或一些环境因素等
- **结局变量**  
  结局是与研究的问题相关的一个定量或定性的拍旨标,如肾小球滤过率水平、糖尿病等
- **混杂因素**  
  同时影响着暴露与结局的其他因素。
- **反向因果**  
  当暴露与结果之间的关联不是由于暴露导致结果果变化,而是由于结果导致暴露变化时,则发生反向因果关系。

### GWAS

![[Picture1.png]]

### 工具变量

- 调节 **工具变量（instrumental variables, IV）** 的影响
  - 定义
    - 与X相关
    - 与被忽略的混淆因素无关
    - 与Y无关
  - 变异基因Z
    - 与暴露因素X相关
    - 与Y没有直接因果关系
    - 变异基因Z与结果Y相关，只能通过X对Y的因果关系被观察到

### 工具变量的假设

#### 假设

1. 相关性假设：工具变量与暴露密切相关
2. 独立性假设：工具变量与任何影响暴露-结局关联的混杂因素均不相关
3. 排他性假设：除非借助与暴露的关联，否则工具变量不会影响结局
4. MR：工具变量（基因位点）之间是相互独立的

#### 违反假设的机制

- 生物学机制
  - 多效性（pleiotropy）
  - 渠化（canalization）
- 非孟德尔式遗传
  - 连锁不平衡（linkage disequilibrium, LD）
    - 指分属两个或两个以上基因座位的等位基因同时出现在一条染色体上的几率，  
    高于随机出现的频率
    - 只要两个基因不是完全独立地遗传，就会表现出某种程度的连锁
  - 效应修正（effect modification）
- 群体效应（population effects）
  - 人群分层（population stratification）
  - 确定性效应（ascertainment effect）

#### 工具变量的挑选

- 首先确定和暴露有相关性的工具变量
- 再确定挑选的工具变量与结局是不相关的，相关的工具变量需要剔除（假设3）

### 二阶最小二乘法（two-stage least squares，2SLS）

- 第一阶段回归：遗传IV对暴露的回归
  - 计算暴露在IV上的拟合值
- 第二阶段回归：第一阶段暴露的拟合值对结局的回归
  - 因果估计的效应量就是是该第二阶段的回归系数，  
   用于反映由于暴露量单位变化而导致的结局变化
  - 对于单个IV：  
    2SLS估计与比率估计（Wald ratio estimation）相同
  - 对于多个IV：  
    2SLS估计量可以看作是单个工具变量计算出的比率估计值的加权平均值，  
    其中权重由第一阶段回归中工具变量的相对强度确定
- 假设
  - $k$个工具变量，下标 $i = 1,2,...$
  - 总人数$N$，下标 $k = 1,2,...$
  - 每个个体暴露值 $X_i$ ，结局 $Y_i$
  - 假定每个工具变量遵循加性模型，$g_{ik}$ 为第 $i$ 个个体在第 $k$ 个工具变量上的基因型
- 第一阶段回归
  - 构建工具变量对X的线性回归模型

$$
x_{i}= \alpha_{0}+ \sum\limits_k\alpha_kg_{ik} + \epsilon_{X_{i}}
$$

- 因此拟合值 $\hat{x}_i$ 有
  - 其实无非就是用工具变量对变量X进行调整而已

$$
\hat{x}_{i}= \hat{\alpha}_{0}+ \sum\limits_k\hat{\alpha}_kg_{ik}
$$

- 第二阶段回归

$$
y_{i}= \beta_{0}+ \beta_1\hat{x}_{i}+ \epsilon
_{Y_i}
$$

- 在等式中的误差项的方差齐性下

$$
y_{i}= \beta_{0}+ \beta_1x_{i}+ \epsilon^{'}_{Y_i}
$$

- 2SLS估计量的渐近方程

$$
\hat{\sigma}^2(X^TG(G^TG)^{-1}G^TX)^{-1}=\hat{\sigma}^2(\hat{X}^T\hat{x})
^{-1}$$

### 孟德尔随机化种类
- 双样本孟德尔随机化
- 双向孟德尔随机化
- 多变量孟德尔随机化
- 中介孟德尔随机化

## 数据
### GWAS数据库
1. PGC ([https://www.med.unc.edu/pgc/](https://www.med.unc.edu/pgc/))：精神病学的基因组学
2. SSGAC ([https://www.thessgac.org/](https://www.thessgac.org/))：社会科学的基因组学
3. CTG ([https://ctg.cncr.nl/software/summary_statistics](https://ctg.cncr.nl/software/summary_statistics))
4. **IEU** ([https://gwas.mrcieu.ac.uk/](https://gwas.mrcieu.ac.uk/))
5. GWAS Catalog (https://www.ebi.ac.uk/gwas/)

### IEU OpenGWAS project API
- 使用前需要在[IEU OpenGWAS project](https://api.opengwas.io/profile/)注册API `<token>`
- 将获取到的API写在`.RENVIRON`文件中，位置一般在`home`(~)下，没有就vim创建
- 添加`OPENGWAS_JWT=<token>`
- 初始的Trial等级：100 per 10 minutes，  
  填写完个人信息后可以变成Standard等级：100000 per 10 minutes

### 注意点
- 大部分GWAS数据来源于欧洲样本
- 暴露和结局的样本群体至少为**同一人种**
- 双样本MR的暴露于结局数据不存在或存在少量可接受范围内的样本重叠（**样本独立性**）

### 数据构成
- 不同的数据的标签是不一样的
 - SNP id (rs...)：单核苷酸多态性id
 - Effect allele; Alternative allele：效应位点
 - Other allele; Reference allele：非效应位点
 - Effect，Beta，b，OR（对于二分类变量，$\beta = \text{ln}(OR)$）：  
   回归系数，表示效应位点对结局的正负影响
 - Se：标准误差
 - EAF：效应等位基因频率
 - P：关联性的p值

### 工具变量的获取
- GWAS原文
- 已经发表的MR文章中获取
- R program提取

## 分析流程
 1. 获取暴露与结局的GWAS数据
 2. 选择工具变量
 3. 去除连锁不平衡
 4. MR分析
 5. 敏感性分析：评价分析结果的稳健性
 - 异质性检验
  - 检验暴露和结局的样本是否存在异质性
  - 当存在异质性时，应该剔除导致偏移的SNP
  - 但是对于IVW的MR主要检验方法而言是可以接受的
 - 多效性检验
  - 检验SNP是否对多种遗传性状产生影响
 6. 结果可视化

## TwoSampleMR包
```r
# 安装
install.packages('devtools')
library('devtools')
install_github("MRCIEU/TwoSampleMR")

# 导入
library(TwoSampleMR)
```

## 暴露数据处理
### 读取数据
- 默认的读取方法
```r
# txt
gwas_x <- read.table(file = 'X_GWAStbl.txt', header = TRUE)
# csv
gwas_x <- read.csv(file = 'X_GWAStbl.csv', header = TRUE)
# tsv
read.table(file = 'X_GWAStbl.csv', sep = '\t', header = TRUE)
```

- 用`readr`包的读取方法（更快）
```r
# txt
gwas_x <- read_table(file = 'X_GWAStbl.txt', col_names = TRUE)
# csv
gwas_x <- read_csv(file = 'X_GWAStbl.csv', col_names = TRUE)
# tsv
gwas_x <- read_tsv(file = 'X_GWAStbl.tsv', col_names = TRUE)
```

### 数据预处理
#### 相关性设置
- $\text{p <}\ 5 \times 10^{-8}$ ，一般而言，最高不超过 $\text{p <}\ 5 \times 10^{-5}$

```r
gwas_x_filted <- gwas_x %>% filter(p < 5e-08)
```

- 如果数据不是Beta和SE，而是OR和95%CI，那么需要数据转换一下
```r
gwas_x_filted <- gwas_x_filted %>%
 mutate(
     beta = log(odds_ratio),
     se = (ci_upper - ci_lower)/(qnorm(0.95)*2)
    )
```

- 过滤完的文件需要`write.csv()`并放到`TwoSampleMR`包文件夹的子路径中
 - 经过尝试**不需要**放到`TwoSampleMR`包的子路径中

```r
gwas_x_filted %>% write_csv(
 paste(
  .libPaths(),
  "TwoSampleMR/Project_A/gwas_x_filted.csv",
  sep=""
  )
 )
```
#### 读取过滤的数据
```r
# 将每列列名信息输入
x <- read_exposure_data(
 # 这里就是保存到包里面的原因，它只能读取路径
 filename = paste(
  .libPaths(),
  "TwoSampleMR/Project_A/gwas_x_filted.csv",
  sep=""
 ),
 sep = ',',
 snp_col = 'SNP',
 beta_col = 'beta',
 se_col = 'se',
 effect_allele_col = 'allele1',
 other_allele_col = 'allele2',
 pval_col = 'p',
 eaf_col = 'EAF'
)
```

- 用`class()`可以确认`x`的类，结果判断包含`data.frame`，因此很多操作可以用`dplyr`包的指令完成
```r
class(x)
```

```css
'spec_tbl_df''tbl_df''tbl''data.frame'
```
#### 独立性设置
- Clumping
 - $\text{LD} \ r^{2}< 0.001$, distance $1 \text{MB}$
  - LD：连锁不平衡
  - <mark style="background: #ADCCFFA6;">distance：</mark>

- 在线去除连锁不平衡（可能服务器拥堵导致502）
```r
x_clumped <- clump_data(
 x,
 clump_kb = 10000,
 clump_r2 = 0.001,
 clump_p1 = 1,
 clump_p2 = 1,
 pop = 'EUR' # 样本人种，'EUR'为欧洲
)
```

- 本地去除连锁不平衡
> [Running local LD operations](https://mrcieu.github.io/ieugwasr/articles/local_ld.html)
-  需要下载LD数据库： http://fileserve.mrcieu.ac.uk/ld/1kg.v3.tgz
```r
x_clumped <- ieugwars::ld_clump(
 dplyr::tibble(
  rsid = x$SNP,
  pval = x$pval.exposure
 ),
 clump_kb = 10000,
 clump_r2 = 0.001,
 clump_p = 1,
 pop = 'EUR',
 bfile = '1kg.v3/EUR', # kg.v3解压后的文件，注意路径是绝对还是相对
 plink_bin = plinkbinr::get_plink_exe()
)
```

#### 统计强度设置
- $\text{R}^2$计算公式及 $F$ 值（筛选>10）计算公式
 - 一般而言 $p$ 够小的话 $F$ 都会大于10

```
exposure_ieu_clump = exposure_ieu_dat[exposure_ieu_datSSNP %in% exposure_ieu_clumpSrsid,]
R2a = 2*(exposure_ieu_clumpSbeta.exposure^2)exposure_ieu_clump$eaf.exposure(1-exposure_ieu_clump
eaf.exposure)R2b=2∗(exposure_ieu_clump
se.exposure^2)exposure_ieu_clump$samplesize.exposureexposure_ieu_clump
Seaf.exposure*(1-exposure_ieu_clumpSeaf.exposure)
R2 = R2a/(R2a+R2b)
exposure_ieu_clumpSFz = R2*(exposure_ieu_clumpssamplesize.exposure-2)/(1-R2)
mean_F_ieu = mean(exposure_ieu_clump$Fz)
```
## 结局数据处理
### 读取数据
- 同暴露数据读取
```r
gwas_y <- read_table(file = 'Y_GWAStbl.txt', col_names = TRUE)
```

### 整合暴露数据与结局数据
#### 合并
- `merge()`
```r
xy_bind <- merge(x_clumped, gwas_y, by.x = 'SNP', by.y = 'differentSNPname')
```
- `inner_join()`
```r
xy_bind <- inner_join(
 x_clumped,
 gwas_y,
 by = c('SNP' = 'differentSNPname') # 如果有重复列名的话，用以区分来自哪个数据
)
```

#### 筛选列
- 只保留暴露的列即可
```r
gwas_y_filted <- xy_bind %>%
 select(
  SNP,
  allele1_outcome,
  allele2_outcome,
  beta_outcome,
  se_outcome,
  p_outcome
 )
```
- 如果有位点与结局也强相关，应该删除
```r
# 提取强相关位点
exclude_list <- {xy_bind %>% filter(p_outcome < 5e-08)}$SNP

# 筛选
gwas_y_filted <- xy_bind %>% filter(p_outcome >= 5e-08)
x_clumped_filted <- x_clumped %>% filter(!SNP %in% exclude_list)
```

- 同理需要保存到`TwoSampleME`包里面

```r
gwas_y_filted %>% write_csv(
 paste(
  .libPaths(),
  "TwoSampleMR/Project_A/gwas_y_filted.csv",
  sep=""
  )
 )
```

```r
# 将每列列名信息输入
y <- read_outcome_data(
 snps = x_clumped$SNP, # 用`x_clumped_filted$SNP`也行，毕竟这两个一样
 filename = paste(
  .libPaths(),
  "TwoSampleMR/Project_A/gwas_x_filted.csv",
  sep=""
 ),
 sep = ',',
 snp_col = 'SNP',
 # 事先用colnames()/head()确认下方列明后缀有无'_outcome'，按列名调节
 beta_col = 'beta',
 se_col = 'se_outcome',
 effect_allele_col = 'allele1_outcome',
 other_allele_col = 'allele2_outcome',
 pval_col = 'p_outcome'
)
```

- 注意不要忘了重新读取一遍筛选完的暴露数据
 - 但是后缀已经加了`'.exposure'`，  
   不想读取的时候变成`'.exposure.exposure'`的话需要重新处理一下
```r
# 删除字符
colnames(x_clumped_filted) <- sub("\\.exposure$", "", colnames(x_clumped_filted))

# 保存
x_clumped_filted %>% write_csv(
 paste(
  .libPaths(),
  "TwoSampleMR/Project_A/x_clumped_filted.csv",
  sep=""
  )
 )

# 读取
x <- read_exposure_data(
 filename = paste(
  .libPaths(),
  "TwoSampleMR/Project_A/x_clumped_filted.csv",
  sep=""
 ),
 sep = ',',
 snp_col = 'SNP',
 beta_col = 'beta',
 se_col = 'se',
 effect_allele_col = 'effect_allele',
 other_allele_col = 'other_allele',
 pval_col = 'pval',
 eaf_col = 'EAF'
)
```
### 一般问题和处理方法
- 存在暴露和结局的效应位点和非效应位点是反的/不一致的SNP
- 一部分暴露的SNP在结局中不存在
 - 数量少可以放弃
 - 代理SNP（proxies）的确定
  - 原理是找一个与不存在的SNP有连锁不平衡的SNP去代替
  - https://snipa.helmholtz-muenchen.de/snipa3/

### 结局数据注意点
- 是否存在样本重叠
- 初始的SNP量是否足够多：筛选完后能剩下足够的SNP以提高准确度
- 结局数据格式的设置

## 数据的协同（harmonization）
### 目的
- 将暴露SNP和结局SNP等位基因方向协同
 - 用以处理问题“存在暴露和结局的效应位点和非效应位点是反的/不一致的SNP”
- 根据EAF大小，剔除不能判断方向的回文SNP
- 剔除不匹配的SNP（incompatible SNP）
 - 例如暴露是A和T，结局是C和T

### 实行
```r
harmo <- harmonise_data(
 exposure_data = x,
 outcome_data = y
)
```

###  后续
- 保存csv
```r
harmo %>%
 write_csv('Data/harmo.csv')
```

- 检查`pval.outcome`中是否有SNP与结局强相关
 - 在前面检查和在这里检查都行，看个人喜好
```r
harmo %>%
 filter(pval.outcome < 5e-08)
```

## MR估计
### 计算
- `mr()`有默认5种方法
 - MR Egger
 - Weighted median
 - Inverse variance weighted （主要结果，其他为参考）
 - Simple mode
 - Weighted mode

- 用`mr_method_list()`获取全部方法

| obj                           | name                                                      | PubmedID | Description                                                 | use_by_default | heterogeneity_test |
| ----------------------------- | --------------------------------------------------------- | -------- | ----------------------------------------------------------- | -------------- | ------------------ |
| mr_wald_ratio                 | Wald ratio                                                |          |                                                             | TRUE           | FALSE              |
| mr_two_sample_ml              | Maximum likelihood                                        |          |                                                             | FALSE          | TRUE               |
| mr_egger_regression           | MR Egger                                                  | 26050253 |                                                             | TRUE           | TRUE               |
| mr_egger_regression_bootstrap | MR Egger (bootstrap)                                      | 26050253 |                                                             | FALSE          | FALSE              |
| mr_simple_median              | Simple median                                             | 27061298 |                                                             | FALSE          | FALSE              |
| mr_weighted_median            | Weighted median                                           | 27061298 |                                                             | TRUE           | FALSE              |
| mr_penalised_weighted_median  | Penalised weighted median                                 | 27061298 |                                                             | FALSE          | FALSE              |
| mr_ivw                        | Inverse variance weighted                                 | 24114802 |                                                             | TRUE           | TRUE               |
| mr_ivw_radial                 | IVW radial                                                | 29961852 |                                                             | FALSE          | TRUE               |
| mr_ivw_mre                    | Inverse variance weighted (multiplicative random effects) |          |                                                             | FALSE          | FALSE              |
| mr_ivw_fe                     | Inverse variance weighted (fixed effects)                 |          |                                                             | FALSE          | FALSE              |
| mr_simple_mode                | Simple mode                                               | 29040600 |                                                             | TRUE           | FALSE              |
| mr_weighted_mode              | Weighted mode                                             | 29040600 |                                                             | TRUE           | FALSE              |
| mr_weighted_mode_nome         | Weighted mode (NOME)                                      | 29040600 |                                                             | FALSE          | FALSE              |
| mr_simple_mode_nome           | Simple mode (NOME)                                        | 29040600 |                                                             | FALSE          | FALSE              |
| mr_raps                       | Robust adjusted profile score (RAPS)                      |          |                                                             | FALSE          | FALSE              |
| mr_sign                       | Sign concordance test                                     |          | Tests for concordance of signs between exposure and outcome | FALSE          | FALSE              |
| mr_uwr                        | Unweighted regression                                     |          | Doesn't use any weights                                     | FALSE          | TRUE               |
| mr_grip                       | MR GRIP                                                   |          | Allele coding invariant regression                          | FALSE          | FALSE              |

- `action`参数
 - `action = 1`  
   假设所有等位基因都编码在前链上,即不要尝试翻转等位基因
 -  `action = 2`  
   尝试推断正链等位基因,使用等位基因频率用于palindromes(默认,保守);
 -  `action = 3`  
   非palindromic SNP的正确链,并从分析中删除所有palindromic SNP(更保守)。 如果传递单个值,则此操作应用于所有结果。 但是多个值可以作为向量提供,每个元素都与不同的结果相关。

```r
harmo_mr <- mr(
 harmo,
 method_list = c(
  'mr_ivw',
  'mr_raps',
  'mr_weighted_median',
  'mr_egger_regression',
  'mr_simple_mode'
 )
)
```

### 结局是二分类变量的转换
- 手动计算
```r
harmo_mr <- harmo_mr %>%
 mutate(
  OR = exp(b),
  # 注意95%的单边是97.5%
  ci_upper = exp(b + qnorm(0.975) * se),
  ci_lower = exp(b - qnorm(0.975) * se)
 )
```
- 一键计算
```r
harmo_mr_orci <- generate_odds_ratio(mr_res = mr(harmo_mr))
```

### 敏感性分析
#### 异质性检验
- SNPs之间是否存在作用效果的区别
 - 一般而言不影响什么
- 有异质性就用随机效应模型，无异质性就用固定效应模型
 - 一般就用随机效应模型即可

```r
mr_heterogeneity(harmo)
```

- 存在异质性的情况下是由于离群值导致的
- `run_mr_presso()`可以找出具体的离群值，并计算
 - 剔除前后的异质性p值
 - 离群值带来的beta的改变
- `NbDistribution`设置得越高精度越高，但是相应的时间越久

```
```r
run_mr_presso(harmo, NbDistribution = 3000)
```
#### 水平多效性检验
- 检验SNP与其他表型（混杂因素）是否相关
 - 若相关则表明可能有假阳性
- `mr_pleiotropy_test()` 通过检验MR Egger的截距是否为邻来证明SNP与结局是否相关

```r
mr_pleiotropy_test(harmo)
```

- 查看导致多效性的SNP的第二表型
 - 但是大多数的SNP的生物学功能是不清楚的，很多情况下可以跳过，不需要解释
 - https://snipa.helmholtz-muenchen.de/snipa3/index.php?task=variant_browser
 - https://www.ebi.ac.uk/gwas/

#### Leave-one-out分析
- 分别剔除每一个SNP时，剩余的SNPs的MR的结果
- 如果每个剔除一遍，  
  整体 |beta ± se| > 0 或 |OR ± ci| > 1 （不跨过0）的话说明  
  结果稳健，不收到单独某一个SNP
- 如果剔除某一个SNP的结果跨0了，说明结果收到这个SNP的影响非常大  
  这个SNP可能和结局以外的表型高度相关，  
  结果是**假阳性**
```r
mr_leaveoneout()
```

#### 统计效能计算
- shiny.cnsgenomics.com/mRnd/
- 内容
 - Sample size：结局的样本量
 - $\alpha$：显著性阈值
 - $K$：阳性例证占比
 - $OR$：风险比，一般以IVW计算出来的beta进行转换
 - $R^2$：每个SNP的 $R^2$ 相加的总和
- 一般高于80%就行
### 可视化
#### MR结果可视化
```r
# 绘制
library(forestploter)
library(grid)
pdf("MRresult_eQTLGen.pdf", width
11, height = 7, onefile = FALSE)
forest_theme (base_size = 10,
# 文本的大小
tm =
# 可信区间点的形状
ci_pcht= 16,
ci_col"= "black"
# CI的颜色
ci_fill
# CI中se点的颜色填充
ci_alpha = 0.8.
# CI透明度
# CI的线型
ci_lty = 1,
ci_lwd = 1.5,
# CI的线宽
ci_Theight =
0.2,
# CI的高度,默认是NULL
# 参考线默认的参数,
中间的竖的虚线
refline_lwd = 1,
中间的竖的虚线
refline_lty = "dashed"
refline_col
"grey20

p = fores (OR[,C(1:4,10,6,9)],
# 效应值
est = ORSor,
lower = OR$or_lci95,
# 置信区间下限
# 置信区间上限
upper = ORSor_uci95,
ci_column = 5,
# 在哪一列画森林图,选空的那一列
ref_line = 1,
# 参考线位置
# 设置轴范围
xlim = C(-1, 3),
ticks_at=C(0,1,2,3),#设置刻度
theme = tm)
edit_plot(p,
Which = "background",
row = c(3)
lightsteelblue1"))
gp = gpar(fill = 'lightenblue)
```

#### SNP作用效果散点图
- SNP对于暴露和结局的效果的散点图，水平越偏离0，竖直越接近0代表工具变量越合理
```r
mr_scatter_plot(
 mr_results = harmo_mr,
 harmo
)
```

#### Leave-one-out分析可视化
```r
mr_leaveoneout_plot(mr_leaveoneout(harmo))
```

#### 森林图
```r
mr_forest_plot(mr_singlesnp(harmo))
```

#### 漏斗图
- SNPs异质性可视化
```r
mr_funnel_plot(mr_singlesnp(harmo))
```

## 直接从openGWAS数据库下载数据
### 下载工具变量
- `extract_instruments()`自带clump功能
```r
# 这里的`outcomes`表示的是对于该GWAS研究而言的outcomes
x <- extract_instruments(outcomes = 'exposureID')
```

### 下载暴露数据
```r
y <- extract_outcome_data(snps = x$SNP, outcomes = 'outcomeID')
```
